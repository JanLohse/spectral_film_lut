from spectral_film_lut.film_spectral import *


class IlfochromeMicrographicM(FilmSpectral):
    def __init__(self):
        super().__init__()

        self.lad = [0.91030324, 1.0133907, 0.9813101]
        self.density_measure = 'status_a'

        # spectral sensitivity
        red_log_sensitivity = {586.2032: 0.1181, 589.2634: 0.1931, 592.1196: 0.2683, 594.9757: 0.3466, 597.8319: 0.4304,
                               600.4841: 0.5075, 603.1363: 0.5874, 605.7884: 0.6724, 609.0526: 0.7566, 613.3369: 0.8053,
                               617.8252: 0.8210, 622.3135: 0.8515, 626.3937: 0.9149, 629.6579: 0.9938, 632.3101: 1.0730,
                               634.7582: 1.1531, 636.8275: 1.2311, 639.0425: 1.3230, 640.8786: 1.4172, 642.3067: 1.4923,
                               643.7348: 1.5780, 645.1629: 1.6702, 646.5618: 1.7662, 648.0191: 1.8597, 651.2833: 1.9188,
                               655.3635: 1.8687, 658.4237: 1.7957, 660.3415: 1.7224, 661.1779: 1.6279, 661.2799: 1.5515,
                               662.1251: 1.4678, 662.3816: 1.3704, 663.2690: 1.2759, 663.8155: 1.1574, 664.3401: 1.0651,
                               664.7481: 0.9625, 665.4826: 0.8679, 666.1252: 0.7573, 666.6717: 0.6343, 667.1963: 0.5456,
                               667.7573: 0.4427, 668.4204: 0.3385, 669.8193: 0.2355, 671.4806: 0.1543, 674.7448: 0.0712,
                               678.2130: 0.0114}
        green_log_sensitivity = {466.2436: 0.0961, 469.7119: 0.1810, 472.3640: 0.2566, 474.8122: 0.3361,
                                 477.2603: 0.4227, 479.8672: 0.5061, 481.9073: 0.5929, 483.4099: 0.6767,
                                 486.8489: 0.8633, 488.4810: 0.9634, 489.8800: 1.0488, 490.6572: 1.1360,
                                 491.8035: 1.2215, 493.1733: 1.3280, 494.7763: 1.4148, 496.2789: 1.5012,
                                 498.1377: 1.5856, 500.1389: 1.6753, 502.7619: 1.7672, 506.4342: 1.8475,
                                 510.9225: 1.8947, 515.4107: 1.9034, 519.8990: 1.9153, 524.3873: 1.9619,
                                 528.0595: 2.0358, 530.7117: 2.1143, 533.5452: 2.2009, 535.7610: 2.2875,
                                 537.4441: 2.3691, 539.4843: 2.4447, 541.7284: 2.5201, 544.1765: 2.5973,
                                 546.8287: 2.6724, 550.6370: 2.7107, 553.1758: 2.6061, 554.0712: 2.4885,
                                 554.7852: 2.3817, 555.3973: 2.2902, 556.4173: 2.1806, 557.2042: 2.0651,
                                 558.0786: 1.9485, 558.7431: 1.8574, 559.4775: 1.7818, 559.9875: 1.6832,
                                 560.9347: 1.5638, 561.5992: 1.4715, 562.3337: 1.4008, 562.8437: 1.3028,
                                 563.6394: 1.2114, 564.3738: 1.1386, 564.8839: 1.0395, 565.6795: 0.9364,
                                 566.4139: 0.8622, 566.9968: 0.7721, 567.7400: 0.6645, 568.5561: 0.5602,
                                 569.8312: 0.4560, 570.9022: 0.3688, 572.3303: 0.2861, 573.7584: 0.2099,
                                 575.5945: 0.1293, 578.2467: 0.0706, 582.9390: 0.0611}
        blue_log_sensitivity = {401.8341: 1.2345, 404.1921: 1.3389, 407.0015: 1.4316, 409.7831: 1.5316,
                                413.5857: 1.6072, 417.8416: 1.6796, 421.0208: 1.7395, 424.6250: 1.8015,
                                428.5013: 1.8504, 432.6981: 1.8884, 436.3218: 1.9264, 440.9053: 1.9454,
                                445.3275: 1.9493, 449.4636: 1.9376, 454.4517: 1.8899, 458.0423: 1.8546,
                                460.8373: 1.7799, 463.5461: 1.7006, 465.2236: 1.6084, 467.7883: 1.5198,
                                469.1290: 1.4310, 471.6613: 1.3464, 473.7921: 1.2548, 476.1383: 1.1469,
                                478.0764: 1.0506, 480.6120: 0.9701, 482.2441: 0.8923, 489.0523: 0.6551,
                                490.9292: 0.5703, 492.8469: 0.4926, 495.3665: 0.4074, 498.3849: 0.3099,
                                501.2931: 0.2183, 504.3940: 0.1283, 508.0209: 0.0636, 511.6157: 0.0000}
        self.log_sensitivity = [red_log_sensitivity, green_log_sensitivity, blue_log_sensitivity]

        # sensiometry
        red_curve = {0.0010: 2.0643, 0.0411: 2.0617, 0.1008: 2.0606, 0.1606: 2.0583, 0.2203: 2.0573, 0.2800: 2.0552,
                     0.3397: 2.0547, 0.3994: 2.0521, 0.4592: 2.0514, 0.5189: 2.0481, 0.5786: 2.0477, 0.6383: 2.0436,
                     0.6981: 2.0341, 0.7578: 2.0212, 0.8175: 2.0035, 0.8772: 1.9785, 0.9370: 1.9458, 0.9967: 1.9050,
                     1.0564: 1.8569, 1.1147: 1.8022, 1.1673: 1.7431, 1.2128: 1.6843, 1.2540: 1.6243, 1.2910: 1.5640,
                     1.3223: 1.5025, 1.3547: 1.4419, 1.3792: 1.3826, 1.4076: 1.3226, 1.4361: 1.2635, 1.4645: 1.2053,
                     1.4915: 1.1466, 1.5185: 1.0878, 1.5484: 1.0292, 1.5797: 0.9648, 1.8760: 0.3368, 1.9016: 0.2850,
                     1.9464: 0.2151, 2.0347: 0.1199, 2.1094: 0.0693, 2.1752: 0.0478, 2.2739: 0.0374, 2.4055: 0.0277,
                     2.9932: 0.0158, }
        green_curve = {0.0411: 2.3973, 0.1008: 2.3953, 0.1606: 2.3925, 0.2203: 2.3901, 0.2800: 2.3877, 0.3397: 2.3841,
                       0.3994: 2.3816, 0.4592: 2.3796, 0.5189: 2.3776, 0.5786: 2.3738, 0.6383: 2.3644, 0.6981: 2.3470,
                       0.7421: 2.3315, 0.7935: 2.3068, 0.8578: 2.2711, 0.9475: 2.2012, 1.0308: 2.1153, 1.0834: 2.0498,
                       1.1261: 1.9903, 1.1645: 1.9320, 1.2000: 1.8749, 1.2341: 1.8154, 1.2654: 1.7539, 1.2939: 1.6895,
                       1.3209: 1.6269, 1.3465: 1.5674, 1.3735: 1.5049, 1.4005: 1.4426, 1.4261: 1.3832, 1.4517: 1.3234,
                       1.4773: 1.2653, 1.5043: 1.2021, 1.5328: 1.1363, 1.5598: 1.0773, 1.5854: 1.0147, 1.6152: 0.9493,
                       1.6653: 0.8221, 1.7491: 0.6257, 1.8119: 0.4799, 1.8747: 0.3341, 1.9240: 0.2493, 1.9719: 0.1735,
                       2.0406: 0.0991, 2.1124: 0.0530, 2.2231: 0.0321, 2.4190: 0.0269, 2.6089: 0.0217, 2.8302: 0.0158,
                       2.9977: 0.0128, }
        blue_curve = {0.0525: 2.4545, 0.1122: 2.4523, 0.1719: 2.4492, 0.2317: 2.4463, 0.2914: 2.4427, 0.3511: 2.4393,
                      0.4108: 2.4356, 0.4705: 2.4323, 0.5303: 2.4288, 0.5900: 2.4197, 0.6497: 2.4032, 0.7094: 2.3795,
                      0.7549: 2.3582, 0.8578: 2.2889, 0.9573: 2.1945, 1.0493: 2.0935, 1.0962: 2.0326, 1.1374: 1.9732,
                      1.1758: 1.9138, 1.2114: 1.8561, 1.2441: 1.7966, 1.2740: 1.7350, 1.3010: 1.6736, 1.3266: 1.6137,
                      1.3536: 1.5541, 1.3820: 1.4911, 1.4090: 1.4298, 1.4346: 1.3657, 1.4602: 1.3050, 1.4858: 1.2448,
                      1.5114: 1.1856, 1.5384: 1.1237, 1.5655: 1.0611, 1.5996: 0.9812, 1.7124: 0.7142, 1.8006: 0.5075,
                      1.8762: 0.3341, 1.9449: 0.2226, 1.9906: 0.1735, 2.0743: 0.1058, 2.1707: 0.0589, 2.2223: 0.0500,
                      2.2664: 0.0500, 2.3921: 0.0463, 2.5311: 0.0433, 2.7509: 0.0433, 2.9962: 0.0381, }
        red_log_exposure = xp.array(list(red_curve.keys()), dtype=default_dtype)
        red_density_curve = xp.array(list(red_curve.values()), dtype=default_dtype)
        green_log_exposure = xp.array(list(green_curve.keys()), dtype=default_dtype)
        green_density_curve = xp.array(list(green_curve.values()), dtype=default_dtype)
        blue_log_exposure = xp.array(list(blue_curve.keys()), dtype=default_dtype)
        blue_density_curve = xp.array(list(blue_curve.values()), dtype=default_dtype)
        self.log_exposure = [red_log_exposure, green_log_exposure, blue_log_exposure]
        self.density_curve = [red_density_curve, green_density_curve, blue_density_curve]

        # spectral dye density
        red_sd = {406.7273: 0.0984, 413.2482: 0.0866, 419.7691: 0.0764, 426.2900: 0.0683, 432.8109: 0.0607,
                  439.3318: 0.0557, 445.8527: 0.0523, 452.3736: 0.0510, 458.8945: 0.0515, 465.4153: 0.0540,
                  471.9362: 0.0589, 478.4571: 0.0668, 484.9780: 0.0778, 491.4989: 0.0905, 498.0198: 0.1038,
                  502.0953: 0.1126, 514.7296: 0.1455, 521.2504: 0.1644, 527.7713: 0.1859, 534.2922: 0.2102,
                  540.8131: 0.2374, 547.1302: 0.2675, 552.6322: 0.2992, 557.3191: 0.3302, 561.5984: 0.3619,
                  565.6740: 0.3955, 569.5458: 0.4303, 573.0100: 0.4624, 576.4742: 0.4945, 580.3460: 0.5276,
                  584.6253: 0.5605, 588.9047: 0.5869, 598.6860: 0.6568, 603.3729: 0.6935, 606.8371: 0.7255,
                  610.0975: 0.7586, 613.1542: 0.7922, 616.1090: 0.8241, 618.7377: 0.8580, 620.8978: 0.8931,
                  623.9544: 0.9273, 627.8262: 0.9615, 633.3282: 0.9866, 639.4415: 0.9789, 643.9247: 0.9421,
                  647.1851: 0.9079, 650.4455: 0.8752, 654.1135: 0.8413, 659.4118: 0.8129, 665.3213: 0.8261,
                  670.2120: 0.8597, 674.4913: 0.8913, 678.3631: 0.9235, 683.4575: 0.9535, 689.1633: 0.9461,
                  692.5648: 0.9047, 694.8691: 0.8657, 696.9069: 0.8293, 698.7862: 0.7934, 700.7334: 0.7576,
                  702.4089: 0.7202, 703.8644: 0.6833, 705.4364: 0.6458, 706.5426: 0.6087, 707.4354: 0.5738,
                  708.4713: 0.5367, 709.7958: 0.5008, 711.3241: 0.4658, 712.8306: 0.4293, 714.6355: 0.3912,
                  716.6280: 0.3521, 718.5073: 0.3161, 720.1666: 0.2893}
        green_sd = {403.4669: 0.2618, 409.9878: 0.2270, 416.5087: 0.2025, 423.0296: 0.1887, 429.5505: 0.1816,
                    436.0713: 0.1809, 442.5922: 0.1864, 449.1131: 0.1977, 455.6340: 0.2143, 462.1549: 0.2359,
                    468.6758: 0.2643, 474.5853: 0.2962, 479.8836: 0.3291, 483.9591: 0.3523, 492.3140: 0.4147,
                    497.2047: 0.4515, 501.2802: 0.4850, 505.1520: 0.5190, 508.6162: 0.5506, 512.0804: 0.5836,
                    515.5447: 0.6177, 518.8051: 0.6515, 521.8618: 0.6853, 524.9184: 0.7190, 528.3827: 0.7513,
                    532.2544: 0.7842, 536.7376: 0.8165, 542.4433: 0.8457, 548.9642: 0.8723, 555.4851: 0.9014,
                    561.5984: 0.9322, 566.8967: 0.9649, 572.6024: 0.9862, 577.1535: 0.9612, 578.5120: 0.9282,
                    580.1422: 0.8913, 581.5978: 0.8548, 583.3517: 0.8179, 584.6253: 0.7802, 586.2556: 0.7437,
                    587.2744: 0.7096, 588.7009: 0.6694, 590.4217: 0.6279, 592.3689: 0.5577, 593.5916: 0.5124,
                    594.8142: 0.4700, 595.9859: 0.4298, 597.2143: 0.3915, 599.0935: 0.3475, 600.8823: 0.3053,
                    602.5578: 0.2680, 604.2333: 0.2348, 606.3888: 0.2004, 609.4862: 0.1646, 612.5429: 0.1303,
                    616.2109: 0.0974, 621.3053: 0.0652, 627.6224: 0.0392, 634.1433: 0.0239, 640.6642: 0.0127,
                    647.1851: 0.0036, 653.7060: -0.0045, 658.3929: -0.0077}
        blue_sd = {403.9528: 0.8493, 406.5236: 0.8908, 409.5802: 0.9245, 414.0633: 0.9590, 420.1767: 0.9808,
                   426.6976: 0.9856, 433.2185: 0.9781, 438.7205: 0.9550, 441.9809: 0.9181, 443.8149: 0.8863,
                   446.0194: 0.8553, 449.1131: 0.8211, 451.7622: 0.7877, 454.6151: 0.7527, 457.4680: 0.7185,
                   460.5247: 0.6842, 463.7851: 0.6489, 467.0456: 0.6147, 470.1022: 0.5831, 472.9551: 0.5506,
                   475.8080: 0.5159, 478.6609: 0.4807, 481.2227: 0.4456, 484.0703: 0.4077, 488.4932: 0.3324,
                   490.7857: 0.2941, 492.9661: 0.2574, 496.1858: 0.2232, 499.4462: 0.1897, 503.5218: 0.1558,
                   512.6918: 0.0928, 519.2127: 0.0626, 525.7336: 0.0394, 532.2544: 0.0225, 538.7753: 0.0102,
                   545.2962: 0.0021, 551.8171: -0.0016, 558.3380: -0.0038, 564.8589: -0.0049, 571.3798: -0.0062,
                   577.9007: -0.0069, 581.9762: -0.0074}
        self.spectral_density = [colour.SpectralDistribution(x) for x in (red_sd, green_sd, blue_sd)]

        self.calibrate()
