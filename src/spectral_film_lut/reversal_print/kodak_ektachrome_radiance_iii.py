from spectral_film_lut.film_spectral import *


class KodakEktachromeRadianceIIIPaper(FilmSpectral):
    def __init__(self):
        super().__init__()

        self.lad = [1] * 3
        self.density_measure = 'status_a'

        # spectral sensitivity
        red_log_sensitivity = {564.4379: -0.6577, 572.7240: -0.5664, 581.0101: -0.4747, 589.5635: -0.3916,
                               596.5132: -0.3276, 607.7395: -0.2279, 616.2929: -0.1512, 623.2426: -0.0835,
                               635.0035: 0.0953, 639.5475: 0.1988, 643.2896: 0.2988, 647.0318: 0.3895, 657.4562: 0.4899,
                               664.4059: 0.4358, 668.6826: 0.3397, 671.8901: 0.2452, 674.8304: 0.1509, 677.2360: 0.0668,
                               679.3743: -0.0352, 681.5127: -0.1316, 683.3838: -0.2320, 684.8806: -0.3349,
                               686.3240: -0.4294, 687.9278: -0.5385, 689.5315: -0.6515, 691.1353: -0.7714,
                               692.9300: -0.9018, 694.8239: -1.0555, 696.0000: -1.1552, 697.5503: -1.2684, }
        green_log_sensitivity = {482.1113: -0.6265, 486.3880: -0.5273, 490.3974: -0.4341, 497.0798: -0.2779,
                                 505.9005: -0.1037, 509.1080: -0.0419, 513.9193: 0.0672, 518.1960: 0.1668,
                                 521.6708: 0.2608, 524.6111: 0.3516, 527.2840: 0.4468, 529.6896: 0.5423,
                                 531.8280: 0.6366, 534.2336: 0.7393, 537.4412: 0.8393, 543.5889: 0.9133,
                                 550.5486: 0.8588, 552.6769: 0.7684, 554.5480: 0.6607, 555.8845: 0.5593,
                                 557.4348: 0.4275, 558.1565: 0.3021, 559.1455: 0.1832, 559.6266: 0.0704,
                                 560.1612: -0.0742, 560.4285: -0.1611, }
        blue_log_sensitivity = {355.1466: -0.1935, 360.2252: -0.1032, 363.9673: -0.0146, 366.9075: 0.0817,
                                369.5805: 0.1838, 371.9861: 0.2830, 374.3918: 0.3805, 377.0647: 0.4899,
                                379.7377: 0.5982, 382.1433: 0.6961, 384.5489: 0.7886, 387.4892: 0.8858,
                                390.6967: 0.9623, 396.5772: 1.0506, 406.7344: 1.1032, 415.2878: 1.0848,
                                423.8412: 1.0378, 432.3946: 1.0398, 440.6807: 1.0617, 446.2939: 0.9373,
                                453.2435: 0.6831, 456.4511: 0.5863, 459.9259: 0.4915, 463.9353: 0.3949,
                                468.2120: 0.3007, 472.4887: 0.2079, 476.4981: 0.1182, 479.7056: 0.0466,
                                483.4478: -0.0600, 486.9226: -0.1549, 490.1301: -0.2508, 492.5358: -0.3236,
                                496.0106: -0.4507, 498.4162: -0.5296, 504.8313: -0.7697, 507.5042: -0.8735,
                                509.9099: -0.9550, }
        self.log_sensitivity = [red_log_sensitivity, green_log_sensitivity, blue_log_sensitivity]

        # sensiometry
        red_curve = {0.0000: 2.5171, 0.1634: 2.5206, 0.3578: 2.5171, 0.5251: 2.4785, 0.6924: 2.4181, 0.8076: 2.3545,
                     0.9491: 2.2256, 1.1217: 2.0444, 1.2737: 1.8659, 1.4120: 1.6738, 1.4794: 1.5728, 1.5421: 1.4756,
                     1.6072: 1.3784, 1.6793: 1.2805, 1.7560: 1.1832, 1.8350: 1.0842, 1.9117: 0.9874, 1.9884: 0.8902,
                     2.0674: 0.7912, 2.1465: 0.6950, 2.2255: 0.6014, 2.3068: 0.5045, 2.3882: 0.4070, 2.4719: 0.3106,
                     2.5648: 0.2201, 2.6625: 0.1574, 2.7601: 0.1217, 2.8577: 0.1042, 2.9553: 0.0987, 3.0529: 0.0969,
                     3.1506: 0.0953, 3.2482: 0.0931, 3.3458: 0.0901, 3.4434: 0.0874, 3.5410: 0.0862, 3.6387: 0.0862,
                     3.7363: 0.0862, 3.7921: 0.0862, }
        green_curve = {0.0057: 2.4181, 0.2567: 2.4199, 0.4668: 2.4026, 0.5912: 2.3789, 0.7624: 2.3457, 0.9335: 2.2528,
                       1.0891: 2.1168, 1.2058: 2.0002, 1.4120: 1.6738, 1.4794: 1.5728, 1.5421: 1.4756, 1.6072: 1.3784,
                       1.6793: 1.2805, 1.7560: 1.1832, 1.8350: 1.0842, 1.9117: 0.9874, 1.9884: 0.8902, 2.0674: 0.7912,
                       2.1465: 0.6950, 2.2255: 0.6014, 2.3068: 0.5045, 2.3882: 0.4070, 2.4719: 0.3106, 2.5648: 0.2201,
                       2.6625: 0.1574, 2.7601: 0.1217, 2.8577: 0.1042, 2.9553: 0.0987, 3.0529: 0.0969, 3.1506: 0.0953,
                       3.2482: 0.0931, 3.3458: 0.0901, 3.4434: 0.0874, 3.5410: 0.0862, 3.6387: 0.0862, 3.7363: 0.0862,
                       3.7921: 0.0862, }
        blue_curve = {0.0000: 2.4510, 0.2023: 2.4549, 0.3851: 2.4564, 0.5679: 2.4238, 0.7274: 2.4026, 0.8596: 2.3538,
                      0.9841: 2.2606, 1.1043: 2.1359, 1.2061: 1.9966, 1.4120: 1.6738, 1.4794: 1.5728, 1.5421: 1.4756,
                      1.6072: 1.3784, 1.6793: 1.2805, 1.7560: 1.1832, 1.8350: 1.0842, 1.9117: 0.9874, 1.9884: 0.8902,
                      2.0674: 0.7912, 2.1465: 0.6950, 2.2255: 0.6014, 2.3068: 0.5045, 2.3882: 0.4070, 2.4719: 0.3106,
                      2.5648: 0.2201, 2.6625: 0.1574, 2.7601: 0.1217, 2.8577: 0.1042, 2.9553: 0.0987, 3.0529: 0.0969,
                      3.1506: 0.0953, 3.2482: 0.0931, 3.3458: 0.0901, 3.4434: 0.0874, 3.5410: 0.0862, 3.6387: 0.0862,
                      3.7363: 0.0862, 3.7921: 0.0862, }
        red_log_exposure = xp.array(list(red_curve.keys()), dtype=default_dtype)
        red_density_curve = xp.array(list(red_curve.values()), dtype=default_dtype)
        green_log_exposure = xp.array(list(green_curve.keys()), dtype=default_dtype)
        green_density_curve = xp.array(list(green_curve.values()), dtype=default_dtype)
        blue_log_exposure = xp.array(list(blue_curve.keys()), dtype=default_dtype)
        blue_density_curve = xp.array(list(blue_curve.values()), dtype=default_dtype)
        self.log_exposure = [red_log_exposure, green_log_exposure, blue_log_exposure]
        self.density_curve = [red_density_curve, green_density_curve, blue_density_curve]

        # spectral dye density
        red_sd = {401.4909: 1.1497, 402.8855: 1.0876, 404.4544: 1.0279, 406.1977: 0.9579, 408.1152: 0.8912,
                  410.0328: 0.8267, 412.1246: 0.7613, 414.3908: 0.6984, 417.1800: 0.6343, 420.6665: 0.5689,
                  424.8502: 0.5068, 429.9056: 0.4466, 436.0069: 0.3840, 442.0143: 0.3360, 450.3014: 0.2880,
                  457.6229: 0.2489, 464.9445: 0.2245, 472.2661: 0.2157, 479.5876: 0.2164, 486.9092: 0.2251,
                  494.2307: 0.2418, 501.5523: 0.2660, 508.8739: 0.2969, 516.1954: 0.3337, 522.5515: 0.3710,
                  530.8386: 0.4282, 538.1601: 0.4847, 545.3074: 0.5423, 552.1060: 0.6032, 558.3816: 0.6628,
                  564.1342: 0.7224, 569.7126: 0.7837, 575.1166: 0.8461, 580.1720: 0.9058, 587.6678: 0.9985,
                  592.7232: 1.0632, 597.4299: 1.1241, 602.1366: 1.1854, 607.0177: 1.2474, 612.0730: 1.3102,
                  617.3027: 1.3733, 622.7067: 1.4356, 629.1567: 1.4974, 636.4783: 1.5439, 643.7998: 1.5790,
                  651.1214: 1.6041, 658.4430: 1.6108, 665.7645: 1.5956, 673.0861: 1.5575, 680.4076: 1.5007,
                  687.2062: 1.4387, 692.9589: 1.3761, 698.0956: 1.3167, }
        green_sd = {402.5369: 0.7877, 404.1058: 0.7195, 405.6747: 0.6515, 407.4179: 0.5826, 409.3355: 0.5163,
                    411.6017: 0.4502, 414.3908: 0.3859, 418.2259: 0.3222, 424.1529: 0.2630, 431.4745: 0.2426,
                    438.7960: 0.2675, 446.3322: 0.3276, 452.2189: 0.3837, 458.4945: 0.4443, 464.2472: 0.5054,
                    469.1282: 0.5645, 473.6606: 0.6261, 477.8444: 0.6885, 481.6795: 0.7490, 485.3403: 0.8091,
                    488.4781: 0.8614, 494.2307: 0.9616, 497.8915: 1.0248, 501.3780: 1.0877, 504.8644: 1.1508,
                    508.3509: 1.2128, 512.0117: 1.2749, 516.0211: 1.3384, 520.2049: 1.4007, 524.5629: 1.4614,
                    529.2697: 1.5229, 534.8480: 1.5858, 541.6466: 1.6296, 548.9681: 1.6294, 554.8951: 1.5813,
                    558.9046: 1.5174, 562.2167: 1.4532, 565.1802: 1.3910, 567.9693: 1.3291, 570.7585: 1.2632,
                    573.3734: 1.1988, 575.8139: 1.1375, 578.2544: 1.0753, 580.6949: 1.0128, 583.0657: 0.9536,
                    585.7503: 0.8880, 588.5395: 0.8236, 591.5029: 0.7592, 594.8151: 0.6936, 598.4759: 0.6277,
                    602.4853: 0.5640, 607.0177: 0.5013, 612.4217: 0.4383, 618.8716: 0.3775, 626.0189: 0.3221,
                    633.3404: 0.2761, 640.6620: 0.2384, 647.9836: 0.2067, 655.3051: 0.1818, 662.6267: 0.1631,
                    669.9483: 0.1480, 677.2698: 0.1357, 684.5914: 0.1256, 691.9130: 0.1191, 697.1426: 0.1160, }
        blue_sd = {404.6287: 1.3741, 410.5557: 1.3312, 417.8773: 1.3446, 425.1989: 1.3802, 432.5204: 1.4192,
                   439.8420: 1.4577, 447.1635: 1.4786, 454.4851: 1.4609, 460.9351: 1.4067, 465.8161: 1.3449,
                   469.8255: 1.2836, 473.6606: 1.2203, 477.3214: 1.1554, 480.6336: 1.0949, 483.9457: 1.0329,
                   487.2578: 0.9703, 489.3497: 0.9308, 494.0564: 0.8395, 497.5429: 0.7748, 501.0293: 0.7122,
                   504.6901: 0.6510, 508.6995: 0.5884, 513.0576: 0.5265, 517.7643: 0.4659, 521.5994: 0.4214,
                   530.8386: 0.3314, 538.1601: 0.2861, 545.4817: 0.2525, 552.8032: 0.2276, 560.1248: 0.2097,
                   567.4464: 0.1968, 574.7679: 0.1862, 582.0895: 0.1758, 589.4111: 0.1660, 596.7326: 0.1580,
                   604.0542: 0.1517, 611.3758: 0.1475, 618.6973: 0.1451, 626.0189: 0.1424, 633.3404: 0.1379,
                   640.6620: 0.1311, 647.9836: 0.1230, 655.3051: 0.1163, 662.6267: 0.1110, 669.9483: 0.1065,
                   677.2698: 0.1040, 684.5914: 0.0988, 696.4454: 0.0977, }
        self.spectral_density = [colour.SpectralDistribution(x) for x in (red_sd, green_sd, blue_sd)]

        self.calibrate()

if __name__ == "__main__":
    KodakEktachromeRadianceIIIPaper().plot_data()