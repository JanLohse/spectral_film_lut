from spectral_film_lut.film_spectral import *


class Fuji3513DI(FilmSpectral):
    def __init__(self):
        super().__init__()

        self.lad = [1.09, 1.06, 1.03]
        self.density_measure = 'status_a'
        self.exposure_kelvin = 2854
        self.manufacturer = 'Fujifilm'
        self.stage = 'print'
        self.type = 'negative'
        self.medium = 'cine'

        # spectral sensitivity
        red_log_sensitivity = {361.2142: 1.7802, 370.3606: 1.7095, 379.7197: 1.5734, 394.2263: 1.3515, 406.2655: 1.1230,
                               417.7942: 0.8662, 428.6422: 0.5152, 434.1726: 0.3275, 441.8300: 0.1153, 630.0753: 0.1534,
                               639.6471: 0.2840, 649.2189: 0.3738, 659.3863: 0.4385, 668.3200: 0.5734, 672.7017: 0.6213,
                               676.7432: 0.6931, 680.6995: 0.7492, 686.6553: 0.7802, 693.0365: 0.7775, 698.4392: 0.7421,
                               704.3099: 0.6649, 710.8613: 0.5392, 717.5403: 0.3743, 720.9011: 0.2617, 722.9430: 0.1567}
        green_log_sensitivity = {360.7534: 1.4760, 366.2483: 1.4352, 371.8850: 1.3191, 376.2100: 1.2157,
                                 381.3859: 1.1074, 385.7818: 1.0017, 389.8587: 0.9051, 394.6446: 0.8090,
                                 400.3877: 0.7306, 406.4498: 0.6186, 409.6759: 0.5102, 412.9374: 0.4137,
                                 416.9079: 0.2409, 419.4958: 0.1439, 422.0129: 0.0800, 425.6289: 0.0351,
                                 429.7058: 0.0478, 437.1505: 0.1158, 443.5317: 0.2065, 447.8213: 0.3012,
                                 454.5215: 0.4196, 461.9662: 0.5692, 467.6739: 0.7029, 470.8645: 0.7777,
                                 475.5086: 0.8303, 481.1098: 0.8866, 489.6181: 0.9954, 497.4173: 1.1314,
                                 503.2668: 1.2175, 507.7336: 1.2565, 515.1429: 1.2647, 520.2833: 1.2647,
                                 524.8565: 1.2774, 533.1166: 1.4252, 538.0089: 1.5802, 542.5466: 1.7244,
                                 547.2261: 1.8296, 549.3532: 1.8568, 551.4803: 1.8545, 552.3665: 1.8251,
                                 555.3444: 1.6555, 561.3002: 1.1337, 566.3697: 0.6689, 569.9148: 0.3470,
                                 570.9784: 0.1634}
        blue_log_sensitivity = {361.2851: 2.1307, 367.5245: 2.0840, 373.4094: 1.9665, 382.0240: 1.7843,
                                387.6962: 1.6800, 392.9430: 1.5331, 397.6225: 1.4352, 402.0539: 1.3889,
                                408.7896: 1.4034, 415.5253: 1.4751, 428.0041: 1.6859, 436.4769: 1.8414,
                                440.1284: 1.9117, 446.0487: 1.9611, 451.7918: 2.0604, 458.4920: 2.2649,
                                463.7034: 2.4766, 466.8230: 2.6208, 468.6665: 2.7001, 470.8290: 2.7373,
                                472.7788: 2.7296, 475.4377: 2.6729, 480.4008: 2.3261, 485.7539: 1.8455,
                                488.5546: 1.5621, 492.8087: 1.1813, 497.4528: 0.8004, 503.3377: 0.4445,
                                507.8400: 0.1589}
        self.log_sensitivity = [red_log_sensitivity, green_log_sensitivity, blue_log_sensitivity]

        # sensiometry
        red_curve = {-0.5435: 0.1014, -0.4291: 0.1014, -0.3148: 0.1014, -0.2004: 0.1014, -0.0860: 0.1014,
                     0.0284: 0.1014, 0.1428: 0.1075, 0.2572: 0.1103, 0.3716: 0.1143, 0.4860: 0.1240, 0.6004: 0.1514,
                     0.7147: 0.2056, 0.8291: 0.2949, 0.9400: 0.4204, 1.0329: 0.5600, 1.1044: 0.6997, 1.1616: 0.8406,
                     1.2081: 0.9854, 1.2474: 1.1336, 1.2831: 1.2891, 1.3153: 1.4397, 1.3439: 1.5804, 1.3725: 1.7279,
                     1.4011: 1.8753, 1.4297: 2.0317, 1.4583: 2.1926, 1.4869: 2.3568, 1.5155: 2.5244, 1.5441: 2.6953,
                     1.5727: 2.8695, 1.6013: 3.0427, 1.6299: 3.2136, 1.6585: 3.3845, 1.6871: 3.5465, 1.7157: 3.7040,
                     1.7443: 3.8537, 1.7764: 3.9978, 1.8157: 4.1542, 1.8586: 4.3098, 1.9051: 4.4517, 1.9659: 4.5966,
                     2.0588: 4.7373, 2.1553: 4.8070, }
        green_curve = {-0.5484: 0.1194, -0.4341: 0.1194, -0.3198: 0.1194, -0.2055: 0.1194, -0.0912: 0.1205,
                       0.0231: 0.1278, 0.1374: 0.1283, 0.2517: 0.1381, 0.3660: 0.1580, 0.4804: 0.1999, 0.5947: 0.2681,
                       0.7090: 0.3754, 0.8090: 0.5155, 0.8840: 0.6600, 0.9447: 0.8047, 1.0019: 0.9507, 1.0555: 1.0867,
                       1.1055: 1.2342, 1.1519: 1.3880, 1.1948: 1.5460, 1.2341: 1.6954, 1.2698: 1.8421, 1.3055: 1.9950,
                       1.3413: 2.1560, 1.3770: 2.3206, 1.4127: 2.4897, 1.4448: 2.6428, 1.4734: 2.7837, 1.5020: 2.9201,
                       1.5306: 3.0621, 1.5592: 3.2052, 1.5877: 3.3483, 1.6163: 3.4847, 1.6485: 3.6399, 1.6842: 3.8072,
                       1.7199: 3.9709, 1.7556: 4.1274, 1.7949: 4.2830, 1.8378: 4.4321, 1.8842: 4.5820, 1.9342: 4.7309,
                       1.9914: 4.8729, 2.0414: 4.9691, }
        blue_curve = {0.0695: 0.1909, 0.1840: 0.1971, 0.2985: 0.2055, 0.4129: 0.2267, 0.5274: 0.2611, 0.6419: 0.3159,
                      0.7564: 0.3961, 0.8672: 0.5100, 0.9638: 0.6512, 1.0389: 0.7957, 1.0998: 0.9339, 1.1570: 1.0764,
                      1.2106: 1.2202, 1.2572: 1.3627, 1.3001: 1.5170, 1.3394: 1.6712, 1.3752: 1.8251, 1.4074: 1.9731,
                      1.4360: 2.1140, 1.4646: 2.2582, 1.4932: 2.4080, 1.5219: 2.5679, 1.5505: 2.7323, 1.5791: 2.9000,
                      1.6077: 3.0755, 1.6363: 3.2466, 1.6649: 3.4244, 1.6900: 3.5809, 1.7115: 3.7225, 1.7365: 3.8805,
                      1.7651: 4.0561, 1.7937: 4.2215, 1.8259: 4.3778, 1.8688: 4.5341, 1.9261: 4.6850, 2.0155: 4.8325,
                      2.1157: 4.9129, }
        red_log_exposure = xp.array(list(red_curve.keys()), dtype=default_dtype) - 0.1
        red_density_curve = xp.array(list(red_curve.values()), dtype=default_dtype)
        green_log_exposure = xp.array(list(green_curve.keys()), dtype=default_dtype) + 0.1
        green_density_curve = xp.array(list(green_curve.values()), dtype=default_dtype)
        blue_log_exposure = xp.array(list(blue_curve.keys()), dtype=default_dtype)
        blue_density_curve = xp.array(list(blue_curve.values()), dtype=default_dtype)
        self.log_exposure = [red_log_exposure, green_log_exposure, blue_log_exposure]
        self.density_curve = [red_density_curve, green_density_curve, blue_density_curve]

        # spectral dye density
        midscale_sd = {401.0358: 0.9359, 404.4390: 0.9427, 407.6202: 0.9550, 410.3676: 0.9701, 414.5726: 0.9968,
                       419.1010: 1.0335, 424.2116: 1.0756, 429.7751: 1.1036, 435.1445: 1.1250, 440.4492: 1.1363,
                       447.8887: 1.1430, 455.0048: 1.1376, 460.9564: 1.1243, 466.9728: 1.1036, 473.8947: 1.0629,
                       478.7466: 1.0218, 484.6982: 0.9748, 492.8494: 0.9367, 499.9654: 0.9207, 506.4346: 0.9220,
                       514.3270: 0.9411, 522.6722: 0.9781, 529.6589: 1.0255, 535.4811: 1.0656, 541.0446: 1.0969,
                       544.2792: 1.1136, 548.1607: 1.1243, 552.0422: 1.1263, 556.3765: 1.1176, 559.9345: 1.1043,
                       565.4333: 1.0709, 573.3904: 1.0018, 577.1425: 0.9694, 583.5469: 0.9357, 590.5336: 0.9187,
                       599.0729: 0.9194, 607.3534: 0.9397, 615.7633: 0.9868, 620.8093: 1.0352, 627.2137: 1.0963,
                       634.5239: 1.1620, 646.8153: 1.2721, 651.8612: 1.2998, 659.4301: 1.3205, 666.3521: 1.3212,
                       674.3739: 1.3002, 682.8485: 1.2388, 699.6683: 1.0609}
        red_sd = {400.6639: 0.3877, 408.7503: 0.3360, 422.9825: 0.2826, 437.2146: 0.2242, 454.0344: 0.1641,
                  470.2073: 0.1257, 492.5259: 0.1104, 517.7556: 0.1174, 540.0742: 0.1614, 559.1582: 0.2392,
                  573.0669: 0.3410, 588.2694: 0.4828, 609.9411: 0.7331, 626.9550: 0.9407, 640.6696: 1.1036,
                  646.4918: 1.1570, 653.2844: 1.1971, 661.6943: 1.2204, 669.4573: 1.2204, 679.1611: 1.1920,
                  686.6006: 1.1336, 699.2155: 1.0102}
        green_sd = {400.3404: 0.2092, 405.8392: 0.1891, 413.6022: 0.1841, 422.4650: 0.1962, 431.3924: 0.1992,
                    440.4492: 0.1928, 446.5949: 0.1791, 454.6814: 0.1758, 464.1910: 0.1968, 475.0592: 0.2499,
                    480.4286: 0.2899, 485.8627: 0.3276, 499.2538: 0.4892, 503.7822: 0.5449, 509.3457: 0.5896,
                    514.3917: 0.6370, 521.3137: 0.7331, 526.1655: 0.8032, 533.9285: 0.8700, 539.7508: 0.9067,
                    545.5730: 0.9267, 550.6189: 0.9254, 555.9236: 0.9000, 563.2338: 0.8066, 583.8057: 0.5246,
                    596.0971: 0.3537, 601.0784: 0.2919, 608.9707: 0.2285, 622.1031: 0.1735, 639.0523: 0.1307,
                    660.4005: 0.0944, 684.0129: 0.0677, 698.8920: 0.0573}
        blue_sd = {400.7933: 0.5042, 406.7449: 0.5322, 413.9904: 0.6077, 420.9124: 0.6998, 430.6808: 0.7952,
                   437.6675: 0.8553, 443.6838: 0.8900, 451.7702: 0.9084, 459.2098: 0.9040, 466.6493: 0.8700,
                   470.8542: 0.8299, 487.6094: 0.6197, 502.1650: 0.4211, 510.6396: 0.3110, 522.3487: 0.2222,
                   535.2223: 0.1591, 553.3360: 0.1024, 577.9188: 0.0630, 605.0892: 0.0590, 634.2004: 0.0690,
                   668.1635: 0.0707, 698.8920: 0.0573}
        self.spectral_density = [colour.SpectralDistribution(x) for x in (red_sd, green_sd, blue_sd)]
        self.d_ref_sd = colour.SpectralDistribution(midscale_sd)

        self.calibrate()
