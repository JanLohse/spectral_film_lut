from spectral_film_lut.film_spectral import *
from spectral_film_lut.wratten_filters import WRATTEN


class Kodak5384(FilmSpectral):
    def __init__(self):
        super().__init__()

        self.lad = [1.08, 1.04, 1.03]
        self.density_measure = 'status_a'
        self.exposure_kelvin = 2854
        self.manufacturer = 'Kodak'
        self.stage = 'print'
        self.type = 'negative'
        self.medium = 'cine'
        self.year = 1981
        self.alias = 'Eastman Color Print Film 5384/7384'

        # spectral sensitivity
        red_log_sensitivity = {369.2286: -1.0118, 379.0892: -1.0478, 388.9351: -1.1023, 397.8021: -1.2037,
                               405.4939: -1.3024, 412.2415: -1.4042, 417.3417: -1.5050, 421.2633: -1.6074,
                               424.2706: -1.7292, 425.8915: -1.8582, 427.0908: -1.9790, 428.4132: -2.0932,
                               430.6575: -2.1993, 432.9581: -2.3005, 436.3609: -2.4139, 440.0986: -2.5503,
                               444.2068: -2.6649, 449.7686: -2.7775, 455.1002: -2.8833, 461.6133: -2.9838,
                               470.0092: -3.0855, 479.5951: -3.1709, 489.4480: -3.2167, 499.3220: -3.2357,
                               509.2120: -3.2346, 519.1236: -3.2061, 529.0605: -3.1457, 543.7833: -2.9883,
                               552.5793: -2.8821, 559.4844: -2.7849, 565.4517: -2.6827, 571.4161: -2.5841,
                               578.0866: -2.4858, 584.9954: -2.3841, 598.5643: -2.1971, 608.5091: -2.1268,
                               618.4446: -2.0681, 628.3817: -2.0076, 638.3234: -1.9410, 648.0524: -1.8459,
                               657.7690: -1.7664, 667.7057: -1.7062, 677.6157: -1.6798, 687.4894: -1.6992,
                               695.4280: -1.7836, 700.9905: -1.8952, 706.0884: -1.9990, 710.4792: -2.1036,
                               713.8252: -2.2061, 718.0789: -2.3186, 722.4723: -2.4199, 727.1042: -2.5174,
                               731.2594: -2.6222, 736.1192: -2.7292, 741.9562: -2.7915, }
        green_log_sensitivity = {366.3156: -0.2304, 370.9005: -0.3277, 380.5627: -0.3763, 390.4110: -0.4279,
                                 399.5361: -0.5006, 406.5235: -0.5969, 411.3863: -0.7001, 415.0740: -0.8005,
                                 418.5340: -0.9285, 421.7815: -1.0522, 424.8106: -1.1554, 427.4258: -1.2587,
                                 430.2652: -1.3601, 433.6204: -1.4641, 441.2963: -1.5830, 451.1727: -1.5990,
                                 460.1935: -1.5061, 468.5123: -1.4076, 477.5416: -1.3040, 484.1846: -1.2406,
                                 505.8017: -0.9997, 515.3013: -0.8969, 524.5610: -0.7996, 534.2919: -0.7020,
                                 544.2479: -0.6175, 554.1637: -0.5838, 562.6063: -0.6264, 565.8614: -0.7380,
                                 568.5124: -0.8448, 571.0616: -0.9503, 573.3612: -1.0528, 575.3721: -1.1564,
                                 576.2688: -1.2794, 577.2706: -1.4019, 578.4968: -1.5218, 580.4050: -1.6394,
                                 582.4333: -1.7541, 584.2327: -1.8605, 586.0352: -1.9630, 587.8312: -2.0736,
                                 589.6369: -2.1721, 591.4119: -2.3092, 593.6719: -2.4826, 596.1225: -2.6047,
                                 598.5761: -2.7229, 600.6721: -2.8392, 602.8823: -2.9553, 604.4785: -3.0540,
                                 606.9087: -3.1567, 612.5517: -3.2658, 619.3196: -3.3419, }
        blue_log_sensitivity = {364.2526: 0.4352, 374.0422: 0.3095, 379.4380: 0.3222, 383.9888: 0.2883,
                                391.5978: 0.1788, 399.0866: 0.1055, 409.0597: 0.1281, 418.5156: 0.2153,
                                426.7178: 0.3174, 435.1147: 0.4230, 447.7406: 0.6084, 457.4314: 0.7336,
                                460.7867: 0.7683, 464.5511: 0.7262, 468.4686: 0.6185, 470.5074: 0.5172,
                                473.7242: 0.3836, 475.9788: 0.2575, 478.1835: 0.1343, 481.5243: -0.0078,
                                482.9433: -0.1321, 484.9544: -0.2685, 487.1133: -0.4164, 488.2799: -0.5290,
                                489.8406: -0.6395, 491.4719: -0.7797, 492.8958: -0.9016, 494.9675: -1.0039,
                                498.5826: -1.1961, 500.1070: -1.3193, 501.2091: -1.4473, 502.8562: -1.5478,
                                509.0309: -1.9765, 510.2284: -2.0832, 510.8686: -2.1997, 512.5254: -2.3210,
                                514.3728: -2.4263, 515.2899: -2.5331, 517.2141: -2.6441, 519.9508: -2.7562,
                                523.6370: -2.8585, 528.9676: -2.9657, 536.6651: -3.0572, 543.5680: -3.1521,
                                553.4760: -3.2364, 563.3156: -3.2988, 573.1771: -3.3336, 583.0449: -3.3606,
                                592.9075: -3.3939, 602.7645: -3.4344, 612.6145: -3.4839, 621.2809: -3.5412, }
        self.log_sensitivity = [red_log_sensitivity, green_log_sensitivity, blue_log_sensitivity]

        # sensiometry
        red_curve = {0.0793: 0.1008, 0.6773: 0.0948, 0.9156: 0.0924, 1.0329: 0.1155, 1.1786: 0.1627, 1.2900: 0.2123,
                     1.3954: 0.2924, 1.4808: 0.3868, 1.5581: 0.4915, 1.6131: 0.5924, 1.6662: 0.6973, 1.7398: 0.8710,
                     1.8177: 1.0934, 1.9550: 1.4774, 2.0433: 1.7645, 2.1215: 2.0436, 2.2099: 2.3510, 2.2900: 2.6220,
                     2.3701: 2.8768, 2.4541: 3.1072, 2.5299: 3.3052, 2.6136: 3.4950, 2.6728: 3.6121, 2.7482: 3.7371,
                     2.8316: 3.8457, 2.8987: 3.9282, 2.9880: 4.0085, 3.0690: 4.0644}
        green_curve = {0.0753: 0.0968, 0.5238: 0.1004, 0.8995: 0.0966, 1.0127: 0.1157, 1.1180: 0.1552, 1.2071: 0.2030,
                       1.2680: 0.2511, 1.3451: 0.3274, 1.4041: 0.3978, 1.4468: 0.4602, 1.5201: 0.5771, 1.5773: 0.6982,
                       1.6428: 0.8720, 1.7330: 1.1348, 1.8398: 1.4704, 1.9364: 1.8102, 2.0372: 2.1581, 2.1362: 2.5587,
                       2.2187: 2.8946, 2.2972: 3.2386, 2.3777: 3.5826, 2.4499: 3.8740, 2.5361: 4.1408, 2.6078: 4.3470,
                       2.6712: 4.5005, 2.7467: 4.6499, 2.8404: 4.7990, 2.9258: 4.9036, 2.9826: 4.9517, 3.0252: 4.9797}
        blue_curve = {0.0753: 0.0968, 0.4228: 0.1014, 0.6450: 0.1134, 0.7987: 0.1422, 0.9789: 0.2154, 1.1168: 0.3297,
                      1.2083: 0.4342, 1.2897: 0.5510, 1.3794: 0.7063, 1.4733: 0.9021, 1.6207: 1.2982, 1.7605: 1.7633,
                      1.8755: 2.1475, 1.9741: 2.4711, 2.0422: 2.7503, 2.1678: 3.2115, 2.2478: 3.4561, 2.3253: 3.6034,
                      2.4028: 3.7466, 2.5044: 3.8673, 2.5958: 3.9577, 2.7053: 4.0418, 2.8228: 4.1034, 2.9320: 4.1388,
                      3.0291: 4.1602}
        red_log_exposure = xp.array(list(red_curve.keys()), dtype=default_dtype) - 0.1
        red_density_curve = xp.array(list(red_curve.values()), dtype=default_dtype)
        green_log_exposure = xp.array(list(green_curve.keys()), dtype=default_dtype)
        green_density_curve = xp.array(list(green_curve.values()), dtype=default_dtype)
        blue_log_exposure = xp.array(list(blue_curve.keys()), dtype=default_dtype) + 0.15
        blue_density_curve = xp.array(list(blue_curve.values()), dtype=default_dtype)
        self.log_exposure = [red_log_exposure, green_log_exposure, blue_log_exposure]
        self.density_curve = [red_density_curve, green_density_curve, blue_density_curve]

        # spectral dye density
        midscale_sd = {359.8039: 0.7147, 366.2516: 0.6651, 374.9857: 0.6485, 381.8919: 0.6616, 388.9556: 0.6940,
                       398.0271: 0.7795, 409.7694: 0.9141, 424.2183: 1.0863, 430.9299: 1.1626, 437.0380: 1.2235,
                       441.2759: 1.2572, 445.5893: 1.2663, 452.9813: 1.2626, 461.2813: 1.2460, 469.1709: 1.2217,
                       477.9606: 1.1870, 484.7749: 1.1594, 491.1193: 1.1434, 501.1200: 1.1384, 512.3794: 1.1478,
                       520.5681: 1.1673, 527.9005: 1.1830, 537.0051: 1.1871, 545.3130: 1.1679, 549.7814: 1.1267,
                       560.9641: 1.0197, 570.4103: 0.9127, 577.1644: 0.8341, 582.5288: 0.7839, 588.6601: 0.7666,
                       598.4358: 0.7642, 607.6920: 0.7896, 616.2434: 0.8325, 627.0990: 0.9025, 634.1150: 0.9504,
                       642.6703: 0.9920, 648.2663: 1.0076, 658.2233: 1.0169, 668.6660: 1.0094, 676.8005: 0.9760,
                       685.8986: 0.9116, 706.8426: 0.7364, 725.2374: 0.5431, 737.8813: 0.3845}
        red_sd = {359.2346: 0.2645, 365.2686: 0.2788, 375.6836: 0.2804, 383.1391: 0.2560, 392.8328: 0.2097,
                  405.6090: 0.1493, 423.1526: 0.0916, 437.5760: 0.0603, 465.4491: 0.0319, 489.7520: 0.0351,
                  504.0323: 0.0503, 519.5634: 0.0823, 536.3670: 0.1240, 546.6708: 0.1617, 556.0904: 0.2046,
                  573.5796: 0.3057, 589.2607: 0.4301, 607.7425: 0.6320, 617.8436: 0.7356, 626.0746: 0.8120,
                  632.6248: 0.8703, 637.2730: 0.9117, 644.1078: 0.9481, 650.9782: 0.9728, 660.0551: 0.9859,
                  671.3621: 0.9797, 680.3530: 0.9502, 687.0137: 0.9019, 703.9334: 0.7648, 721.6293: 0.5869,
                  733.3614: 0.4425, 737.8932: 0.3807}
        green_sd = {360.6629: 0.0824, 374.1405: 0.0762, 389.5261: 0.0850, 406.5765: 0.1170, 415.1795: 0.1431,
                    429.3904: 0.1809, 436.0279: 0.2108, 440.5385: 0.2264, 447.5123: 0.2175, 454.8804: 0.2215,
                    462.6350: 0.2411, 469.2249: 0.2865, 480.8177: 0.3991, 489.5569: 0.5220, 499.9532: 0.6708,
                    507.0075: 0.7769, 512.8191: 0.8636, 518.7181: 0.9219, 525.0988: 0.9646, 529.7947: 0.9906,
                    535.3946: 1.0049, 543.2286: 0.9986, 548.1073: 0.9652, 554.3995: 0.8956, 564.5644: 0.7666,
                    575.0537: 0.6028, 586.2974: 0.4055, 592.6650: 0.3113, 598.2941: 0.2456, 606.5160: 0.1838,
                    615.5824: 0.1297, 629.8661: 0.0733, 639.9383: 0.0451, 653.4517: 0.0273, 676.9260: 0.0175,
                    693.0004: 0.0140, 706.4781: 0.0079, 722.1025: 0.0096, 730.7889: 0.0085, 738.6150: 0.0048}
        blue_sd = {359.7295: 0.3859, 364.1819: 0.3498, 370.7851: 0.3203, 378.5596: 0.3334, 386.1196: 0.4162,
                   399.2701: 0.5871, 413.9043: 0.7695, 425.0629: 0.8822, 433.5269: 0.9534, 438.8601: 0.9839,
                   444.2389: 0.9995, 449.8686: 1.0042, 455.9980: 0.9875, 461.7488: 0.9528, 468.9251: 0.8781,
                   478.0087: 0.7478, 489.6548: 0.5608, 499.0389: 0.4034, 513.1004: 0.2074, 529.9704: 0.0864,
                   549.2743: 0.0210, 574.0650: 0.0067, 621.8283: 0.0046, 664.8103: 0.0043, 737.3087: 0.0060}
        self.spectral_density = [colour.SpectralDistribution(x) for x in (red_sd, green_sd, blue_sd)]
        self.d_ref_sd = colour.SpectralDistribution(midscale_sd)

        self.calibrate()

        self.sensitivity *= WRATTEN['2B'].reshape(-1, 1)