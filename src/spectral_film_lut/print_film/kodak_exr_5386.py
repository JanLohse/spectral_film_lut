from spectral_film_lut.film_spectral import *


class KodakExr5386(FilmSpectral):
    def __init__(self):
        super().__init__()

        self.lad = [1.10, 1.06, 1.03]
        self.density_measure = 'status_a'
        self.manufacturer = 'Kodak'
        self.stage = 'print'
        self.type = 'negative'
        self.medium = 'cine'
        self.year = 1993
        self.alias = 'EASTMAN EXR Color Print Film 5386/7386/2386/3386'

        # spectral sensitivity
        red_log_sensitivity = {369.7521: -0.3135, 386.2810: -0.2679, 400.1653: -0.3240, 410.2479: -0.5590,
                               420.0000: -0.8676, 430.4132: -1.3797, 439.5041: -1.8812, 453.5537: -2.2267,
                               465.6198: -2.5616, 483.4711: -2.9895, 528.7603: -2.9895, 549.9174: -2.7019,
                               577.3554: -2.3687, 588.5950: -2.1933, 600.4959: -2.0495, 609.4215: -1.8812,
                               625.9504: -1.6848, 642.4793: -1.5199, 652.2314: -1.4305, 660.0000: -1.3551,
                               668.2645: -1.2218, 676.5289: -1.1026, 680.8264: -1.0447, 693.3884: -1.0991,
                               708.2645: -1.4042, 722.1488: -1.8181, 727.1074: -1.9794, 729.9174: -2.0951}
        green_log_sensitivity = {400.8264: -0.6221, 414.0496: -1.0149, 418.6777: -1.1973, 426.1157: -1.4568,
                                 429.9174: -1.5620, 435.5372: -1.6374, 440.4959: -1.6515, 447.4380: -1.5831,
                                 457.8512: -1.4095, 471.7355: -1.1675, 486.2810: -0.9570, 498.3471: -0.8203,
                                 507.9339: -0.7308, 515.8678: -0.6817, 526.1157: -0.6537, 533.7190: -0.6361,
                                 542.4793: -0.5958, 547.9339: -0.5537, 552.5620: -0.5274, 558.5124: -0.5379,
                                 562.6446: -0.6186, 569.9174: -0.9202, 577.3554: -1.3902, 583.6364: -1.8356,
                                 589.9174: -2.3284}
        blue_log_sensitivity = {399.8347: 0.0057, 406.9421: 0.0267, 414.0496: 0.0864, 422.1488: 0.2074,
                                429.0909: 0.3231, 435.0413: 0.4003, 441.3223: 0.4739, 447.7686: 0.5704,
                                453.0579: 0.6721, 457.3554: 0.7598, 460.9917: 0.7913, 464.9587: 0.7703,
                                468.2645: 0.7036, 471.2397: 0.6019, 475.8678: 0.3354, 481.1570: -0.1135,
                                483.8017: -0.3976, 489.9174: -1.0149, 495.2066: -1.5059, 497.8512: -1.7479,
                                499.8347: -1.9075}
        self.log_sensitivity = [red_log_sensitivity, green_log_sensitivity, blue_log_sensitivity]

        # sensiometry
        red_curve = {-0.6995: 0.0409, -0.4571: 0.0443, -0.1976: 0.0562, -0.0320: 0.0767, 0.1080: 0.1142, 0.2053: 0.1500,
                     0.2941: 0.1977, 0.3675: 0.2505, 0.4324: 0.3085, 0.4870: 0.3767, 0.5382: 0.4550, 0.5945: 0.5590,
                     0.6458: 0.6749, 0.6970: 0.8147, 0.7499: 0.9783, 0.8199: 1.2237, 0.8950: 1.5236, 0.9838: 1.8918,
                     1.0623: 2.2122, 1.1460: 2.5428, 1.2108: 2.7951, 1.2774: 2.9996, 1.3508: 3.1939, 1.4908: 3.4768,
                     1.5711: 3.5756, 1.6530: 3.6455, 1.7298: 3.7000, 1.8220: 3.7529, 1.9245: 3.7938, 2.0303: 3.8176,
                     2.1635: 3.8296, 2.3871: 3.8483}
        green_curve = {-0.7012: 0.0426, -0.5561: 0.0426, -0.4025: 0.0494, -0.2557: 0.0579, -0.1259: 0.0682,
                       -0.0064: 0.0920, 0.0841: 0.1261, 0.1643: 0.1636, 0.2446: 0.2182, 0.3231: 0.2812, 0.3811: 0.3494,
                       0.4392: 0.4295, 0.5041: 0.5403, 0.5826: 0.7022, 0.6304: 0.8283, 0.6918: 0.9953, 0.7584: 1.2066,
                       0.8387: 1.4793, 0.9223: 1.7895, 1.0026: 2.0878, 1.0794: 2.3758, 1.1801: 2.7081, 1.2638: 2.9791,
                       1.3713: 3.2450, 1.4652: 3.4393, 1.5403: 3.5824, 1.6052: 3.6608, 1.6735: 3.7256, 1.7469: 3.7750,
                       1.8562: 3.8193, 1.9774: 3.8517, 2.1652: 3.8688, 2.3820: 3.8790}
        blue_curve = {-0.7029: 0.1227, -0.5083: 0.1210, -0.3000: 0.1278, -0.1532: 0.1398, -0.0269: 0.1585,
                      0.0551: 0.1824, 0.1370: 0.2130, 0.2121: 0.2522, 0.2770: 0.3000, 0.3385: 0.3511, 0.3982: 0.4176,
                      0.4580: 0.5011, 0.5109: 0.5863, 0.5809: 0.7226, 0.6389: 0.8556, 0.6918: 0.9987, 0.7567: 1.1998,
                      0.8096: 1.3805, 0.8626: 1.5577, 0.9326: 1.8304, 0.9872: 2.0383, 1.0862: 2.4031, 1.1886: 2.7507,
                      1.2706: 3.0030, 1.3338: 3.1905, 1.4003: 3.3643, 1.4601: 3.5109, 1.5420: 3.6745, 1.6137: 3.7767,
                      1.6991: 3.8585, 1.7742: 3.8994, 1.8801: 3.9352, 2.0166: 3.9591, 2.1959: 3.9693, 2.3769: 3.9693}
        red_log_exposure = xp.array(list(red_curve.keys()), dtype=default_dtype)
        red_density_curve = xp.array(list(red_curve.values()), dtype=default_dtype)
        green_log_exposure = xp.array(list(green_curve.keys()), dtype=default_dtype)
        green_density_curve = xp.array(list(green_curve.values()), dtype=default_dtype)
        blue_log_exposure = xp.array(list(blue_curve.keys()), dtype=default_dtype)
        blue_density_curve = xp.array(list(blue_curve.values()), dtype=default_dtype)
        self.log_exposure = [red_log_exposure, green_log_exposure, blue_log_exposure]
        self.density_curve = [red_density_curve, green_density_curve, blue_density_curve]

        # spectral dye density
        midscale_sd = {400.2463: 0.4712, 408.0577: 0.5680, 415.0246: 0.6500, 423.0471: 0.7362, 430.0141: 0.8019,
                       437.1921: 0.8528, 442.6812: 0.8824, 447.9592: 0.8951, 455.7706: 0.8824, 463.5820: 0.8266,
                       474.9824: 0.7051, 488.7051: 0.5228, 503.2723: 0.3221, 510.8726: 0.2402, 520.7952: 0.1512,
                       530.7178: 0.0876, 544.2294: 0.0381, 564.4968: 0.0120, 599.9648: 0.0042, 633.7438: 0.0070,
                       667.5229: 0.0162, 698.1351: 0.0268}
        red_sd = {400.6685: 0.3122, 424.3139: 0.1907, 443.7368: 0.0960, 460.2041: 0.0473, 473.7157: 0.0325,
                  492.7164: 0.0395, 515.3061: 0.0706, 531.5623: 0.1158, 548.8740: 0.1950, 579.0640: 0.4380,
                  593.8424: 0.6161, 613.2653: 0.8846, 627.1992: 1.0499, 635.6439: 1.1333, 643.8776: 1.1954,
                  650.6334: 1.2258, 657.8114: 1.2407, 669.8452: 1.2286, 679.1344: 1.1820, 688.4236: 1.1156,
                  694.3350: 1.0647, 698.3462: 1.0259}
        green_sd = {401.0908: 0.0904, 415.4469: 0.1102, 428.5362: 0.1194, 441.2034: 0.1222, 450.0704: 0.1243,
                    459.5707: 0.1512, 474.5602: 0.2529, 484.9050: 0.3589, 496.7277: 0.5016, 508.1281: 0.6542,
                    517.6284: 0.7687, 524.8065: 0.8464, 530.9289: 0.8966, 536.6291: 0.9269, 542.1182: 0.9382,
                    549.0852: 0.9234, 555.4187: 0.8789, 566.6080: 0.7404, 584.5531: 0.4634, 596.3758: 0.3024,
                    606.7206: 0.1992, 617.2766: 0.1321, 636.2773: 0.0692, 665.4117: 0.0325, 697.5018: 0.0106}
        blue_sd = {400.2463: 0.4712, 408.0577: 0.5680, 415.0246: 0.6500, 423.0471: 0.7362, 430.0141: 0.8019,
                   437.1921: 0.8528, 442.6812: 0.8824, 447.9592: 0.8951, 455.7706: 0.8824, 463.5820: 0.8266,
                   474.9824: 0.7051, 488.7051: 0.5228, 503.2723: 0.3221, 510.8726: 0.2402, 520.7952: 0.1512,
                   530.7178: 0.0876, 544.2294: 0.0381, 564.4968: 0.0120, 599.9648: 0.0042, 633.7438: 0.0070,
                   667.5229: 0.0162, 698.1351: 0.0268}
        self.spectral_density = [colour.SpectralDistribution(x) for x in (red_sd, green_sd, blue_sd)]
        self.d_ref_sd = colour.SpectralDistribution(midscale_sd)

        self.calibrate()
