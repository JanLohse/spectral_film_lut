from spectral_film_lut.film_spectral import *
from spectral_film_lut.wratten_filters import WRATTEN
from spectral_film_lut.print_film.kodak_5383 import *


class Kodak5381(FilmSpectral):
    def __init__(self):
        super().__init__()

        self.lad = [1.08, 1.04, 1.03]
        self.density_measure = 'status_a'
        self.exposure_kelvin = 2854
        self.projection_kelvin = 6500
        self.manufacturer = 'Kodak'
        self.stage = 'print'
        self.type = 'negative'
        self.medium = 'cine'
        self.year = 1950

        # spectral sensitivity
        red_log_sensitivity = {369.2286: -1.0118, 379.0892: -1.0478, 388.9351: -1.1023, 397.8021: -1.2037,
                               405.4939: -1.3024, 412.2415: -1.4042, 417.3417: -1.5050, 421.2633: -1.6074,
                               424.2706: -1.7292, 425.8915: -1.8582, 427.0908: -1.9790, 428.4132: -2.0932,
                               430.6575: -2.1993, 432.9581: -2.3005, 436.3609: -2.4139, 440.0986: -2.5503,
                               444.2068: -2.6649, 449.7686: -2.7775, 455.1002: -2.8833, 461.6133: -2.9838,
                               470.0092: -3.0855, 479.5951: -3.1709, 489.4480: -3.2167, 499.3220: -3.2357,
                               509.2120: -3.2346, 519.1236: -3.2061, 529.0605: -3.1457, 543.7833: -2.9883,
                               552.5793: -2.8821, 559.4844: -2.7849, 565.4517: -2.6827, 571.4161: -2.5841,
                               578.0866: -2.4858, 584.9954: -2.3841, 598.5643: -2.1971, 608.5091: -2.1268,
                               618.4446: -2.0681, 628.3817: -2.0076, 638.3234: -1.9410, 648.0524: -1.8459,
                               657.7690: -1.7664, 667.7057: -1.7062, 677.6157: -1.6798, 687.4894: -1.6992,
                               695.4280: -1.7836, 700.9905: -1.8952, 706.0884: -1.9990, 710.4792: -2.1036,
                               713.8252: -2.2061, 718.0789: -2.3186, 722.4723: -2.4199, 727.1042: -2.5174,
                               731.2594: -2.6222, 736.1192: -2.7292, 741.9562: -2.7915, }
        green_log_sensitivity = {366.3156: -0.2304, 370.9005: -0.3277, 380.5627: -0.3763, 390.4110: -0.4279,
                                 399.5361: -0.5006, 406.5235: -0.5969, 411.3863: -0.7001, 415.0740: -0.8005,
                                 418.5340: -0.9285, 421.7815: -1.0522, 424.8106: -1.1554, 427.4258: -1.2587,
                                 430.2652: -1.3601, 433.6204: -1.4641, 441.2963: -1.5830, 451.1727: -1.5990,
                                 460.1935: -1.5061, 468.5123: -1.4076, 477.5416: -1.3040, 484.1846: -1.2406,
                                 505.8017: -0.9997, 515.3013: -0.8969, 524.5610: -0.7996, 534.2919: -0.7020,
                                 544.2479: -0.6175, 554.1637: -0.5838, 562.6063: -0.6264, 565.8614: -0.7380,
                                 568.5124: -0.8448, 571.0616: -0.9503, 573.3612: -1.0528, 575.3721: -1.1564,
                                 576.2688: -1.2794, 577.2706: -1.4019, 578.4968: -1.5218, 580.4050: -1.6394,
                                 582.4333: -1.7541, 584.2327: -1.8605, 586.0352: -1.9630, 587.8312: -2.0736,
                                 589.6369: -2.1721, 591.4119: -2.3092, 593.6719: -2.4826, 596.1225: -2.6047,
                                 598.5761: -2.7229, 600.6721: -2.8392, 602.8823: -2.9553, 604.4785: -3.0540,
                                 606.9087: -3.1567, 612.5517: -3.2658, 619.3196: -3.3419, }
        blue_log_sensitivity = {361.0419: 1.0429, 368.8850: 0.9330, 378.7820: 0.9430, 388.6976: 0.9765,
                                398.5816: 0.9701, 408.4359: 0.9261, 418.0261: 0.8461, 426.6588: 0.7462,
                                433.8757: 0.6424, 437.6008: 0.5892, 445.4834: 0.4340, 450.1047: 0.3231,
                                454.0266: 0.2210, 458.1841: 0.1191, 462.3400: 0.0153, 466.0267: -0.0865,
                                469.0059: -0.1896, 471.3140: -0.2907, 472.8488: -0.3915, 474.6418: -0.5059,
                                476.8592: -0.6131, 479.6880: -0.7289, 482.1704: -0.8439, 484.6975: -0.9497,
                                486.7863: -1.0474, 491.2146: -1.2830, 494.4065: -1.4150, 496.9549: -1.5270,
                                499.3844: -1.6108, 508.2485: -1.9239, 510.3831: -2.0530, 510.4143: -2.1623,
                                511.9048: -2.2721, 513.4182: -2.3829, 514.8885: -2.4886, 516.0789: -2.5909,
                                518.7610: -2.7034, 521.8254: -2.8172, 526.6470: -2.9229, 531.5194: -3.0140,
                                536.1631: -3.0966, 545.9896: -3.1756, 555.8172: -3.2532, 565.6620: -3.3091,
                                575.5263: -3.3404, 585.3940: -3.3674, 595.2547: -3.4032, 605.1101: -3.4458,
                                614.9583: -3.4975, 622.4508: -3.5505, }
        self.log_sensitivity = [red_log_sensitivity, green_log_sensitivity, blue_log_sensitivity]

        # sensiometry
        red_curve = {0.5707: 0.0371, 0.6526: 0.0343, 0.7367: 0.0350, 0.8208: 0.0411, 0.9049: 0.0542, 0.9889: 0.0862,
                     1.0729: 0.1407, 1.1453: 0.2077, 1.1986: 0.2756, 1.2404: 0.3452, 1.2708: 0.4100, 1.4703: 0.8985,
                     1.7356: 1.5386, 1.9975: 2.1693, 2.2191: 2.7043, 2.2533: 2.7847, 2.2836: 2.8571, 2.3140: 2.9302,
                     2.3443: 3.0018, 2.3747: 3.0733, 2.4088: 3.1510}
        green_curve = {0.5529: 0.1098, 0.6829: 0.1026, 0.7543: 0.1081, 0.8511: 0.1368, 0.9198: 0.1661, 1.1308: 0.3148,
                       1.2230: 0.4136, 1.3183: 0.5331, 1.4076: 0.6777, 1.4456: 0.7601, 1.5199: 0.9425, 1.6219: 1.2437,
                       1.7575: 1.6077, 1.9343: 2.1174, 1.9646: 2.2003, 2.0025: 2.3083, 2.0290: 2.3812, 2.0543: 2.4527,
                       2.0858: 2.5408, 2.1123: 2.6131, 2.1464: 2.7098, 2.1767: 2.7944, 2.2222: 2.9179, 2.2525: 2.9992,
                       2.2904: 3.1032, 2.3207: 3.1853, 2.3586: 3.2975, 2.3889: 3.3779}
        blue_curve = {0.5529: 0.1098, 0.6829: 0.1026, 0.7543: 0.1081, 0.8511: 0.1368, 0.9308: 0.1726, 1.0146: 0.2326,
                      1.0876: 0.3166, 1.1317: 0.3834, 1.1895: 0.4738, 1.2359: 0.5486, 1.2910: 0.6526, 1.3309: 0.7339,
                      1.3689: 0.8217, 1.4068: 0.9119, 1.4472: 1.0200, 1.4801: 1.1089, 1.5230: 1.2281, 1.5546: 1.3224,
                      1.5912: 1.4242, 1.6240: 1.5163, 1.6492: 1.5922, 1.6833: 1.6889, 1.7136: 1.7718, 1.7439: 1.8620,
                      1.7705: 1.9335, 1.7982: 2.0126, 1.8273: 2.1001, 1.8576: 2.1798, 1.8879: 2.2773, 1.9182: 2.3553,
                      1.9560: 2.4659, 1.9864: 2.5480, 2.0154: 2.6357, 2.0482: 2.7246, 2.0773: 2.8121, 2.1076: 2.8926,
                      2.1442: 2.9966, 2.1770: 3.0822, 2.2048: 3.1667, 2.2326: 3.2415, 2.2667: 3.3371, 2.3046: 3.4428,
                      2.3424: 3.5517, 2.3614: 3.5915}
        log_H_scaling = 0.8
        red_log_exposure = xp.array(list(red_curve.keys()), dtype=default_dtype) * log_H_scaling
        red_density_curve = xp.array(list(red_curve.values()), dtype=default_dtype)
        green_log_exposure = xp.array(list(green_curve.keys()), dtype=default_dtype) * log_H_scaling
        green_density_curve = xp.array(list(green_curve.values()), dtype=default_dtype)
        blue_log_exposure = xp.array(list(blue_curve.keys()), dtype=default_dtype) * log_H_scaling
        blue_density_curve = xp.array(list(blue_curve.values()), dtype=default_dtype)
        self.log_exposure = [red_log_exposure, green_log_exposure, blue_log_exposure]
        self.density_curve = [red_density_curve, green_density_curve, blue_density_curve]

        # spectral dye density
        midscale_sd = {408.4668: 1.4885, 415.8524: 1.5527, 423.2383: 1.6181, 430.6244: 1.6845, 438.0105: 1.7510,
                       446.6905: 1.7844, 456.2251: 1.7582, 465.7669: 1.7660, 475.2998: 1.7318, 484.8313: 1.6909,
                       494.3703: 1.6856, 503.9154: 1.7085, 513.0342: 1.7662, 520.8544: 1.8347, 529.1068: 1.8967,
                       538.6548: 1.9333, 548.1907: 1.9132, 555.5507: 1.8571, 560.3064: 1.7896, 564.1941: 1.7186,
                       567.6485: 1.6493, 571.9708: 1.5830, 578.4608: 1.5141, 587.1263: 1.4792, 595.3722: 1.5106,
                       601.0253: 1.5842, 604.9431: 1.6548, 608.4261: 1.7198, 611.9090: 1.7847, 615.3926: 1.8525,
                       618.8756: 1.9175, 622.7929: 1.9855, 627.1445: 2.0569, 631.4953: 2.1242, 636.2799: 2.1927,
                       641.4978: 2.2591, 647.1490: 2.3243, 654.9693: 2.3934, 664.5153: 2.4206, 674.0481: 2.3858,
                       682.2739: 2.3229, 688.7648: 2.2581, 694.3880: 2.1913, 697.8472: 2.1446, }
        red_sd = {406.9554: 0.4992, 413.8802: 0.4356, 419.5037: 0.3703, 432.0536: 0.2493, 441.1467: 0.1862,
                  450.6761: 0.1353, 460.2078: 0.0957, 469.7421: 0.0682, 479.2794: 0.0544, 488.8197: 0.0550,
                  498.3615: 0.0629, 507.9053: 0.0796, 517.4515: 0.1084, 527.0009: 0.1514, 533.5132: 0.1875,
                  546.1089: 0.2815, 553.0603: 0.3429, 559.1447: 0.4058, 564.7964: 0.4734, 570.0150: 0.5433,
                  574.8005: 0.6153, 577.4115: 0.6584, 583.9419: 0.7794, 587.4261: 0.8502, 590.9114: 0.9262,
                  593.9618: 0.9957, 596.5772: 1.0597, 599.1931: 1.1256, 601.8098: 1.1954, 604.4268: 1.2662,
                  607.0441: 1.3390, 609.6625: 1.4167, 612.2809: 1.4944, 614.8978: 1.5652, 617.5139: 1.6321,
                  620.5650: 1.7051, 624.0503: 1.7811, 627.5348: 1.8534, 631.0183: 1.9205, 634.9361: 1.9909,
                  639.2881: 2.0641, 643.6386: 2.1302, 648.4226: 2.1958, 654.0743: 2.2632, 661.8908: 2.3144,
                  670.9479: 2.3084, 680.0912: 2.2547, 687.0170: 2.1961, 692.6408: 2.1323, 695.6673: 2.0900, }
        green_sd = {409.9425: 0.2714, 417.3194: 0.2950, 432.5116: 0.3639, 442.0593: 0.3991, 451.5956: 0.3810,
                    461.1377: 0.3902, 468.9573: 0.4559, 474.6088: 0.5222, 478.9608: 0.5955, 482.4451: 0.6663,
                    485.9285: 0.7334, 488.9755: 0.7873, 497.6840: 0.9549, 501.6012: 1.0226, 505.0836: 1.0846,
                    509.0008: 1.1526, 513.3531: 1.2270, 517.7050: 1.2996, 522.0565: 1.3704, 526.8415: 1.4405,
                    534.2275: 1.5066, 543.7682: 1.5091, 550.6925: 1.4433, 554.5820: 1.3808, 557.6025: 1.3100,
                    560.1862: 1.2245, 562.7696: 1.1380, 565.3552: 1.0613, 567.9418: 0.9896, 570.9616: 0.9156,
                    574.4142: 0.8383, 577.4364: 0.7754, 585.6442: 0.6275, 590.3991: 0.5564, 595.1559: 0.4938,
                    600.7790: 0.4268, 607.2692: 0.3589, 614.6273: 0.2936, 623.2869: 0.2311, 632.8163: 0.1808,
                    642.3490: 0.1455, 651.8832: 0.1172, 661.4186: 0.0950, 670.9556: 0.0798, 680.4932: 0.0678,
                    690.0318: 0.0607, 695.6686: 0.0578, }
        blue_sd = {406.1369: 0.7285, 410.9226: 0.8019, 415.2741: 0.8727, 419.6244: 0.9376, 423.9743: 1.0008,
                   428.7577: 1.0635, 434.4099: 1.1331, 440.4951: 1.1998, 448.3155: 1.2693, 457.8614: 1.2962,
                   466.9624: 1.2705, 473.4522: 1.2007, 477.7746: 1.1346, 481.6636: 1.0696, 485.1186: 1.0033,
                   488.5716: 0.9274, 490.7301: 0.8817, 495.4748: 0.7623, 498.9292: 0.6930, 502.8167: 0.6211,
                   507.1386: 0.5527, 511.8940: 0.4837, 517.5164: 0.4130, 524.0061: 0.3426, 530.4982: 0.2837,
                   544.3540: 0.1861, 553.8836: 0.1361, 563.4163: 0.1013, 572.9513: 0.0770, 582.4886: 0.0634,
                   591.1596: 0.0545, 609.3698: 0.0409, 618.9088: 0.0355, 628.4481: 0.0314, 636.7956: 0.0307,
                   649.2617: 0.0249, 658.7048: 0.0217, 668.3408: 0.0192, 673.5445: 0.0192, }
        self.spectral_density = [colour.SpectralDistribution(x) for x in (red_sd, green_sd, blue_sd)]
        self.d_ref_sd = colour.SpectralDistribution(midscale_sd)

        self.calibrate()

        self.sensitivity *= WRATTEN['2B'].reshape(-1, 1)

if __name__ == '__main__':
    Kodak5381().plot_data(Kodak5383())