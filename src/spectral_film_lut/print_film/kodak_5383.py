from spectral_film_lut.film_spectral import *
from spectral_film_lut.wratten_filters import WRATTEN


class Kodak5383(FilmSpectral):
    def __init__(self):
        super().__init__()

        self.lad = [1.08, 1.04, 1.03]
        self.density_measure = 'status_a'
        self.exposure_kelvin = 2854
        self.projection_kelvin = 6500
        self.manufacturer = 'Kodak'
        self.stage = 'print'
        self.type = 'negative'
        self.medium = 'cine'
        self.year = 1974

        # spectral sensitivity
        red_log_sensitivity = {369.2286: -1.0118, 379.0892: -1.0478, 388.9351: -1.1023, 397.8021: -1.2037,
                               405.4939: -1.3024, 412.2415: -1.4042, 417.3417: -1.5050, 421.2633: -1.6074,
                               424.2706: -1.7292, 425.8915: -1.8582, 427.0908: -1.9790, 428.4132: -2.0932,
                               430.6575: -2.1993, 432.9581: -2.3005, 436.3609: -2.4139, 440.0986: -2.5503,
                               444.2068: -2.6649, 449.7686: -2.7775, 455.1002: -2.8833, 461.6133: -2.9838,
                               470.0092: -3.0855, 479.5951: -3.1709, 489.4480: -3.2167, 499.3220: -3.2357,
                               509.2120: -3.2346, 519.1236: -3.2061, 529.0605: -3.1457, 543.7833: -2.9883,
                               552.5793: -2.8821, 559.4844: -2.7849, 565.4517: -2.6827, 571.4161: -2.5841,
                               578.0866: -2.4858, 584.9954: -2.3841, 598.5643: -2.1971, 608.5091: -2.1268,
                               618.4446: -2.0681, 628.3817: -2.0076, 638.3234: -1.9410, 648.0524: -1.8459,
                               657.7690: -1.7664, 667.7057: -1.7062, 677.6157: -1.6798, 687.4894: -1.6992,
                               695.4280: -1.7836, 700.9905: -1.8952, 706.0884: -1.9990, 710.4792: -2.1036,
                               713.8252: -2.2061, 718.0789: -2.3186, 722.4723: -2.4199, 727.1042: -2.5174,
                               731.2594: -2.6222, 736.1192: -2.7292, 741.9562: -2.7915, }
        green_log_sensitivity = {366.3156: -0.2304, 370.9005: -0.3277, 380.5627: -0.3763, 390.4110: -0.4279,
                                 399.5361: -0.5006, 406.5235: -0.5969, 411.3863: -0.7001, 415.0740: -0.8005,
                                 418.5340: -0.9285, 421.7815: -1.0522, 424.8106: -1.1554, 427.4258: -1.2587,
                                 430.2652: -1.3601, 433.6204: -1.4641, 441.2963: -1.5830, 451.1727: -1.5990,
                                 460.1935: -1.5061, 468.5123: -1.4076, 477.5416: -1.3040, 484.1846: -1.2406,
                                 505.8017: -0.9997, 515.3013: -0.8969, 524.5610: -0.7996, 534.2919: -0.7020,
                                 544.2479: -0.6175, 554.1637: -0.5838, 562.6063: -0.6264, 565.8614: -0.7380,
                                 568.5124: -0.8448, 571.0616: -0.9503, 573.3612: -1.0528, 575.3721: -1.1564,
                                 576.2688: -1.2794, 577.2706: -1.4019, 578.4968: -1.5218, 580.4050: -1.6394,
                                 582.4333: -1.7541, 584.2327: -1.8605, 586.0352: -1.9630, 587.8312: -2.0736,
                                 589.6369: -2.1721, 591.4119: -2.3092, 593.6719: -2.4826, 596.1225: -2.6047,
                                 598.5761: -2.7229, 600.6721: -2.8392, 602.8823: -2.9553, 604.4785: -3.0540,
                                 606.9087: -3.1567, 612.5517: -3.2658, 619.3196: -3.3419, }
        blue_log_sensitivity = {361.0419: 1.0429, 368.8850: 0.9330, 378.7820: 0.9430, 388.6976: 0.9765,
                                398.5816: 0.9701, 408.4359: 0.9261, 418.0261: 0.8461, 426.6588: 0.7462,
                                433.8757: 0.6424, 437.6008: 0.5892, 445.4834: 0.4340, 450.1047: 0.3231,
                                454.0266: 0.2210, 458.1841: 0.1191, 462.3400: 0.0153, 466.0267: -0.0865,
                                469.0059: -0.1896, 471.3140: -0.2907, 472.8488: -0.3915, 474.6418: -0.5059,
                                476.8592: -0.6131, 479.6880: -0.7289, 482.1704: -0.8439, 484.6975: -0.9497,
                                486.7863: -1.0474, 491.2146: -1.2830, 494.4065: -1.4150, 496.9549: -1.5270,
                                499.3844: -1.6108, 508.2485: -1.9239, 510.3831: -2.0530, 510.4143: -2.1623,
                                511.9048: -2.2721, 513.4182: -2.3829, 514.8885: -2.4886, 516.0789: -2.5909,
                                518.7610: -2.7034, 521.8254: -2.8172, 526.6470: -2.9229, 531.5194: -3.0140,
                                536.1631: -3.0966, 545.9896: -3.1756, 555.8172: -3.2532, 565.6620: -3.3091,
                                575.5263: -3.3404, 585.3940: -3.3674, 595.2547: -3.4032, 605.1101: -3.4458,
                                614.9583: -3.4975, 622.4508: -3.5505, }
        self.log_sensitivity = [red_log_sensitivity, green_log_sensitivity, blue_log_sensitivity]

        # sensiometry
        red_curve = {0.0874: 0.0967, 0.6854: 0.0988, 0.8995: 0.0925, 1.0714: 0.1293, 1.2312: 0.1784, 1.3366: 0.2463,
                     1.4503: 0.3466, 1.5214: 0.4351, 1.6131: 0.5843, 1.7009: 0.7741, 1.7686: 0.9803, 1.8466: 1.2188,
                     1.9388: 1.4775, 2.0315: 1.8255, 2.1180: 2.1572, 2.2025: 2.4809, 2.2787: 2.7682, 2.3485: 2.9947,
                     2.4100: 3.1766, 2.5000: 3.4029, 2.5858: 3.5886, 2.6694: 3.7419, 2.7610: 3.8749, 2.8322: 3.9634,
                     2.9052: 4.0316, 2.9782: 4.0816, 3.0470: 4.1093}
        green_curve = {0.0753: 0.0968, 0.5238: 0.1004, 0.8995: 0.0966, 1.0127: 0.1157, 1.1180: 0.1552, 1.2071: 0.2030,
                       1.2680: 0.2511, 1.3451: 0.3274, 1.4041: 0.3978, 1.4468: 0.4602, 1.5201: 0.5771, 1.5773: 0.6982,
                       1.6428: 0.8720, 1.7330: 1.1348, 1.8398: 1.4704, 1.9364: 1.8102, 2.0372: 2.1581, 2.1362: 2.5587,
                       2.2187: 2.8946, 2.2972: 3.2386, 2.3777: 3.5826, 2.4499: 3.8740, 2.5361: 4.1408, 2.6078: 4.3470,
                       2.6712: 4.5005, 2.7467: 4.6499, 2.8404: 4.7990, 2.9258: 4.9036, 2.9826: 4.9517, 3.0252: 4.9797}
        blue_curve = {0.0874: 0.1008, 0.5319: 0.1023, 0.7016: 0.1168, 0.8432: 0.1499, 0.9647: 0.1994, 1.0640: 0.2592,
                      1.1552: 0.3212, 1.2404: 0.3994, 1.3258: 0.5020, 1.4032: 0.6229, 1.4928: 0.7762, 1.5827: 0.9700,
                      1.6688: 1.2085, 1.7878: 1.5724, 1.9237: 2.0821, 2.0738: 2.6121, 2.1585: 2.9722, 2.2635: 3.3647,
                      2.3518: 3.6518, 2.4481: 3.9227, 2.5382: 4.1570, 2.6423: 4.3669, 2.7279: 4.5243, 2.8053: 4.6371,
                      2.8846: 4.7458, 2.9598: 4.8302, 3.0491: 4.9105}
        red_log_exposure = xp.array(list(red_curve.keys()), dtype=default_dtype) - 0.07
        red_density_curve = xp.array(list(red_curve.values()), dtype=default_dtype)
        green_log_exposure = xp.array(list(green_curve.keys()), dtype=default_dtype)
        green_density_curve = xp.array(list(green_curve.values()), dtype=default_dtype)
        blue_log_exposure = xp.array(list(blue_curve.keys()), dtype=default_dtype) + 0.07
        blue_density_curve = xp.array(list(blue_curve.values()), dtype=default_dtype)
        self.log_exposure = [red_log_exposure, green_log_exposure, blue_log_exposure]
        self.density_curve = [red_density_curve, green_density_curve, blue_density_curve]

        # spectral dye density
        midscale_sd = {360.0110: 0.7179, 364.4635: 0.6818, 369.3143: 0.6574, 375.3801: 0.6614, 380.4902: 0.6938,
                       392.6587: 0.8310, 405.8648: 0.9838, 419.1107: 1.1236, 430.0920: 1.2233, 435.6006: 1.2674,
                       439.0259: 1.2829, 443.1361: 1.2876, 448.8333: 1.2703, 462.2290: 1.2202, 474.3222: 1.1701,
                       483.3369: 1.1329, 491.6210: 1.1214, 499.8593: 1.1249, 508.4842: 1.1438, 518.8197: 1.1712,
                       530.0711: 1.1831, 540.3365: 1.1626, 548.0925: 1.1111, 560.0839: 1.0236, 577.8897: 0.8806,
                       583.6644: 0.8381, 590.6520: 0.8247, 596.7297: 0.8249, 605.1296: 0.8464, 614.5333: 0.8944,
                       625.6377: 0.9541, 635.0375: 1.0034, 642.3440: 1.0275, 649.9134: 1.0367, 661.8875: 1.0254,
                       670.9439: 0.9745, 689.1440: 0.8445, 703.9149: 0.7002, 720.0795: 0.5262, 727.4769: 0.4502,
                       736.6604: 0.3580}
        red_sd = {359.3458: 0.2283, 366.4632: 0.2433, 377.4916: 0.2572, 387.9085: 0.2581, 397.5088: 0.2421,
                  404.5382: 0.2152, 417.7485: 0.1548, 430.2819: 0.1028, 445.4239: 0.0495, 464.6166: 0.0203,
                  482.4295: 0.0162, 500.1789: 0.0327, 520.0253: 0.0732, 537.2075: 0.1331, 549.1921: 0.1889,
                  567.3086: 0.2978, 586.9948: 0.4610, 601.6687: 0.6306, 615.1237: 0.7730, 624.4083: 0.8598,
                  631.1794: 0.9168, 637.5642: 0.9583, 644.8568: 0.9868, 654.3698: 0.9993, 665.7066: 0.9835,
                  678.0964: 0.9075, 700.6233: 0.7117, 716.0930: 0.5519, 736.2322: 0.3561}
        green_sd = {360.6589: 0.0837, 371.0997: 0.0768, 386.2801: 0.0817, 399.6902: 0.0975, 408.2932: 0.1235,
                    410.8582: 0.1365, 416.0478: 0.1431, 428.0920: 0.1796, 435.8148: 0.2095, 439.6782: 0.2238,
                    447.0722: 0.2194, 454.0201: 0.2189, 462.6390: 0.2398, 469.8244: 0.3033, 488.4041: 0.5440,
                    502.7100: 0.7626, 508.9517: 0.8506, 514.1955: 0.9101, 518.6267: 0.9516, 523.3127: 0.9807,
                    527.8193: 0.9976, 534.5363: 1.0017, 541.3506: 0.9741, 548.7320: 0.9032, 566.3182: 0.6905,
                    576.3852: 0.5228, 591.4620: 0.2790, 605.6915: 0.1696, 632.0685: 0.0630, 654.3278: 0.0247,
                    678.0133: 0.0169, 691.2639: 0.0140, 701.6908: 0.0117, 720.7842: 0.0147, 730.7849: 0.0098,
                    738.8281: 0.0061}
        blue_sd = {359.2954: 0.3859, 365.0740: 0.3421, 369.9129: 0.3216, 374.2640: 0.3184, 378.9897: 0.3347,
                   384.8728: 0.3981, 396.1294: 0.5495, 410.3414: 0.7281, 419.1521: 0.8278, 429.5021: 0.9210,
                   435.4407: 0.9664, 439.5033: 0.9865, 443.3687: 1.0002, 448.1321: 1.0041, 454.6757: 0.9940,
                   459.5305: 0.9682, 471.8661: 0.8394, 486.6860: 0.6085, 503.3497: 0.3428, 510.6214: 0.2371,
                   519.3569: 0.1494, 529.9684: 0.0870, 545.3335: 0.0319, 558.8608: 0.0096, 579.7066: 0.0075,
                   608.8026: 0.0049, 656.5580: 0.0054}
        self.spectral_density = [colour.SpectralDistribution(x) for x in (red_sd, green_sd, blue_sd)]
        self.d_ref_sd = colour.SpectralDistribution(midscale_sd)

        self.calibrate()

        self.sensitivity *= WRATTEN['2B'].reshape(-1, 1)
