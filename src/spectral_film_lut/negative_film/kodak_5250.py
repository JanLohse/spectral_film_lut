from spectral_film_lut.film_spectral import *
from spectral_film_lut.negative_film.kodak_5247_II import *


class Kodak5250(FilmSpectral):
    def __init__(self):
        super().__init__()

        self.iso = 50
        self.density_measure = 'status_m'
        self.exposure_kelvin = 3200

        # spectral sensitivity
        red_log_sensitivity = {588.5090: 0.4953, 596.9532: 0.8364, 606.4160: 1.1730, 616.8921: 1.4539, 631.5685: 1.7936,
                               637.9748: 1.9645, 642.3208: 2.0652, 645.6587: 2.1518, 650.3708: 2.2037, 653.9239: 2.2088,
                               657.3580: 2.1846, 660.7541: 2.1073, 663.8581: 2.0076, 665.8864: 1.8333, 666.9994: 1.5400,
                               669.2779: 1.3424, 670.3907: 1.1097}
        green_log_sensitivity = {499.4482: 0.4829, 504.7550: 0.7421, 511.3329: 1.0295, 518.9112: 1.2843,
                                 527.6552: 1.5137, 535.4458: 1.7523, 541.6293: 1.9581, 546.9399: 2.0902,
                                 549.5936: 2.1287, 553.3743: 2.1507, 558.9657: 2.1445, 563.5359: 2.1474,
                                 567.1835: 2.1652, 570.2336: 2.1614, 572.3522: 2.1277, 575.7909: 2.0350,
                                 579.1281: 1.8818, 581.0184: 1.7121, 583.8027: 1.2770, 584.9079: 0.9977,
                                 586.4451: 0.8536}
        blue_log_sensitivity = {400.3438: 3.2775, 407.7794: 3.3041, 416.9539: 3.2495, 425.4787: 3.1459,
                                434.5310: 3.0075, 445.3000: 2.8273, 454.8668: 2.6773, 460.9072: 2.5952,
                                467.8539: 2.4672, 474.7548: 2.2399, 482.8632: 1.9733, 488.8304: 1.6597,
                                494.5763: 1.3182, 497.4332: 1.0555, 502.3873: 0.6766, 507.9507: 0.4189}
        self.log_sensitivity = [red_log_sensitivity, green_log_sensitivity, blue_log_sensitivity]

        # sensiometry - characteristic curve
        red_curve = {0.0496: 0.0772, 0.0714: 0.0759, 0.0932: 0.0771, 0.1161: 0.0798, 0.1365: 0.0816, 0.1545: 0.0839,
                     0.1799: 0.0876, 0.2085: 0.0943, 0.2366: 0.1007, 0.2802: 0.1155, 0.3043: 0.1272, 0.3191: 0.1352,
                     0.3487: 0.1503, 0.3767: 0.1695, 0.3985: 0.1824, 0.4202: 0.1944, 0.4400: 0.2077, 0.4639: 0.2261,
                     0.4867: 0.2415, 0.5168: 0.2622, 0.5421: 0.2797, 0.5562: 0.2880, 0.5848: 0.3072, 0.6123: 0.3262,
                     0.6413: 0.3467, 0.6657: 0.3624, 0.6827: 0.3740, 0.7046: 0.3858, 0.7306: 0.4028, 0.7613: 0.4221,
                     0.7838: 0.4377, 0.8006: 0.4488, 0.8214: 0.4620, 0.8468: 0.4767, 0.8686: 0.4907, 0.9008: 0.5087,
                     0.9297: 0.5261, 0.9522: 0.5385, 0.9771: 0.5492}
        green_curve = {0.0430: 0.2065, 0.1397: 0.2110, 0.1612: 0.2147, 0.1807: 0.2190, 0.2041: 0.2252, 0.2322: 0.2340,
                       0.2664: 0.2465, 0.2919: 0.2577, 0.3225: 0.2734, 0.3470: 0.2857, 0.3661: 0.2945, 0.3870: 0.3078,
                       0.4086: 0.3223, 0.4346: 0.3413, 0.4575: 0.3541, 0.4782: 0.3657, 0.4995: 0.3808, 0.5228: 0.4000,
                       0.5451: 0.4166, 0.5700: 0.4343, 0.5944: 0.4497, 0.6162: 0.4668, 0.6291: 0.4747, 0.7345: 0.5400,
                       0.7563: 0.5536, 0.7781: 0.5664, 0.7999: 0.5799, 0.8217: 0.5933, 0.8435: 0.6057, 0.8653: 0.6188,
                       0.8871: 0.6304, 0.9089: 0.6417, 0.9307: 0.6542, 0.9525: 0.6636, 0.9757: 0.6729, 0.9888: 0.6767}
        blue_curve = {0.0351: 0.3325, 0.0559: 0.3320, 0.0824: 0.3333, 0.1140: 0.3366, 0.1457: 0.3421, 0.1758: 0.3496,
                      0.2080: 0.3605, 0.2392: 0.3725, 0.2625: 0.3838, 0.2925: 0.4037, 0.3163: 0.4179, 0.3315: 0.4273,
                      0.3559: 0.4438, 0.3839: 0.4628, 0.4065: 0.4793, 0.4257: 0.4920, 0.4473: 0.5065, 0.4789: 0.5297,
                      0.4929: 0.5378, 0.5225: 0.5593, 0.5478: 0.5759, 0.5604: 0.5829, 0.5889: 0.6021, 0.6121: 0.6163,
                      0.6299: 0.6270, 0.6584: 0.6454, 0.6815: 0.6593, 0.6983: 0.6689, 0.7249: 0.6852, 0.7506: 0.7010,
                      0.7650: 0.7087, 0.7903: 0.7239, 0.8178: 0.7404, 0.8494: 0.7579, 0.8717: 0.7704, 0.8920: 0.7809,
                      0.9221: 0.7983, 0.9456: 0.8104, 0.9600: 0.8180}
        d_scale, log_H_scale, log_H_offset = 3, 3.1, 2.6
        red_log_exposure = xp.array(list(red_curve.keys()), dtype=default_dtype) * log_H_scale - log_H_offset
        red_density_curve = xp.array(list(red_curve.values()), dtype=default_dtype) * d_scale
        green_log_exposure = xp.array(list(green_curve.keys()), dtype=default_dtype) * log_H_scale - log_H_offset
        green_density_curve = xp.array(list(green_curve.values()), dtype=default_dtype) * d_scale
        blue_log_exposure = xp.array(list(blue_curve.keys()), dtype=default_dtype) * log_H_scale - log_H_offset
        blue_density_curve = xp.array(list(blue_curve.values()), dtype=default_dtype) * d_scale
        self.log_exposure = [red_log_exposure, green_log_exposure, blue_log_exposure]
        self.density_curve = [red_density_curve, green_density_curve, blue_density_curve]

        # spectral dye density
        red_sd = {399.4616: 0.6475, 411.7436: 0.5580, 425.2154: 0.4462, 441.7351: 0.3472, 463.6288: 0.2996,
                  496.9911: 0.3306, 536.9040: 0.4110, 556.3882: 0.4545, 581.1892: 0.5651, 602.7626: 0.7229,
                  623.0563: 0.9698, 637.9750: 1.1670, 653.6154: 1.3385, 667.6411: 1.4620, 679.3554: 1.5243,
                  688.0409: 1.5440, 694.1559: 1.5396, 699.4311: 1.5253}
        green_sd = {399.1273: 0.4362, 416.4663: 0.5255, 428.6542: 0.5823, 436.4000: 0.6010, 445.8159: 0.5817,
                    457.5810: 0.5649, 473.3038: 0.6084, 489.2599: 0.7278, 504.6857: 0.9406, 515.2747: 1.1441,
                    524.7254: 1.2899, 533.4517: 1.3925, 539.7233: 1.4371, 544.6986: 1.4503, 551.8167: 1.4217,
                    560.6235: 1.3258, 570.3292: 1.1482, 579.8472: 0.8971, 595.3940: 0.5563, 609.8700: 0.3453,
                    629.4331: 0.1929, 656.9941: 0.1059, 682.4027: 0.0760, 699.1432: 0.0724}
        blue_sd = {399.8744: 1.1021, 408.7407: 1.2063, 418.0719: 1.3185, 428.0202: 1.4218, 434.6593: 1.4799,
                   439.3451: 1.5046, 444.0425: 1.5114, 450.7918: 1.4712, 458.6553: 1.3801, 467.0291: 1.2265,
                   475.4224: 1.0426, 483.7914: 0.8234, 494.5603: 0.6011, 507.5204: 0.4076, 520.7768: 0.2653,
                   538.9497: 0.1545, 568.6120: 0.0900, 616.5876: 0.0620, 659.8477: 0.0554, 699.3413: 0.0567}
        self.spectral_density = [colour.SpectralDistribution(x) for x in (red_sd, green_sd, blue_sd)]

        self.mtf = [{2.5169: 1.1185, 3.5699: 1.0780, 6.3431: 1.0585, 10.1089: 1.0052, 14.5014: 0.9616, 18.7989: 0.8929,
                     22.3525: 0.8321, 26.0857: 0.7612, 31.8541: 0.6611, 38.2475: 0.5699, 45.2434: 0.4823,
                     57.4047: 0.3610, 65.7731: 0.3032, 77.9868: 0.2330}]

        # copied from kodak exr 5248
        red_rms = {0.0081: 0.0074, 0.5625: 0.0078, 1.2141: 0.0083, 1.4852: 0.0084, 1.9061: 0.0075, 2.2541: 0.0065,
                   2.7357: 0.0054, 3.1364: 0.0047, 3.6301: 0.0044, 4.0753: 0.0044, 4.5326: 0.0044, 4.9939: 0.0044}
        green_rms = {0.0121: 0.0086, 0.6151: 0.0093, 1.0643: 0.0103, 1.3395: 0.0115, 1.4852: 0.0117, 1.7159: 0.0104,
                     1.9547: 0.0083, 2.1773: 0.0068, 2.4444: 0.0061, 2.6993: 0.0061, 3.0554: 0.0065, 3.3144: 0.0063,
                     3.6463: 0.0060, 4.0550: 0.0059, 4.5245: 0.0059, 4.9980: 0.0063}
        blue_rms = {0.0202: 0.0111, 0.3399: 0.0091, 0.5868: 0.0094, 0.7770: 0.0113, 1.0279: 0.0157, 1.2546: 0.0190,
                    1.5217: 0.0201, 1.8495: 0.0180, 2.1327: 0.0153, 2.4605: 0.0134, 2.7398: 0.0130, 3.0231: 0.0129,
                    3.2821: 0.0122, 3.5208: 0.0115, 3.9417: 0.0113, 4.5892: 0.0112, 4.9960: 0.0112}
        red_rms_density = {0.0182: 0.2203, 0.4518: 0.2284, 0.7840: 0.2382, 0.9542: 0.2495, 1.1933: 0.2835,
                           1.5904: 0.3791, 2.4048: 0.6221, 3.4704: 0.9332, 4.1917: 1.1373, 5.0041: 1.3625}
        green_rms_density = {0.0122: 0.6237, 0.5166: 0.6189, 0.9988: 0.6529, 1.4972: 0.7647, 2.0199: 0.9883,
                             3.5069: 1.5326, 4.0174: 1.7173, 4.4854: 1.8566, 5.0020: 2.0608}
        blue_rms_density = {0.0162: 1.0239, 0.6179: 1.0304, 0.9947: 1.0595, 1.3169: 1.1260, 1.7545: 1.2847,
                            2.7087: 1.6671, 3.6244: 2.0381, 4.4246: 2.3248, 5.0000: 2.5095}
        self.rms_curve = [red_rms, green_rms, blue_rms]
        self.rms_density = [red_rms_density, green_rms_density, blue_rms_density]
        # guessed
        self.rms = 5.5

        self.calibrate()


if __name__ == "__main__":
    Kodak5250().plot_data(Kodak5247II())
