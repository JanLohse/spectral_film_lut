from spectral_film_lut.film_spectral import *


class Kodak5250(FilmSpectral):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)

        self.iso = 50
        self.density_measure = 'status_m'
        self.exposure_kelvin = 3200
        self.projection_kelvin = None

        # spectral sensitivity
        red_log_sensitivity = {588.5090: 0.4953, 596.9532: 0.8364, 606.4160: 1.1730, 616.8921: 1.4539, 631.5685: 1.7936,
                               637.9748: 1.9645, 642.3208: 2.0652, 645.6587: 2.1518, 650.3708: 2.2037, 653.9239: 2.2088,
                               657.3580: 2.1846, 660.7541: 2.1073, 663.8581: 2.0076, 665.8864: 1.8333, 666.9994: 1.5400,
                               669.2779: 1.3424, 670.3907: 1.1097}
        green_log_sensitivity = {499.4482: 0.4829, 504.7550: 0.7421, 511.3329: 1.0295, 518.9112: 1.2843,
                                 527.6552: 1.5137, 535.4458: 1.7523, 541.6293: 1.9581, 546.9399: 2.0902,
                                 549.5936: 2.1287, 553.3743: 2.1507, 558.9657: 2.1445, 563.5359: 2.1474,
                                 567.1835: 2.1652, 570.2336: 2.1614, 572.3522: 2.1277, 575.7909: 2.0350,
                                 579.1281: 1.8818, 581.0184: 1.7121, 583.8027: 1.2770, 584.9079: 0.9977,
                                 586.4451: 0.8536}
        blue_log_sensitivity = {400.3438: 3.2775, 407.7794: 3.3041, 416.9539: 3.2495, 425.4787: 3.1459,
                                434.5310: 3.0075, 445.3000: 2.8273, 454.8668: 2.6773, 460.9072: 2.5952,
                                467.8539: 2.4672, 474.7548: 2.2399, 482.8632: 1.9733, 488.8304: 1.6597,
                                494.5763: 1.3182, 497.4332: 1.0555, 502.3873: 0.6766, 507.9507: 0.4189}
        self.log_sensitivity = [red_log_sensitivity, green_log_sensitivity, blue_log_sensitivity]

        # sensiometry - characteristic curve
        red_curve = {0.1424: 0.2255, 0.3176: 0.2277, 0.4839: 0.2415, 0.6590: 0.2726, 0.8143: 0.3199, 1.0438: 0.4318,
                     1.2317: 0.5581, 1.4567: 0.7097, 1.6751: 0.8575, 1.9285: 1.0283, 2.2126: 1.2107, 2.4551: 1.3698,
                     2.7129: 1.5233, 2.8243: 1.5897, 2.8733: 1.6182, 2.9249: 1.6403, 2.9905: 1.6586}
        green_curve = {0.1716: 0.6171, 0.3468: 0.6128, 0.4847: 0.6330, 0.6313: 0.6715, 0.7932: 0.7208, 0.9790: 0.8121,
                       1.1254: 0.8940, 1.3045: 1.0109, 1.5536: 1.1770, 1.7851: 1.3384, 2.0450: 1.5185, 2.3466: 1.7019,
                       2.6066: 1.8577, 2.7355: 1.9302, 2.8645: 1.9939, 2.9883: 2.0357}
        blue_curve = {0.1002: 0.9904, 0.2995: 0.9954, 0.4614: 1.0213, 0.6211: 1.0682, 0.7938: 1.1455, 1.0057: 1.2854,
                      1.3094: 1.4963, 1.5912: 1.6839, 1.8712: 1.8678, 2.2510: 2.0966, 2.5307: 2.2613, 2.7602: 2.3877,
                      2.8869: 2.4555}
        red_log_exposure = xp.array(list(red_curve.keys()), dtype=default_dtype) - 2.75
        red_density_curve = xp.array(list(red_curve.values()), dtype=default_dtype) * 0.91
        green_log_exposure = xp.array(list(green_curve.keys()), dtype=default_dtype) - 2.75
        green_density_curve = xp.array(list(green_curve.values()), dtype=default_dtype) * 0.91
        blue_log_exposure = xp.array(list(blue_curve.keys()), dtype=default_dtype) - 2.75
        blue_density_curve = xp.array(list(blue_curve.values()), dtype=default_dtype) * 0.91
        self.log_exposure = [red_log_exposure, green_log_exposure, blue_log_exposure]
        self.density_curve = [red_density_curve, green_density_curve, blue_density_curve]

        self.exposure_base = 10

        # spectral dye density
        red_sd = {399.4616: 0.6475, 411.7436: 0.5580, 425.2154: 0.4462, 441.7351: 0.3472, 463.6288: 0.2996,
                  496.9911: 0.3306, 536.9040: 0.4110, 556.3882: 0.4545, 581.1892: 0.5651, 602.7626: 0.7229,
                  623.0563: 0.9698, 637.9750: 1.1670, 653.6154: 1.3385, 667.6411: 1.4620, 679.3554: 1.5243,
                  688.0409: 1.5440, 694.1559: 1.5396, 699.4311: 1.5253}
        green_sd = {399.1273: 0.4362, 416.4663: 0.5255, 428.6542: 0.5823, 436.4000: 0.6010, 445.8159: 0.5817,
                    457.5810: 0.5649, 473.3038: 0.6084, 489.2599: 0.7278, 504.6857: 0.9406, 515.2747: 1.1441,
                    524.7254: 1.2899, 533.4517: 1.3925, 539.7233: 1.4371, 544.6986: 1.4503, 551.8167: 1.4217,
                    560.6235: 1.3258, 570.3292: 1.1482, 579.8472: 0.8971, 595.3940: 0.5563, 609.8700: 0.3453,
                    629.4331: 0.1929, 656.9941: 0.1059, 682.4027: 0.0760, 699.1432: 0.0724}
        blue_sd = {399.8744: 1.1021, 408.7407: 1.2063, 418.0719: 1.3185, 428.0202: 1.4218, 434.6593: 1.4799,
                   439.3451: 1.5046, 444.0425: 1.5114, 450.7918: 1.4712, 458.6553: 1.3801, 467.0291: 1.2265,
                   475.4224: 1.0426, 483.7914: 0.8234, 494.5603: 0.6011, 507.5204: 0.4076, 520.7768: 0.2653,
                   538.9497: 0.1545, 568.6120: 0.0900, 616.5876: 0.0620, 659.8477: 0.0554, 699.3413: 0.0567}
        self.spectral_density = [colour.SpectralDistribution(x) for x in (red_sd, green_sd, blue_sd)]

        self.mtf = [{2.5169: 1.1185, 3.5699: 1.0780, 6.3431: 1.0585, 10.1089: 1.0052, 14.5014: 0.9616, 18.7989: 0.8929,
                     22.3525: 0.8321, 26.0857: 0.7612, 31.8541: 0.6611, 38.2475: 0.5699, 45.2434: 0.4823,
                     57.4047: 0.3610, 65.7731: 0.3032, 77.9868: 0.2330}]

        # copied from kodak exr 5248
        red_rms = {0.0081: 0.0074, 0.5625: 0.0078, 1.2141: 0.0083, 1.4852: 0.0084, 1.9061: 0.0075, 2.2541: 0.0065,
                   2.7357: 0.0054, 3.1364: 0.0047, 3.6301: 0.0044, 4.0753: 0.0044, 4.5326: 0.0044, 4.9939: 0.0044}
        green_rms = {0.0121: 0.0086, 0.6151: 0.0093, 1.0643: 0.0103, 1.3395: 0.0115, 1.4852: 0.0117, 1.7159: 0.0104,
                     1.9547: 0.0083, 2.1773: 0.0068, 2.4444: 0.0061, 2.6993: 0.0061, 3.0554: 0.0065, 3.3144: 0.0063,
                     3.6463: 0.0060, 4.0550: 0.0059, 4.5245: 0.0059, 4.9980: 0.0063}
        blue_rms = {0.0202: 0.0111, 0.3399: 0.0091, 0.5868: 0.0094, 0.7770: 0.0113, 1.0279: 0.0157, 1.2546: 0.0190,
                    1.5217: 0.0201, 1.8495: 0.0180, 2.1327: 0.0153, 2.4605: 0.0134, 2.7398: 0.0130, 3.0231: 0.0129,
                    3.2821: 0.0122, 3.5208: 0.0115, 3.9417: 0.0113, 4.5892: 0.0112, 4.9960: 0.0112}
        red_rms_density = {0.0182: 0.2203, 0.4518: 0.2284, 0.7840: 0.2382, 0.9542: 0.2495, 1.1933: 0.2835,
                           1.5904: 0.3791, 2.4048: 0.6221, 3.4704: 0.9332, 4.1917: 1.1373, 5.0041: 1.3625}
        green_rms_density = {0.0122: 0.6237, 0.5166: 0.6189, 0.9988: 0.6529, 1.4972: 0.7647, 2.0199: 0.9883,
                             3.5069: 1.5326, 4.0174: 1.7173, 4.4854: 1.8566, 5.0020: 2.0608}
        blue_rms_density = {0.0162: 1.0239, 0.6179: 1.0304, 0.9947: 1.0595, 1.3169: 1.1260, 1.7545: 1.2847,
                            2.7087: 1.6671, 3.6244: 2.0381, 4.4246: 2.3248, 5.0000: 2.5095}
        self.rms_curve = [red_rms, green_rms, blue_rms]
        self.rms_density = [red_rms_density, green_rms_density, blue_rms_density]
        # guessed
        self.rms = 5.5

        self.calibrate()
