from spectral_film_lut.film_spectral import *
from spectral_film_lut.negative_film.kodak_5247_II import *


class Kodak5248(FilmSpectral):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)

        self.iso = 25
        self.density_measure = 'status_m'
        self.exposure_kelvin = 3200
        self.year = 1952
        self.manufacturer = 'Kodak'
        self.stage = 'camera'
        self.type = 'negative'
        self.medium = 'cine'
        self.alias = 'Eastman Color Negative 5248'
        self.comment = 'Unreliable data.'

        # spectral sensitivity
        red_log_sensitivity = {585.2083: 0.6438, 598.0150: 1.0564, 614.1450: 1.5816, 620.1764: 1.7566, 625.6690: 1.8659,
                               632.3663: 1.9409, 638.3092: 1.9720, 642.4869: 2.0107, 645.7696: 2.0750, 647.9819: 2.1158,
                               651.9298: 2.1415, 656.1539: 2.0974, 664.1854: 1.8470, 670.0089: 1.6084}
        green_log_sensitivity = {493.7973: 1.3787, 502.0131: 1.5838, 508.8382: 1.7929, 514.1517: 1.9799,
                                 518.6949: 2.0914, 524.0412: 2.1597, 530.3220: 2.1922, 539.9681: 2.2024,
                                 546.2446: 2.1823, 550.8762: 2.1364, 558.2054: 1.9907, 567.3362: 1.7125,
                                 576.0673: 1.3621, 582.6091: 0.9904, 586.6851: 0.7279, 589.4758: 0.4623}
        blue_log_sensitivity = {400.6963: 2.9515, 404.1591: 3.1174, 408.6587: 3.2461, 414.5456: 3.3167,
                                420.8155: 3.3083, 427.6576: 3.1858, 432.1265: 3.0677, 437.6149: 3.0037,
                                443.0099: 2.9853, 450.7815: 3.0167, 457.7157: 3.0316, 463.5052: 2.9742,
                                467.6693: 2.8560, 472.1829: 2.5982, 477.6267: 2.2520, 483.3543: 1.9431,
                                491.9172: 1.6508, 500.2742: 1.4238, 505.2799: 1.2545, 508.2920: 1.0169}
        self.log_sensitivity = [red_log_sensitivity, green_log_sensitivity, blue_log_sensitivity]

        # sensiometry - characteristic curve
        red_curve = {0.0475: 0.0687, 0.0693: 0.0687, 0.0911: 0.0669, 0.1130: 0.0686, 0.1348: 0.0694, 0.1566: 0.0710,
                     0.1784: 0.0743, 0.2002: 0.0791, 0.2220: 0.0848, 0.2438: 0.0912, 0.2656: 0.0984, 0.2875: 0.1079,
                     0.3093: 0.1176, 0.3310: 0.1298, 0.3529: 0.1400, 0.3746: 0.1527, 0.3964: 0.1667, 0.4182: 0.1808,
                     0.4400: 0.1982, 0.4618: 0.2119, 0.4836: 0.2259, 0.5045: 0.2402, 0.5272: 0.2561, 0.5490: 0.2708,
                     0.5708: 0.2851, 0.5926: 0.2982, 0.6144: 0.3142, 0.6362: 0.3300, 0.6580: 0.3434, 0.6798: 0.3565,
                     0.7015: 0.3703, 0.7233: 0.3847, 0.7451: 0.3992, 0.7669: 0.4134, 0.7881: 0.4264, 0.8101: 0.4391,
                     0.8323: 0.4525, 0.8541: 0.4661, 0.8762: 0.4792, 0.8977: 0.4909, 0.9195: 0.5030, 0.9413: 0.5133,
                     0.9631: 0.5206, 0.9849: 0.5287, }
        green_curve = {0.0519: 0.2064, 0.0836: 0.2036, 0.1054: 0.2027, 0.1273: 0.2038, 0.1491: 0.2058, 0.1709: 0.2088,
                       0.1933: 0.2133, 0.2145: 0.2182, 0.2363: 0.2243, 0.2581: 0.2316, 0.2799: 0.2407, 0.3017: 0.2508,
                       0.3235: 0.2625, 0.3453: 0.2750, 0.3671: 0.2881, 0.3889: 0.3008, 0.4107: 0.3147, 0.4325: 0.3304,
                       0.4543: 0.3440, 0.4761: 0.3575, 0.4979: 0.3709, 0.5197: 0.3863, 0.5415: 0.4025, 0.5633: 0.4185,
                       0.5851: 0.4347, 0.6069: 0.4493, 0.6286: 0.4649, 0.6504: 0.4811, 0.6645: 0.4925, 0.6961: 0.5116,
                       0.7184: 0.5287, 0.7397: 0.5446, 0.7615: 0.5580, 0.7833: 0.5700, 0.8051: 0.5829, 0.8269: 0.5967,
                       0.8487: 0.6104, 0.8704: 0.6245, 0.8922: 0.6362, 0.9140: 0.6484, 0.9358: 0.6593, 0.9576: 0.6721,
                       0.9794: 0.6847, 0.9914: 0.6888, }
        blue_curve = {0.0355: 0.3669, 0.0574: 0.3690, 0.0792: 0.3729, 0.1010: 0.3773, 0.1222: 0.3830, 0.1441: 0.3909,
                      0.1685: 0.4012, 0.1903: 0.4107, 0.2121: 0.4215, 0.2339: 0.4334, 0.2557: 0.4461, 0.2775: 0.4625,
                      0.2992: 0.4785, 0.3210: 0.4946, 0.3428: 0.5111, 0.3646: 0.5295, 0.3864: 0.5471, 0.4082: 0.5650,
                      0.4300: 0.5822, 0.4518: 0.5995, 0.4733: 0.6164, 0.4955: 0.6322, 0.5171: 0.6467, 0.5374: 0.6594,
                      0.5628: 0.6762, 0.5846: 0.6893, 0.6064: 0.7023, 0.6282: 0.7151, 0.6500: 0.7294, 0.6718: 0.7445,
                      0.6936: 0.7598, 0.7154: 0.7748, 0.7371: 0.7895, 0.7589: 0.8054, 0.7807: 0.8216, 0.8025: 0.8386,
                      0.8243: 0.8551, 0.8461: 0.8712, 0.8678: 0.8887, 0.8897: 0.9055, 0.9115: 0.9237, 0.9312: 0.9380, }
        d_scale, log_H_scale, log_H_offset = 3, 3.1, 2.25
        red_log_exposure = xp.array(list(red_curve.keys()), dtype=default_dtype) * log_H_scale - log_H_offset
        red_density_curve = xp.array(list(red_curve.values()), dtype=default_dtype) * d_scale
        green_log_exposure = xp.array(list(green_curve.keys()), dtype=default_dtype) * log_H_scale - log_H_offset
        green_density_curve = xp.array(list(green_curve.values()), dtype=default_dtype) * d_scale
        blue_log_exposure = xp.array(list(blue_curve.keys()), dtype=default_dtype) * log_H_scale - log_H_offset
        blue_density_curve = xp.array(list(blue_curve.values()), dtype=default_dtype) * d_scale
        self.log_exposure = [red_log_exposure, green_log_exposure, blue_log_exposure]
        self.density_curve = [red_density_curve, green_density_curve, blue_density_curve]

        # spectral dye density
        red_sd = {399.4070: 0.7323, 411.7892: 0.6333, 426.5796: 0.5183, 448.7547: 0.3986, 469.7070: 0.3525,
                  511.7797: 0.3644, 549.1127: 0.4355, 575.1442: 0.5336, 605.3495: 0.7214, 623.8621: 0.8866,
                  640.7586: 1.0790, 661.3007: 1.3050, 677.2919: 1.4430, 689.4718: 1.5123, 699.2789: 1.5426}
        green_sd = {399.1273: 0.4362, 416.4663: 0.5255, 428.6542: 0.5823, 436.4000: 0.6010, 445.8159: 0.5817,
                    457.5810: 0.5649, 473.3038: 0.6084, 489.2599: 0.7278, 504.6857: 0.9406, 515.2747: 1.1441,
                    524.7254: 1.2899, 533.4517: 1.3925, 539.7233: 1.4371, 544.6986: 1.4503, 551.8167: 1.4217,
                    560.6235: 1.3258, 570.3292: 1.1482, 579.8472: 0.8971, 595.3940: 0.5563, 609.8700: 0.3453,
                    629.4331: 0.1929, 656.9941: 0.1059, 682.4027: 0.0760, 699.1432: 0.0724}
        blue_sd = {400.2438: 0.8934, 411.4059: 1.0831, 420.4386: 1.2209, 429.9414: 1.3588, 436.9823: 1.4501,
                   441.2412: 1.4806, 446.6337: 1.5031, 452.5139: 1.4984, 456.8631: 1.4617, 465.7438: 1.3241,
                   479.2939: 1.0907, 491.1994: 0.8555, 505.9579: 0.5708, 520.9418: 0.3742, 535.2278: 0.2393,
                   558.0085: 0.1283, 583.6656: 0.0775, 623.6417: 0.0596, 659.8479: 0.0551, 699.3432: 0.0538}
        self.spectral_density = [colour.SpectralDistribution(x) for x in (red_sd, green_sd, blue_sd)]

        self.mtf = [{2.5169: 1.1185, 3.5699: 1.0780, 6.3431: 1.0585, 10.1089: 1.0052, 14.5014: 0.9616, 18.7989: 0.8929,
                     22.3525: 0.8321, 26.0857: 0.7612, 31.8541: 0.6611, 38.2475: 0.5699, 45.2434: 0.4823,
                     57.4047: 0.3610, 65.7731: 0.3032, 77.9868: 0.2330}]

        # copied from kodak exr 5248
        red_rms = {0.0081: 0.0074, 0.5625: 0.0078, 1.2141: 0.0083, 1.4852: 0.0084, 1.9061: 0.0075, 2.2541: 0.0065,
                   2.7357: 0.0054, 3.1364: 0.0047, 3.6301: 0.0044, 4.0753: 0.0044, 4.5326: 0.0044, 4.9939: 0.0044}
        green_rms = {0.0121: 0.0086, 0.6151: 0.0093, 1.0643: 0.0103, 1.3395: 0.0115, 1.4852: 0.0117, 1.7159: 0.0104,
                     1.9547: 0.0083, 2.1773: 0.0068, 2.4444: 0.0061, 2.6993: 0.0061, 3.0554: 0.0065, 3.3144: 0.0063,
                     3.6463: 0.0060, 4.0550: 0.0059, 4.5245: 0.0059, 4.9980: 0.0063}
        blue_rms = {0.0202: 0.0111, 0.3399: 0.0091, 0.5868: 0.0094, 0.7770: 0.0113, 1.0279: 0.0157, 1.2546: 0.0190,
                    1.5217: 0.0201, 1.8495: 0.0180, 2.1327: 0.0153, 2.4605: 0.0134, 2.7398: 0.0130, 3.0231: 0.0129,
                    3.2821: 0.0122, 3.5208: 0.0115, 3.9417: 0.0113, 4.5892: 0.0112, 4.9960: 0.0112}
        red_rms_density = {0.0182: 0.2203, 0.4518: 0.2284, 0.7840: 0.2382, 0.9542: 0.2495, 1.1933: 0.2835,
                           1.5904: 0.3791, 2.4048: 0.6221, 3.4704: 0.9332, 4.1917: 1.1373, 5.0041: 1.3625}
        green_rms_density = {0.0122: 0.6237, 0.5166: 0.6189, 0.9988: 0.6529, 1.4972: 0.7647, 2.0199: 0.9883,
                             3.5069: 1.5326, 4.0174: 1.7173, 4.4854: 1.8566, 5.0020: 2.0608}
        blue_rms_density = {0.0162: 1.0239, 0.6179: 1.0304, 0.9947: 1.0595, 1.3169: 1.1260, 1.7545: 1.2847,
                            2.7087: 1.6671, 3.6244: 2.0381, 4.4246: 2.3248, 5.0000: 2.5095}
        self.rms_curve = [red_rms, green_rms, blue_rms]
        self.rms_density = [red_rms_density, green_rms_density, blue_rms_density]
        # guessed
        self.rms = 5

        self.calibrate()

if __name__ == "__main__":
    Kodak5248().plot_data(Kodak5247II())
