from spectral_film_lut.film_spectral import *


class FujiSuperiaReala(FilmSpectral):
    def __init__(self):
        super().__init__()

        self.iso = 100
        self.density_measure = 'status_m'

        # spectral sensitivity
        red_log_sensitivity = {557.7054: 1.0543, 560.7612: 1.1395, 563.5820: 1.2203, 566.4028: 1.3003, 569.2236: 1.3799,
                               572.0444: 1.4591, 574.1600: 1.5099, 579.8604: 1.6827, 583.5627: 1.7667, 586.8536: 1.8502,
                               590.1445: 1.9252, 596.7264: 2.0748, 609.8901: 2.2588, 617.1772: 2.3195, 624.6993: 2.3560,
                               632.2215: 2.3596, 639.2735: 2.3104, 644.4449: 2.2348, 647.9709: 2.1579, 651.0268: 2.0782,
                               654.5528: 1.9259, 656.6214: 1.8266, 657.8437: 1.7444, 659.0661: 1.6578, 660.4294: 1.5659,
                               662.0077: 1.4675, 663.4853: 1.3767, 665.0132: 1.3062, 667.0113: 1.2240,
                               669.3620: 1.1379, }
        green_log_sensitivity = {465.3242: 0.7422, 467.6749: 0.8273, 469.7905: 0.9134, 471.6710: 0.9897,
                                 473.5515: 1.0647, 475.6671: 1.1448, 477.7827: 1.2274, 480.1334: 1.3168,
                                 482.4841: 1.4052, 484.8347: 1.4923, 487.1854: 1.5793, 489.5361: 1.6634,
                                 492.1218: 1.7511, 496.8231: 1.9190, 499.1738: 1.9931, 505.0505: 2.1586,
                                 508.5765: 2.2416, 513.5129: 2.3197, 520.3298: 2.3786, 527.8519: 2.4048,
                                 535.3740: 2.3927, 542.8962: 2.3460, 549.7131: 2.2795, 555.3547: 2.2067,
                                 560.0560: 2.1315, 564.2872: 2.0530, 568.0483: 1.9573, 570.8691: 1.8786,
                                 572.9847: 1.8015, 574.8652: 1.7235, 576.2756: 1.6727, 579.8016: 1.4927,
                                 581.9172: 1.3948, 583.7978: 1.3026, 585.6783: 1.2110, 587.7939: 1.1262,
                                 589.9095: 1.0750, }
        blue_log_sensitivity = {390.5731: 2.2987, 394.5692: 2.3832, 398.5653: 2.4476, 406.0875: 2.5316,
                                413.6096: 2.5746, 421.1317: 2.5737, 428.6538: 2.5554, 436.1760: 2.5495,
                                443.6981: 2.5688, 451.2202: 2.6158, 458.7424: 2.6494, 466.2645: 2.6566,
                                473.5515: 2.6178, 478.7230: 2.5369, 481.5438: 2.4584, 483.6594: 2.3803,
                                485.5399: 2.2951, 487.4205: 2.2011, 489.1835: 2.0995, 490.2413: 2.0498,
                                492.5919: 1.9375, 496.8231: 1.7322, 498.7037: 1.6821, 505.2855: 1.4201,
                                507.8713: 1.3371, 510.2219: 1.2553, 512.5726: 1.1730, 514.9233: 1.0988, }
        self.log_sensitivity = [red_log_sensitivity, green_log_sensitivity, blue_log_sensitivity]

        # sensiometry - characteristic curve
        red_curve = {-3.5811: 0.2932, -3.4619: 0.2932, -3.3375: 0.3057, -3.2157: 0.3128, -3.0939: 0.3210,
                     -2.9721: 0.3324, -2.8503: 0.3457, -2.7285: 0.3637, -2.6067: 0.3831, -2.4852: 0.4002,
                     -2.3631: 0.4233, -2.2413: 0.4508, -1.9979: 0.5226, -1.8759: 0.5771, -1.7541: 0.6450,
                     -1.6323: 0.7161, -1.5097: 0.7881, -1.3887: 0.8719, -1.1451: 1.0305, -0.9015: 1.1978,
                     -0.7797: 1.2804, -0.6579: 1.3620, -0.5338: 1.4404, -0.4143: 1.5216, -0.2925: 1.5994,
                     -0.1707: 1.6858, -0.0465: 1.7653, 0.0729: 1.8434, 0.3165: 2.0000, }
        green_curve = {-3.5695: 0.5039, -3.4477: 0.5076, -3.3259: 0.5128, -3.2041: 0.5221, -2.9605: 0.5548,
                       -2.8387: 0.5813, -2.7169: 0.6081, -2.5951: 0.6344, -2.4733: 0.6632, -2.3515: 0.6971,
                       -2.2297: 0.7403, -2.1079: 0.7928, -1.9861: 0.8560, -1.8643: 0.9166, -1.7425: 0.9911,
                       -1.6207: 1.0642, -1.4989: 1.1474, -1.3771: 1.2288, -1.2553: 1.3095, -1.1335: 1.3906,
                       -1.0117: 1.4712, -0.8899: 1.5505, -0.7681: 1.6356, -0.6463: 1.7152, -0.5232: 1.7916,
                       -0.4027: 1.8710, -0.2809: 1.9566, -0.1591: 2.0285, -0.0373: 2.1122, 0.0845: 2.1930,
                       0.2063: 2.2745, 0.2875: 2.3267, }
        blue_curve = {-3.5811: 0.9752, -3.4593: 0.9749, -3.3375: 0.9752, -3.2157: 0.9790, -3.0939: 0.9812,
                      -2.9721: 0.9851, -2.8503: 0.9920, -2.7285: 1.0041, -2.6067: 1.0171, -2.4849: 1.0403,
                      -2.3631: 1.0765, -2.2413: 1.1274, -2.1195: 1.1819, -1.9977: 1.2369, -1.8759: 1.2975,
                      -1.7541: 1.3623, -1.6323: 1.4343, -1.5105: 1.5087, -1.3887: 1.5878, -1.2669: 1.6700,
                      -1.1451: 1.7504, -1.0215: 1.8307, -0.9015: 1.9130, -0.7797: 1.9915, -0.6579: 2.0704,
                      -0.5338: 2.1525, -0.4143: 2.2394, -0.2925: 2.3239, -0.1707: 2.4125, -0.0489: 2.4946,
                      0.0729: 2.5768, 0.1947: 2.6601, 0.2759: 2.7147, }
        red_log_exposure = xp.array(list(red_curve.keys()), dtype=default_dtype)
        red_density_curve = xp.array(list(red_curve.values()), dtype=default_dtype)
        green_log_exposure = xp.array(list(green_curve.keys()), dtype=default_dtype)
        green_density_curve = xp.array(list(green_curve.values()), dtype=default_dtype)
        blue_log_exposure = xp.array(list(blue_curve.keys()), dtype=default_dtype)
        blue_density_curve = xp.array(list(blue_curve.values()), dtype=default_dtype)
        self.log_exposure = [red_log_exposure, green_log_exposure, blue_log_exposure]
        self.density_curve = [red_density_curve, green_density_curve, blue_density_curve]

        # spectral dye density
        midscale_sd = {406.1411: 1.5194, 412.1457: 1.5605, 415.3417: 1.6061, 418.2472: 1.6551, 420.8621: 1.7088,
                       423.1865: 1.7627, 425.5108: 1.8136, 428.1257: 1.8624, 431.6123: 1.9127, 437.1327: 1.9636,
                       445.2679: 1.9957, 454.5654: 1.9947, 462.4101: 1.9551, 467.9305: 1.9078, 472.2886: 1.8598,
                       476.0657: 1.8135, 479.5523: 1.7655, 482.7483: 1.7166, 485.9443: 1.6693, 489.4308: 1.6164,
                       492.9174: 1.5711, 496.4039: 1.5271, 508.6068: 1.4621, 515.5799: 1.4746, 524.5868: 1.5390,
                       531.2693: 1.5880, 539.4046: 1.6292, 548.7021: 1.6496, 557.9995: 1.6460, 566.7159: 1.6130,
                       573.1079: 1.5622, 576.8850: 1.5181, 579.7904: 1.4635, 582.4053: 1.4098, 584.3229: 1.3521,
                       585.8919: 1.2960, 587.5770: 1.2402, 588.7973: 1.1813, 589.9595: 1.1229, 590.5406: 1.0757,
                       591.9933: 1.0281, 593.9026: 0.9623, 597.2231: 0.9147, 609.1355: 0.8762, 618.1424: 0.9048,
                       625.9871: 0.9534, 632.8357: 1.0036, 639.0617: 1.0501, 645.7442: 1.0982, 652.4268: 1.1444,
                       659.1093: 1.1920, 666.0824: 1.2405, 673.6366: 1.2877, 682.3529: 1.3308, 691.6504: 1.3581,
                       701.3214: 1.3605, 710.2453: 1.3359, 717.7995: 1.2886, 722.1577: 1.2482, }
        minimum_sd = {404.3010: 0.8354, 412.1457: 0.8040, 421.4432: 0.8225, 430.7407: 0.8712, 440.0381: 0.9028,
                      449.3356: 0.9082, 458.6330: 0.8918, 467.9305: 0.8662, 477.2279: 0.8356, 486.5254: 0.8021,
                      494.0795: 0.7742, 508.6068: 0.7190, 517.9043: 0.6895, 527.2017: 0.6634, 536.4992: 0.6380,
                      545.7966: 0.6142, 555.0941: 0.5927, 564.3915: 0.5790, 573.6890: 0.5627, 580.9526: 0.5315,
                      589.6690: 0.4697, 595.1893: 0.4329, 610.2977: 0.3385, 619.5951: 0.2988, 628.8926: 0.2765,
                      638.1900: 0.2708, 647.4875: 0.2773, 656.7849: 0.2844, 666.0824: 0.2949, 675.3799: 0.3082,
                      684.6773: 0.3172, 692.8126: 0.3203, 708.5020: 0.3180, 713.7318: 0.3145, }
        self.d_ref_sd = colour.SpectralDistribution(midscale_sd)
        self.d_min_sd = colour.SpectralDistribution(minimum_sd)

        self.mtf = [{2.8607: 1.1865, 3.3526: 1.1910, 3.9289: 1.1880, 4.4505: 1.1850, 5.3960: 1.1737, 6.3238: 1.1654,
                     7.4110: 1.1592, 8.6851: 1.1504, 10.4116: 1.1359, 11.9282: 1.1191, 13.9790: 1.0959, 16.1366: 1.0727,
                     24.6346: 0.9408, 28.8699: 0.8660, 33.8334: 0.7794, 39.8303: 0.6879, 45.5977: 0.6138,
                     55.0925: 0.5108, 63.0992: 0.4341, 70.4040: 0.3732, 77.0848: 0.3223, 84.7189: 0.2732,
                     92.4084: 0.2307, 106.2696: 0.1572, 109.9444: 0.1452, }]

        # copied from kodak 5207
        red_rms = {0.0161: 0.0049, 0.1713: 0.0050, 0.3747: 0.0051, 0.5514: 0.0050, 0.7388: 0.0054, 0.9261: 0.0055,
                   1.0546: 0.0062, 1.1563: 0.0074, 1.2580: 0.0085, 1.3651: 0.0096, 1.4775: 0.0100, 1.5685: 0.0099,
                   1.7238: 0.0088, 1.8308: 0.0084, 1.9165: 0.0082, 2.0664: 0.0077, 2.2698: 0.0070, 2.3769: 0.0066,
                   2.5589: 0.0061, 2.9443: 0.0056, 3.3191: 0.0053, 3.4850: 0.0054, 3.6724: 0.0050, 3.8330: 0.0048,
                   4.0739: 0.0046, 4.2666: 0.0045, 4.4968: 0.0046, 4.6306: 0.0043, 4.8233: 0.0042, 5.0000: 0.0043}
        green_rms = {0.0000: 0.0051, 0.1392: 0.0056, 0.2730: 0.0059, 0.4711: 0.0057, 0.7334: 0.0055, 0.9315: 0.0063,
                     1.1510: 0.0079, 1.2794: 0.0089, 1.4186: 0.0103, 1.5418: 0.0107, 1.6435: 0.0103, 1.8201: 0.0092,
                     1.9486: 0.0080, 2.1734: 0.0074, 2.3448: 0.0068, 2.5321: 0.0062, 2.7730: 0.0063, 3.0835: 0.0065,
                     3.3779: 0.0069, 3.5278: 0.0071, 3.7420: 0.0066, 4.0739: 0.0061, 4.3148: 0.0058, 4.5343: 0.0053,
                     4.7430: 0.0051, 5.0054: 0.0046}
        blue_rms = {0.0000: 0.0112, 0.0857: 0.0114, 0.1606: 0.0123, 0.2409: 0.0126, 0.3158: 0.0123, 0.3961: 0.0118,
                    0.5139: 0.0115, 0.6531: 0.0116, 0.8030: 0.0125, 0.9315: 0.0140, 1.0493: 0.0154, 1.1938: 0.0165,
                    1.3169: 0.0164, 1.4507: 0.0156, 1.5578: 0.0155, 1.6863: 0.0157, 1.7934: 0.0153, 1.9245: 0.0140,
                    2.0610: 0.0129, 2.2645: 0.0124, 2.4732: 0.0127, 2.6552: 0.0128, 2.8747: 0.0135, 3.0246: 0.0138,
                    3.2976: 0.0133, 3.6403: 0.0121, 4.1649: 0.0101, 4.4700: 0.0088, 4.8073: 0.0069, 5.0054: 0.0060}
        red_rms_density = {0.0000: 0.2286, 0.7369: 0.2286, 1.0380: 0.2429, 1.2520: 0.2714, 1.4659: 0.3429,
                           1.7829: 0.4976, 3.7837: 1.5857, 4.0967: 1.7381, 4.4176: 1.8762, 4.7385: 1.9714,
                           5.0000: 2.0238}
        green_rms_density = {0.0079: 0.5952, 0.5784: 0.5952, 0.9509: 0.6048, 1.1648: 0.6333, 1.3312: 0.6714,
                             1.5610: 0.7762, 1.9810: 1.0524, 2.9160: 1.6429, 3.8629: 2.2500, 4.1125: 2.4000,
                             4.3502: 2.5190, 4.5761: 2.6071, 4.7425: 2.6524, 4.8732: 2.6810, 4.9960: 2.7000}
        blue_rms_density = {0.0000: 1.0071, 0.6418: 1.0119, 0.9350: 1.0310, 1.1648: 1.0810, 1.4342: 1.1762,
                            1.7868: 1.3452, 2.2464: 1.6452, 2.9279: 2.0452, 3.8788: 2.6119, 4.2353: 2.7881,
                            4.5840: 2.9190, 4.8732: 2.9929}
        self.rms_curve = [red_rms, green_rms, blue_rms]
        self.rms_density = [red_rms_density, green_rms_density, blue_rms_density]
        self.rms = 4

        self.calibrate()
