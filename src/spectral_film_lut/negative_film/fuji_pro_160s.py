from spectral_film_lut.film_spectral import *


class FujiPro160S(FilmSpectral):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)

        self.iso = 160
        self.density_measure = 'status_m'
        self.year = 2004
        self.manufacturer = 'Fujifilm'
        self.stage = 'camera'
        self.type = 'negative'
        self.medium = 'photo'

        # spectral sensitivity
        red_log_sensitivity = {557.4204: -0.5748, 568.4759: -0.0745, 578.0893: 0.3580, 586.8616: 0.6853,
                               593.7112: 0.8565, 599.5394: 0.9634, 604.2259: 1.0216, 607.8310: 1.0559, 614.1398: 1.0781,
                               619.3070: 1.0871, 623.7533: 1.0907, 629.1608: 1.0667, 634.2079: 1.0018, 637.9932: 0.9345,
                               641.7785: 0.8294, 645.9844: 0.6462, 651.3919: 0.3940, 657.3403: 0.0937,
                               661.4861: -0.1015, 665.2113: -0.2517, 670.0781: -0.4048, 675.0651: -0.5225,
                               679.9319: -0.6378}
        green_log_sensitivity = {479.9119: -0.7159, 488.3837: -0.2517, 494.8127: 0.0877, 504.6064: 0.4601,
                                 508.9926: 0.5742, 515.3014: 0.6793, 521.2497: 0.7544, 532.1851: 0.9459,
                                 540.5968: 1.0961, 545.7641: 1.1748, 549.1889: 1.2174, 554.6565: 1.2420,
                                 560.9053: 1.2132, 567.0338: 1.1027, 570.8792: 0.9826, 575.3255: 0.7544,
                                 581.0334: 0.2739, 585.2994: -0.1586, 590.2263: -0.7135}
        blue_log_sensitivity = {381.9147: -0.3988, 392.4294: 0.1898, 397.7769: 0.4871, 404.1458: 0.7003,
                                408.5319: 0.7928, 414.6605: 0.8456, 423.6731: 0.8637, 435.0891: 0.8691,
                                445.9043: 0.8973, 454.1959: 0.9429, 460.6850: 1.0408, 465.2514: 1.1327,
                                468.0753: 1.1838, 470.1182: 1.2198, 471.7404: 1.2288, 473.6631: 1.2030,
                                475.9463: 1.1628, 478.3497: 1.0667, 482.1951: 0.8505, 485.4997: 0.5321,
                                489.2850: 0.2078, 495.1732: -0.1586, 499.6195: -0.4108, 504.7867: -0.6541,
                                510.4346: -0.8787}
        self.log_sensitivity = [red_log_sensitivity, green_log_sensitivity, blue_log_sensitivity]

        # sensiometry - characteristic curve
        red_curve = {-3.5964: 0.2011, -3.2872: 0.2027, -2.9618: 0.2165, -2.6119: 0.2335, -2.4378: 0.2554,
                     -2.3434: 0.2806, -2.2417: 0.3162, -1.9040: 0.4687, -1.3548: 0.7565, -0.6347: 1.1579,
                     -0.2262: 1.3833, 0.0814: 1.5512, 0.3068: 1.6647, 0.4858: 1.7353}
        green_curve = {-3.6005: 0.7484, -3.1408: 0.7484, -2.8015: 0.7606, -2.5712: 0.7776, -2.4703: 0.7938,
                       -2.3271: 0.8441, -1.8877: 1.0493, -1.3059: 1.3614, -0.8462: 1.6128, -0.4076: 1.8463,
                       -0.0570: 2.0296, 0.2075: 2.1520, 0.3743: 2.2177, 0.4866: 2.2599}
        blue_curve = {-3.5964: 0.9966, -3.2059: 0.9957, -2.9292: 0.9982, -2.6973: 1.0209, -2.5346: 1.0428,
                      -2.3710: 1.0801, -2.2254: 1.1352, -1.9976: 1.2414, -1.5753: 1.4669, -1.0496: 1.7596,
                      -0.6819: 1.9615, -0.3222: 2.1601, -0.0846: 2.2842, 0.0936: 2.3685, 0.2360: 2.4358, 0.3580: 2.4853,
                      0.4833: 2.5299}
        red_log_exposure = xp.array(list(red_curve.keys()), dtype=default_dtype)
        red_density_curve = xp.array(list(red_curve.values()), dtype=default_dtype)
        green_log_exposure = xp.array(list(green_curve.keys()), dtype=default_dtype)
        green_density_curve = xp.array(list(green_curve.values()), dtype=default_dtype)
        blue_log_exposure = xp.array(list(blue_curve.keys()), dtype=default_dtype)
        blue_density_curve = xp.array(list(blue_curve.values()), dtype=default_dtype)
        self.log_exposure = [red_log_exposure, green_log_exposure, blue_log_exposure]
        self.density_curve = [red_density_curve, green_density_curve, blue_density_curve]

        # spectral dye density
        midscale_sd = {400.3675: 1.8231, 402.3622: 1.8131, 405.9318: 1.8256, 411.6535: 1.9176, 416.6929: 2.0352,
                       422.6247: 2.1819, 427.1916: 2.2663, 431.9685: 2.3136, 437.0079: 2.3307, 443.0446: 2.3281,
                       451.2336: 2.3060, 456.3780: 2.2739, 461.9423: 2.1950, 470.4987: 2.0372, 477.7953: 1.8794,
                       485.9318: 1.7347, 490.4987: 1.6794, 495.2756: 1.6523, 502.3097: 1.6578, 512.0735: 1.7151,
                       524.7244: 1.8352, 530.9186: 1.8864, 537.4803: 1.9206, 542.9921: 1.9286, 551.0761: 1.8950,
                       556.4304: 1.8307, 563.6745: 1.7191, 572.8084: 1.5302, 581.2073: 1.3367, 589.1339: 1.1739,
                       596.3255: 1.0668, 604.4619: 0.9940, 610.2362: 0.9789, 619.6325: 1.0070, 633.0184: 1.1251,
                       649.8688: 1.3246, 662.2572: 1.4492, 673.7533: 1.5266, 684.1470: 1.5653, 692.1260: 1.5734,
                       701.4173: 1.5528, 709.7638: 1.5045, 718.8451: 1.4231}
        minimum_sd = {400.2965: 1.1272, 401.8537: 1.0866, 405.7985: 1.0430, 410.9891: 1.0153, 417.4254: 1.0203,
                      424.2770: 1.0242, 431.9590: 1.0124, 440.0563: 0.9916, 448.7765: 0.9668, 460.5071: 0.9362,
                      474.2102: 0.9015, 484.2800: 0.8788, 492.0658: 0.8679, 504.2117: 0.8847, 515.0081: 0.8946,
                      529.3341: 0.8877, 542.8296: 0.8669, 555.1831: 0.8382, 565.9795: 0.7848, 572.5196: 0.7363,
                      579.3712: 0.6670, 587.4685: 0.5542, 594.2162: 0.4463, 601.7944: 0.3523, 608.9574: 0.3008,
                      616.5356: 0.2741, 628.3701: 0.2672, 642.6961: 0.2820, 657.2297: 0.2929, 676.3310: 0.2900,
                      691.4875: 0.2830, 707.0592: 0.2712, 713.9107: 0.2642, 719.4127: 0.2563}
        self.d_ref_sd = colour.SpectralDistribution(midscale_sd)
        self.d_min_sd = colour.SpectralDistribution(minimum_sd)

        self.mtf = [{2.3720: 1.1648, 4.7820: 1.1477, 8.8881: 1.1165, 15.1375: 1.0598, 25.1087: 0.9492, 36.9420: 0.8270,
                     50.8782: 0.6860, 62.4071: 0.5724, 72.0940: 0.4734, 83.2846: 0.3601, 88.5204: 0.3061,
                     93.6085: 0.2539}]

        # copied from kodak 5207
        red_rms = {0.0161: 0.0049, 0.1713: 0.0050, 0.3747: 0.0051, 0.5514: 0.0050, 0.7388: 0.0054, 0.9261: 0.0055,
                   1.0546: 0.0062, 1.1563: 0.0074, 1.2580: 0.0085, 1.3651: 0.0096, 1.4775: 0.0100, 1.5685: 0.0099,
                   1.7238: 0.0088, 1.8308: 0.0084, 1.9165: 0.0082, 2.0664: 0.0077, 2.2698: 0.0070, 2.3769: 0.0066,
                   2.5589: 0.0061, 2.9443: 0.0056, 3.3191: 0.0053, 3.4850: 0.0054, 3.6724: 0.0050, 3.8330: 0.0048,
                   4.0739: 0.0046, 4.2666: 0.0045, 4.4968: 0.0046, 4.6306: 0.0043, 4.8233: 0.0042, 5.0000: 0.0043}
        green_rms = {0.0000: 0.0051, 0.1392: 0.0056, 0.2730: 0.0059, 0.4711: 0.0057, 0.7334: 0.0055, 0.9315: 0.0063,
                     1.1510: 0.0079, 1.2794: 0.0089, 1.4186: 0.0103, 1.5418: 0.0107, 1.6435: 0.0103, 1.8201: 0.0092,
                     1.9486: 0.0080, 2.1734: 0.0074, 2.3448: 0.0068, 2.5321: 0.0062, 2.7730: 0.0063, 3.0835: 0.0065,
                     3.3779: 0.0069, 3.5278: 0.0071, 3.7420: 0.0066, 4.0739: 0.0061, 4.3148: 0.0058, 4.5343: 0.0053,
                     4.7430: 0.0051, 5.0054: 0.0046}
        blue_rms = {0.0000: 0.0112, 0.0857: 0.0114, 0.1606: 0.0123, 0.2409: 0.0126, 0.3158: 0.0123, 0.3961: 0.0118,
                    0.5139: 0.0115, 0.6531: 0.0116, 0.8030: 0.0125, 0.9315: 0.0140, 1.0493: 0.0154, 1.1938: 0.0165,
                    1.3169: 0.0164, 1.4507: 0.0156, 1.5578: 0.0155, 1.6863: 0.0157, 1.7934: 0.0153, 1.9245: 0.0140,
                    2.0610: 0.0129, 2.2645: 0.0124, 2.4732: 0.0127, 2.6552: 0.0128, 2.8747: 0.0135, 3.0246: 0.0138,
                    3.2976: 0.0133, 3.6403: 0.0121, 4.1649: 0.0101, 4.4700: 0.0088, 4.8073: 0.0069, 5.0054: 0.0060}
        red_rms_density = {0.0000: 0.2286, 0.7369: 0.2286, 1.0380: 0.2429, 1.2520: 0.2714, 1.4659: 0.3429,
                           1.7829: 0.4976, 3.7837: 1.5857, 4.0967: 1.7381, 4.4176: 1.8762, 4.7385: 1.9714,
                           5.0000: 2.0238}
        green_rms_density = {0.0079: 0.5952, 0.5784: 0.5952, 0.9509: 0.6048, 1.1648: 0.6333, 1.3312: 0.6714,
                             1.5610: 0.7762, 1.9810: 1.0524, 2.9160: 1.6429, 3.8629: 2.2500, 4.1125: 2.4000,
                             4.3502: 2.5190, 4.5761: 2.6071, 4.7425: 2.6524, 4.8732: 2.6810, 4.9960: 2.7000}
        blue_rms_density = {0.0000: 1.0071, 0.6418: 1.0119, 0.9350: 1.0310, 1.1648: 1.0810, 1.4342: 1.1762,
                            1.7868: 1.3452, 2.2464: 1.6452, 2.9279: 2.0452, 3.8788: 2.6119, 4.2353: 2.7881,
                            4.5840: 2.9190, 4.8732: 2.9929}
        self.rms_curve = [red_rms, green_rms, blue_rms]
        self.rms_density = [red_rms_density, green_rms_density, blue_rms_density]
        self.rms = 3

        self.calibrate()
