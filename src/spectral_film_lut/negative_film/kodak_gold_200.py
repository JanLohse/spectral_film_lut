from spectral_film_lut.film_spectral import *


class KodakGold200(FilmSpectral):
    def __init__(self):
        super().__init__()

        self.iso = 200
        self.density_measure = 'status_m'

        # spectral sensitivity
        red_log_sensitivity = {391.2959: 0.3886, 394.1727: 0.4731, 400.5253: 0.6223, 408.5567: 0.5588, 416.4679: 0.4540,
                               423.6600: 0.3463, 430.8520: 0.2366, 439.0029: 0.1269, 447.8032: 0.0405, 464.5177: 0.0000,
                               485.5301: 0.0101, 492.7032: 0.1146, 515.7176: 0.3548, 525.7864: 0.4338, 535.8552: 0.5001,
                               542.8075: 0.5554, 558.8697: 0.7548, 567.2603: 0.8513, 577.0894: 1.0979, 580.2059: 1.1551,
                               590.0350: 1.3832, 594.3502: 1.4501, 608.7342: 1.6179, 617.3646: 1.7289, 625.7553: 1.8296,
                               632.7076: 1.9204, 642.0572: 2.0959, 649.6180: 2.1978, 657.8796: 2.1908, 662.4345: 2.0966,
                               664.8319: 1.9187, 666.8030: 1.8040, 669.0938: 1.6801, 671.1182: 1.5661, 673.4623: 1.4530,
                               676.0340: 1.3311, 678.4967: 1.2125, 682.3324: 1.1002, 687.3668: 0.9018,
                               689.7642: 0.8217, }
        green_log_sensitivity = {380.9874: 0.5871, 384.8231: 0.7093, 388.1794: 0.8258, 391.5357: 0.9299,
                                 399.5702: 1.2203, 408.7965: 1.2238, 418.8653: 1.1395, 426.5368: 1.0691,
                                 441.4002: 0.9324, 461.0584: 0.9208, 469.2093: 0.9307, 478.0795: 1.1070,
                                 491.9840: 1.5168, 494.6211: 1.5729, 510.4435: 1.7562, 519.3136: 1.8572,
                                 525.0672: 1.9323, 534.2476: 2.0930, 541.1294: 2.1926, 549.5224: 2.2363,
                                 558.3902: 2.1802, 564.8630: 2.0739, 570.6166: 1.8932, 574.4523: 1.7795,
                                 577.3291: 1.6681, 579.2128: 1.5606, 581.0358: 1.4334, 585.2404: 1.1066,
                                 587.3980: 0.9079, 588.8706: 0.7935, 590.7200: 0.6665, 592.2269: 0.5461,
                                 594.1105: 0.4170, 595.8571: 0.3004, }
        blue_log_sensitivity = {371.1583: 0.9047, 375.5694: 1.0102, 379.0695: 1.1589, 382.4258: 1.2786,
                                385.5423: 1.3904, 388.4191: 1.4992, 391.7754: 1.6148, 393.8131: 1.7173,
                                396.5358: 1.8210, 410.2349: 2.1099, 420.3037: 2.0915, 430.3725: 2.0943,
                                439.4824: 2.1499, 459.3802: 2.1796, 468.7299: 2.3224, 475.6821: 2.2364,
                                479.2182: 2.1053, 479.2781: 2.0478, 481.9152: 1.8552, 483.3878: 1.7315,
                                484.3125: 1.6084, 485.3314: 1.4935, 487.4291: 1.1687, 488.7476: 1.0910,
                                491.2648: 0.8654, 492.7631: 0.7560, 495.0406: 0.6473, 505.6488: 0.1463,
                                509.0051: 0.0556, }
        self.log_sensitivity = [red_log_sensitivity, green_log_sensitivity, blue_log_sensitivity]

        # sensiometry - characteristic curve
        red_curve = {-2.9025: 0.2560, -2.7732: 0.2617, -2.6439: 0.2710, -2.5146: 0.2885, -2.3853: 0.3159,
                     -2.2560: 0.3550, -2.1266: 0.4047, -1.9973: 0.4638, -1.8680: 0.5297, -1.7387: 0.5990,
                     -1.6094: 0.6683, -1.4801: 0.7379, -1.3508: 0.8072, -1.2215: 0.8767, -1.0922: 0.9465,
                     -0.9629: 1.0170, -0.8335: 1.0881, -0.7042: 1.1592, -0.5749: 1.2308, -0.4456: 1.3028,
                     -0.3163: 1.3751, -0.1870: 1.4475, -0.0577: 1.5176, 0.0716: 1.5769, 0.2009: 1.6278, 0.3302: 1.6711,
                     0.4595: 1.7109, 0.5889: 1.7491, 0.7182: 1.7876, 0.8225: 1.8196, }
        green_curve = {-2.8942: 0.6617, -2.7648: 0.6685, -2.6355: 0.6816, -2.5062: 0.7062, -2.3769: 0.7421,
                       -2.2476: 0.7898, -2.1183: 0.8461, -1.9890: 0.9075, -1.8597: 0.9757, -1.7304: 1.0488,
                       -1.6011: 1.1224, -1.4718: 1.1963, -1.3424: 1.2701, -1.2131: 1.3434, -1.0838: 1.4173,
                       -0.9545: 1.4911, -0.8252: 1.5643, -0.6959: 1.6377, -0.5666: 1.7108, -0.4373: 1.7833,
                       -0.3080: 1.8557, -0.1787: 1.9270, -0.0493: 1.9953, 0.0800: 2.0566, 0.2093: 2.1069,
                       0.3386: 2.1484, 0.4679: 2.1865, 0.5972: 2.2240, 0.7265: 2.2626, 0.8266: 2.2923, }
        blue_curve = {-2.6773: 0.9637, -2.5479: 0.9757, -2.4186: 1.0049, -2.2893: 1.0472, -2.1600: 1.1019,
                      -2.0307: 1.1688, -1.9014: 1.2465, -1.7721: 1.3244, -1.6428: 1.4029, -1.5135: 1.4837,
                      -1.3842: 1.5686, -1.2548: 1.6616, -1.1255: 1.7488, -0.9962: 1.8158, -0.8669: 1.8863,
                      -0.7376: 1.9623, -0.6083: 2.0427, -0.4790: 2.1247, -0.3497: 2.2063, -0.2204: 2.2874,
                      -0.0911: 2.3656, 0.0383: 2.4381, 0.1676: 2.4995, 0.2969: 2.5496, 0.4262: 2.5942, 0.5555: 2.6371,
                      0.6848: 2.6821, 0.8058: 2.7240, }
        red_log_exposure = xp.array(list(red_curve.keys()), dtype=default_dtype)
        red_density_curve = xp.array(list(red_curve.values()), dtype=default_dtype)
        green_log_exposure = xp.array(list(green_curve.keys()), dtype=default_dtype)
        green_density_curve = xp.array(list(green_curve.values()), dtype=default_dtype)
        blue_log_exposure = xp.array(list(blue_curve.keys()), dtype=default_dtype)
        blue_density_curve = xp.array(list(blue_curve.values()), dtype=default_dtype)
        self.log_exposure = [red_log_exposure, green_log_exposure, blue_log_exposure]
        self.density_curve = [red_density_curve, green_density_curve, blue_density_curve]

        # spectral dye density
        midscale_sd = {405.6130: 1.3293, 411.6292: 1.4175, 415.8534: 1.5006, 419.9211: 1.5833, 424.1453: 1.6635,
                       429.4646: 1.7483, 437.4436: 1.8151, 447.1435: 1.8349, 456.8435: 1.7958, 465.2918: 1.7278,
                       471.8627: 1.6423, 477.8078: 1.5592, 483.9094: 1.4783, 491.8884: 1.4025, 501.5884: 1.3808,
                       511.2883: 1.4006, 520.9882: 1.4417, 530.6882: 1.4826, 540.3881: 1.5091, 549.9316: 1.4701,
                       557.5977: 1.3844, 563.0735: 1.3027, 567.6105: 1.2220, 571.6783: 1.1387, 575.9024: 1.0570,
                       580.4395: 0.9722, 585.4459: 0.8892, 591.7040: 0.8064, 600.1523: 0.7399, 609.8522: 0.7203,
                       619.5522: 0.7446, 629.2521: 0.7956, 638.9521: 0.8657, 648.6520: 0.9398, 658.3520: 1.0147,
                       668.0519: 1.0776, 677.7518: 1.1355, 687.4518: 1.1726, 693.7098: 1.1751}
        minimum_sd = {407.4050: 0.7712, 416.4792: 0.8468, 425.5533: 0.9236, 435.2533: 0.9737, 444.9532: 0.9820,
            454.6531: 0.9483, 464.3531: 0.8906, 474.0530: 0.8230, 483.7530: 0.7522, 493.4529: 0.6933, 503.1529: 0.6636,
            512.8528: 0.6533, 522.5527: 0.6428, 532.2527: 0.6419, 541.9526: 0.6421, 551.6526: 0.6355, 561.3525: 0.6216,
            571.0525: 0.5827, 579.8137: 0.5116, 587.1669: 0.4297, 595.1459: 0.3473, 604.5329: 0.2807, 614.2329: 0.2439,
            623.9328: 0.2307, 633.6327: 0.2306, 643.3327: 0.2395, 653.0326: 0.2521, 662.7326: 0.2669, 672.4325: 0.2807,
            682.1325: 0.2929, 691.3630: 0.3000, }
        self.d_ref_sd = colour.SpectralDistribution(midscale_sd)
        self.d_min_sd = colour.SpectralDistribution(minimum_sd)

        red_mtf = {2.5343: 1.0256, 3.1724: 1.0063, 4.2554: 0.9912, 5.4826: 0.9875, 6.8238: 1.0140, 8.4443: 1.0191,
                   9.6959: 0.9887, 12.3489: 0.9962, 14.7626: 1.0025, 17.7294: 0.9353, 21.9650: 0.8070, 29.6336: 0.5999,
                   38.4000: 0.4516, 45.9052: 0.3531, 50.9191: 0.2978, 57.7967: 0.2659, 67.7534: 0.2105, 80.2530: 0.1615}
        green_mtf = {2.5343: 1.0584, 3.0647: 1.0438, 4.0405: 1.0386, 5.7081: 1.0692, 7.4824: 1.1288, 9.7519: 1.1489,
                     14.3435: 1.1708, 19.6885: 1.1203, 26.5623: 0.9813, 34.6188: 0.8434, 47.2463: 0.7113,
                     53.3198: 0.6430, 65.4523: 0.5111, 79.5169: 0.4047}
        blue_mtf = {2.5489: 1.0191, 3.8808: 0.9875, 4.9713: 0.9862, 6.2952: 1.0000, 8.0641: 1.0127, 9.8082: 1.0544,
                    12.4920: 1.0412, 17.9554: 0.9690, 24.5048: 0.8595, 29.4635: 0.7529, 37.5255: 0.6512,
                    50.0469: 0.5562, 59.4851: 0.4750, 79.3339: 0.3645}
        self.mtf = [red_mtf, green_mtf, blue_mtf]

        # copied from kodak 5207
        red_rms = {0.0161: 0.0049, 0.1713: 0.0050, 0.3747: 0.0051, 0.5514: 0.0050, 0.7388: 0.0054, 0.9261: 0.0055,
                   1.0546: 0.0062, 1.1563: 0.0074, 1.2580: 0.0085, 1.3651: 0.0096, 1.4775: 0.0100, 1.5685: 0.0099,
                   1.7238: 0.0088, 1.8308: 0.0084, 1.9165: 0.0082, 2.0664: 0.0077, 2.2698: 0.0070, 2.3769: 0.0066,
                   2.5589: 0.0061, 2.9443: 0.0056, 3.3191: 0.0053, 3.4850: 0.0054, 3.6724: 0.0050, 3.8330: 0.0048,
                   4.0739: 0.0046, 4.2666: 0.0045, 4.4968: 0.0046, 4.6306: 0.0043, 4.8233: 0.0042, 5.0000: 0.0043}
        green_rms = {0.0000: 0.0051, 0.1392: 0.0056, 0.2730: 0.0059, 0.4711: 0.0057, 0.7334: 0.0055, 0.9315: 0.0063,
                     1.1510: 0.0079, 1.2794: 0.0089, 1.4186: 0.0103, 1.5418: 0.0107, 1.6435: 0.0103, 1.8201: 0.0092,
                     1.9486: 0.0080, 2.1734: 0.0074, 2.3448: 0.0068, 2.5321: 0.0062, 2.7730: 0.0063, 3.0835: 0.0065,
                     3.3779: 0.0069, 3.5278: 0.0071, 3.7420: 0.0066, 4.0739: 0.0061, 4.3148: 0.0058, 4.5343: 0.0053,
                     4.7430: 0.0051, 5.0054: 0.0046}
        blue_rms = {0.0000: 0.0112, 0.0857: 0.0114, 0.1606: 0.0123, 0.2409: 0.0126, 0.3158: 0.0123, 0.3961: 0.0118,
                    0.5139: 0.0115, 0.6531: 0.0116, 0.8030: 0.0125, 0.9315: 0.0140, 1.0493: 0.0154, 1.1938: 0.0165,
                    1.3169: 0.0164, 1.4507: 0.0156, 1.5578: 0.0155, 1.6863: 0.0157, 1.7934: 0.0153, 1.9245: 0.0140,
                    2.0610: 0.0129, 2.2645: 0.0124, 2.4732: 0.0127, 2.6552: 0.0128, 2.8747: 0.0135, 3.0246: 0.0138,
                    3.2976: 0.0133, 3.6403: 0.0121, 4.1649: 0.0101, 4.4700: 0.0088, 4.8073: 0.0069, 5.0054: 0.0060}
        red_rms_density = {0.0000: 0.2286, 0.7369: 0.2286, 1.0380: 0.2429, 1.2520: 0.2714, 1.4659: 0.3429,
                           1.7829: 0.4976, 3.7837: 1.5857, 4.0967: 1.7381, 4.4176: 1.8762, 4.7385: 1.9714,
                           5.0000: 2.0238}
        green_rms_density = {0.0079: 0.5952, 0.5784: 0.5952, 0.9509: 0.6048, 1.1648: 0.6333, 1.3312: 0.6714,
                             1.5610: 0.7762, 1.9810: 1.0524, 2.9160: 1.6429, 3.8629: 2.2500, 4.1125: 2.4000,
                             4.3502: 2.5190, 4.5761: 2.6071, 4.7425: 2.6524, 4.8732: 2.6810, 4.9960: 2.7000}
        blue_rms_density = {0.0000: 1.0071, 0.6418: 1.0119, 0.9350: 1.0310, 1.1648: 1.0810, 1.4342: 1.1762,
                            1.7868: 1.3452, 2.2464: 1.6452, 2.9279: 2.0452, 3.8788: 2.6119, 4.2353: 2.7881,
                            4.5840: 2.9190, 4.8732: 2.9929}
        self.rms_curve = [red_rms, green_rms, blue_rms]
        self.rms_density = [red_rms_density, green_rms_density, blue_rms_density]
        # guessed value:
        self.rms = 4.4

        self.calibrate()
