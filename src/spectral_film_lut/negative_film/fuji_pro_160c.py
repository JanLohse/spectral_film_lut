from spectral_film_lut.film_spectral import *


class FujiPro160C(FilmSpectral):
    def __init__(self):
        super().__init__()

        self.iso = 160
        self.density_measure = 'status_m'
        self.exposure_kelvin = 5500
        self.year = 2004
        self.manufacturer = 'Fujifilm'
        self.stage = 'camera'
        self.type = 'negative'
        self.medium = 'photo'

        # spectral sensitivity
        red_log_sensitivity = {564.5800: -0.5651, 570.7600: -0.2849, 580.5400: 0.1518, 586.5400: 0.4319,
                               592.5400: 0.6199, 597.5800: 0.7271, 604.4800: 0.8386, 610.1200: 0.8934, 615.8800: 0.9235,
                               623.0800: 0.9145, 629.3800: 0.8807, 632.9800: 0.8416, 636.8200: 0.7723, 642.7000: 0.5825,
                               649.0600: 0.2934, 653.6800: 0.0373, 659.0200: -0.2518, 663.9400: -0.5139,
                               668.8000: -0.7458}
        green_log_sensitivity = {484.4200: -0.5940, 490.7800: -0.2518, 498.4600: 0.1367, 506.3200: 0.4139,
                                 510.8200: 0.5313, 519.5800: 0.6970, 529.7200: 0.8482, 536.7400: 0.9530,
                                 540.5800: 1.0223, 544.4200: 1.0952, 547.7800: 1.1458, 552.2800: 1.1639,
                                 555.8800: 1.1488, 559.6000: 1.1048, 564.2200: 1.0223, 568.9600: 0.8867,
                                 574.4200: 0.6518, 580.4800: 0.2000, 583.7200: -0.1373, 586.1800: -0.4416,
                                 589.3000: -0.7940}
        blue_log_sensitivity = {380.9800: -0.3030, 385.7800: -0.0560, 393.2800: 0.3777, 398.9800: 0.6699,
                                403.4800: 0.8235, 405.9400: 0.8952, 409.2400: 0.9524, 412.7800: 0.9861,
                                416.6800: 1.0042, 430.1800: 1.0054, 441.5800: 1.0072, 452.6800: 1.0223,
                                457.4800: 1.0645, 463.1800: 1.1518, 466.7200: 1.2157, 469.7200: 1.2548,
                                472.7800: 1.2542, 475.6600: 1.2241, 477.1000: 1.1639, 480.7000: 0.9741,
                                485.5600: 0.5464, 489.2200: 0.2241, 493.7800: -0.0500, 499.5400: -0.3271,
                                504.8200: -0.5500, 509.7400: -0.7458, 514.6600: -0.9199}
        self.log_sensitivity = [red_log_sensitivity, green_log_sensitivity, blue_log_sensitivity]

        # sensiometry - characteristic curve
        red_curve = {-3.6618: 0.2372, -3.3036: 0.2396, -2.9382: 0.2461, -2.6707: 0.2597, -2.5261: 0.2709,
                     -2.3735: 0.2966, -2.2570: 0.3326, -2.0249: 0.4312, -1.7631: 0.5675, -1.4618: 0.7438,
                     -1.0369: 1.0067, -0.5904: 1.2976, -0.1631: 1.5773, 0.1285: 1.7617, 0.3004: 1.8683, 0.3855: 1.9172,
                     0.4835: 1.9685}
        green_curve = {-3.6683: 0.7101, -3.3976: 0.7061, -3.1687: 0.7085, -2.9116: 0.7181, -2.6787: 0.7326,
                       -2.5341: 0.7510, -2.4386: 0.7742, -2.3542: 0.8039, -2.2490: 0.8480, -2.0924: 0.9201,
                       -1.7671: 1.0980, -1.4137: 1.3104, -1.0361: 1.5509, -0.6329: 1.8082, -0.3494: 1.9877,
                       -0.0827: 2.1552, 0.1888: 2.3083, 0.3663: 2.4037, 0.4859: 2.4606}
        blue_curve = {-3.6635: 0.9418, -3.3253: 0.9410, -3.0683: 0.9450, -2.8635: 0.9586, -2.6811: 0.9810,
                      -2.5486: 1.0043, -2.4257: 1.0387, -2.2932: 1.0900, -2.1550: 1.1542, -1.9598: 1.2616,
                      -1.7149: 1.4058, -1.3438: 1.6455, -0.9920: 1.8715, -0.6940: 2.0614, -0.3960: 2.2466,
                      -0.0803: 2.4317, 0.1165: 2.5399, 0.2932: 2.6257, 0.3936: 2.6666, 0.4876: 2.6962}
        red_log_exposure = xp.array(list(red_curve.keys()), dtype=default_dtype)
        red_density_curve = xp.array(list(red_curve.values()), dtype=default_dtype)
        green_log_exposure = xp.array(list(green_curve.keys()), dtype=default_dtype)
        green_density_curve = xp.array(list(green_curve.values()), dtype=default_dtype)
        blue_log_exposure = xp.array(list(blue_curve.keys()), dtype=default_dtype)
        blue_density_curve = xp.array(list(blue_curve.values()), dtype=default_dtype)
        self.log_exposure = [red_log_exposure, green_log_exposure, blue_log_exposure]
        self.density_curve = [red_density_curve, green_density_curve, blue_density_curve]

        # spectral dye density
        midscale_sd = {400.4177: 1.8970, 404.2959: 1.9005, 407.6372: 1.9354, 411.5752: 2.0229, 418.7947: 2.2317,
                       423.9260: 2.3473, 428.8186: 2.4090, 434.7852: 2.4491, 443.4368: 2.4605, 451.3126: 2.4273,
                       459.5465: 2.3432, 466.1695: 2.2323, 474.4033: 2.0538, 483.2339: 1.8781, 488.1862: 1.8026,
                       492.8998: 1.7620, 499.1647: 1.7546, 507.2792: 1.7941, 516.7064: 1.8724, 525.5370: 1.9594,
                       531.4439: 2.0057, 538.9021: 2.0429, 545.1671: 2.0343, 552.2673: 1.9811, 561.2768: 1.8570,
                       569.3914: 1.6888, 578.9379: 1.4708, 588.7232: 1.2477, 598.2697: 1.0990, 604.5943: 1.0423,
                       611.0979: 1.0360, 618.2578: 1.0526, 626.4916: 1.1173, 639.8568: 1.2792, 654.1766: 1.4525,
                       669.3317: 1.5904, 681.5036: 1.6619, 691.3484: 1.6796, 701.4916: 1.6625, 710.4415: 1.6064,
                       719.3317: 1.5246}
        minimum_sd = {401.3723: 1.1419, 406.1456: 1.0932, 410.6205: 1.0761, 419.2721: 1.0932, 428.5203: 1.0875,
                      441.9451: 1.0543, 463.4248: 0.9931, 478.3413: 0.9559, 489.9761: 0.9405, 499.2243: 0.9468,
                      511.1575: 0.9640, 525.1790: 0.9565, 545.1671: 0.9188, 555.9069: 0.8930, 564.2601: 0.8530,
                      572.6134: 0.7786, 580.7279: 0.6733, 589.0215: 0.5383, 599.1647: 0.3896, 605.7279: 0.3295,
                      613.1862: 0.2923, 620.9427: 0.2786, 634.9642: 0.2895, 650.4773: 0.3112, 666.5871: 0.3152,
                      682.6969: 0.3032, 702.3866: 0.2843, 718.7947: 0.2637}
        self.d_ref_sd = colour.SpectralDistribution(midscale_sd)
        self.d_min_sd = colour.SpectralDistribution(minimum_sd)

        self.mtf = [{2.5272: 1.1713, 4.6121: 1.1484, 6.2938: 1.1326, 8.9606: 1.1104, 13.4992: 1.0674, 20.3778: 0.9961,
                     27.6959: 0.9258, 35.2875: 0.8504, 46.2486: 0.7434, 54.5743: 0.6603, 64.1394: 0.5648,
                     72.6910: 0.4813, 79.2828: 0.4150, 85.9502: 0.3474, 91.6857: 0.2885, 94.5045: 0.2567,
                     97.2134: 0.2289}]

        # copied from kodak 5207
        red_rms = {0.0161: 0.0049, 0.1713: 0.0050, 0.3747: 0.0051, 0.5514: 0.0050, 0.7388: 0.0054, 0.9261: 0.0055,
                   1.0546: 0.0062, 1.1563: 0.0074, 1.2580: 0.0085, 1.3651: 0.0096, 1.4775: 0.0100, 1.5685: 0.0099,
                   1.7238: 0.0088, 1.8308: 0.0084, 1.9165: 0.0082, 2.0664: 0.0077, 2.2698: 0.0070, 2.3769: 0.0066,
                   2.5589: 0.0061, 2.9443: 0.0056, 3.3191: 0.0053, 3.4850: 0.0054, 3.6724: 0.0050, 3.8330: 0.0048,
                   4.0739: 0.0046, 4.2666: 0.0045, 4.4968: 0.0046, 4.6306: 0.0043, 4.8233: 0.0042, 5.0000: 0.0043}
        green_rms = {0.0000: 0.0051, 0.1392: 0.0056, 0.2730: 0.0059, 0.4711: 0.0057, 0.7334: 0.0055, 0.9315: 0.0063,
                     1.1510: 0.0079, 1.2794: 0.0089, 1.4186: 0.0103, 1.5418: 0.0107, 1.6435: 0.0103, 1.8201: 0.0092,
                     1.9486: 0.0080, 2.1734: 0.0074, 2.3448: 0.0068, 2.5321: 0.0062, 2.7730: 0.0063, 3.0835: 0.0065,
                     3.3779: 0.0069, 3.5278: 0.0071, 3.7420: 0.0066, 4.0739: 0.0061, 4.3148: 0.0058, 4.5343: 0.0053,
                     4.7430: 0.0051, 5.0054: 0.0046}
        blue_rms = {0.0000: 0.0112, 0.0857: 0.0114, 0.1606: 0.0123, 0.2409: 0.0126, 0.3158: 0.0123, 0.3961: 0.0118,
                    0.5139: 0.0115, 0.6531: 0.0116, 0.8030: 0.0125, 0.9315: 0.0140, 1.0493: 0.0154, 1.1938: 0.0165,
                    1.3169: 0.0164, 1.4507: 0.0156, 1.5578: 0.0155, 1.6863: 0.0157, 1.7934: 0.0153, 1.9245: 0.0140,
                    2.0610: 0.0129, 2.2645: 0.0124, 2.4732: 0.0127, 2.6552: 0.0128, 2.8747: 0.0135, 3.0246: 0.0138,
                    3.2976: 0.0133, 3.6403: 0.0121, 4.1649: 0.0101, 4.4700: 0.0088, 4.8073: 0.0069, 5.0054: 0.0060}
        red_rms_density = {0.0000: 0.2286, 0.7369: 0.2286, 1.0380: 0.2429, 1.2520: 0.2714, 1.4659: 0.3429,
                           1.7829: 0.4976, 3.7837: 1.5857, 4.0967: 1.7381, 4.4176: 1.8762, 4.7385: 1.9714,
                           5.0000: 2.0238}
        green_rms_density = {0.0079: 0.5952, 0.5784: 0.5952, 0.9509: 0.6048, 1.1648: 0.6333, 1.3312: 0.6714,
                             1.5610: 0.7762, 1.9810: 1.0524, 2.9160: 1.6429, 3.8629: 2.2500, 4.1125: 2.4000,
                             4.3502: 2.5190, 4.5761: 2.6071, 4.7425: 2.6524, 4.8732: 2.6810, 4.9960: 2.7000}
        blue_rms_density = {0.0000: 1.0071, 0.6418: 1.0119, 0.9350: 1.0310, 1.1648: 1.0810, 1.4342: 1.1762,
                            1.7868: 1.3452, 2.2464: 1.6452, 2.9279: 2.0452, 3.8788: 2.6119, 4.2353: 2.7881,
                            4.5840: 2.9190, 4.8732: 2.9929}
        self.rms_curve = [red_rms, green_rms, blue_rms]
        self.rms_density = [red_rms_density, green_rms_density, blue_rms_density]
        self.rms = 3

        self.calibrate()
