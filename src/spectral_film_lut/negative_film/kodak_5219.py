from spectral_film_lut.film_spectral import *


class Kodak5219(FilmSpectral):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)

        self.iso = 500
        self.density_measure = 'status_m'
        self.exposure_kelvin = 3200
        self.projection_kelvin = None

        # spectral sensitivity
        red_log_sensitivity = {508.4522: 0.6117, 516.9639: 0.6866, 523.4490: 0.7400, 528.7181: 0.7578, 535.8412: 0.7104,
                               541.4706: 0.6539, 545.9741: 0.6186, 549.1641: 0.6009, 551.6974: 0.6424, 554.9812: 0.7368,
                               557.1391: 0.8277, 562.5809: 0.9539, 568.6794: 1.1216, 574.4965: 1.2928, 581.4394: 1.5999,
                               587.8195: 1.8558, 594.1995: 2.0552, 598.9845: 2.1214, 607.2409: 2.2361, 613.5271: 2.3429,
                               618.0306: 2.4046, 621.5959: 2.4241, 626.0995: 2.4011, 632.1042: 2.3799, 639.6101: 2.3870,
                               645.4271: 2.4196, 650.6812: 2.4470, 655.3724: 2.4488, 659.8759: 2.4117, 662.3154: 2.3358,
                               665.9745: 2.2167, 670.2904: 2.0773, 672.6359: 1.9387, 675.6383: 1.8575, 679.0159: 1.7816,
                               681.1739: 1.6881}
        green_log_sensitivity = {448.3976: 1.0122, 453.4641: 1.0898, 458.6244: 1.1454, 464.5353: 1.1781,
                                 469.4141: 1.2169, 473.9177: 1.3634, 479.9224: 1.5875, 484.8012: 1.8240,
                                 489.8677: 2.0040, 497.0921: 2.1796, 503.2844: 2.2943, 513.8865: 2.4029,
                                 524.4885: 2.5017, 531.3377: 2.5688, 534.5277: 2.6094, 538.5621: 2.6897,
                                 542.9718: 2.7594, 547.4753: 2.7982, 551.6036: 2.7876, 557.4206: 2.7400,
                                 562.4871: 2.6764, 569.6177: 2.6005, 574.1212: 2.5441, 578.8124: 2.4576,
                                 581.6271: 2.3252, 587.6318: 1.9775, 591.9477: 1.6016, 595.5130: 1.1922,
                                 598.3277: 0.9371, 599.6412: 0.7863}
        blue_log_sensitivity = {368.3661: 2.5220, 376.9979: 2.7497, 382.6273: 2.8997, 389.2888: 3.0506,
                                393.9800: 3.1459, 399.3279: 3.2015, 403.9253: 3.2094, 410.4929: 3.1918,
                                415.5594: 3.1688, 424.9418: 3.1688, 434.5118: 3.1318, 443.7065: 3.0877,
                                451.4000: 3.0577, 458.5306: 3.0629, 464.5353: 3.0718, 469.7894: 3.0418,
                                479.4532: 2.8573, 487.3344: 2.6932, 493.9959: 2.5229, 498.3118: 2.3482,
                                508.0694: 1.9511, 514.0741: 1.6758, 518.5777: 1.4816, 523.8318: 1.0863,
                                527.7724: 0.8110, 529.7427: 0.6936}
        self.log_sensitivity = [red_log_sensitivity, green_log_sensitivity, blue_log_sensitivity]

        # sensiometry - characteristic curve
        red_curve = {-3.9225: 0.1810, -3.6505: 0.1897, -3.4139: 0.2013, -3.2523: 0.2201, -3.0158: 0.2635,
                     -2.7911: 0.3156, -2.5526: 0.4025, -2.2234: 0.5560, -1.7858: 0.7674, -1.0920: 1.1004,
                     -0.6110: 1.3320, -0.2168: 1.5174, 0.0237: 1.6158, 0.2247: 1.6955, 0.3784: 1.7447, 0.5558: 1.7939,
                     0.7332: 1.8345, 0.8712: 1.8649}
        green_curve = {-3.9106: 0.5792, -3.6820: 0.5777, -3.4928: 0.5849, -3.3311: 0.6009, -3.1971: 0.6284,
                       -3.0118: 0.6704, -2.8561: 0.7124, -2.7201: 0.7543, -2.5821: 0.8181, -2.3771: 0.9295,
                       -1.9829: 1.1511, -1.4783: 1.4377, -0.9106: 1.7563, -0.4218: 2.0256, -0.1675: 2.1631,
                       0.0512: 2.2674, 0.2484: 2.3615, 0.4060: 2.4252, 0.5834: 2.4860, 0.7608: 2.5396, 0.8712: 2.5671}
        blue_curve = {-3.9106: 0.8354, -3.6781: 0.8398, -3.4415: 0.8542, -3.1892: 0.8847, -2.9330: 0.9324,
                      -2.6984: 1.0019, -2.5250: 1.0917, -2.2510: 1.2437, -1.7267: 1.5304, -1.2142: 1.8069,
                      -0.6702: 2.1067, -0.2957: 2.3050, -0.0237: 2.4426, 0.1143: 2.5106, 0.2641: 2.5758, 0.3942: 2.6221,
                      0.5519: 2.6670, 0.7057: 2.7090, 0.8653: 2.7510}
        red_log_exposure = xp.array(list(red_curve.keys()), dtype=default_dtype)
        red_density_curve = xp.array(list(red_curve.values()), dtype=default_dtype)
        green_log_exposure = xp.array(list(green_curve.keys()), dtype=default_dtype)
        green_density_curve = xp.array(list(green_curve.values()), dtype=default_dtype)
        blue_log_exposure = xp.array(list(blue_curve.keys()), dtype=default_dtype)
        blue_density_curve = xp.array(list(blue_curve.values()), dtype=default_dtype)
        self.log_exposure = [red_log_exposure, green_log_exposure, blue_log_exposure]
        self.density_curve = [red_density_curve, green_density_curve, blue_density_curve]

        self.exposure_base = 10

        # spectral dye density
        red_sd = {400.1747: 0.1995, 415.0132: 0.1350, 431.4416: 0.0710, 447.0221: 0.0292, 477.5471: 0.0133,
                  503.1966: 0.0270, 527.9982: 0.0593, 551.1040: 0.1286, 573.7858: 0.2270, 587.7764: 0.3191,
                  614.2738: 0.5805, 628.2645: 0.7096, 641.5132: 0.8159, 652.3241: 0.8911, 660.0614: 0.9350,
                  667.9046: 0.9720, 674.6880: 0.9927, 684.6510: 1.0043, 692.1763: 0.9974, 701.6093: 0.9667,
                  711.7844: 0.9085, 730.8625: 0.7424, 747.1849: 0.5657, 764.6732: 0.3884, 777.8159: 0.2763,
                  787.9909: 0.2032, 795.7282: 0.1614, 800.2857: 0.1408}
        green_sd = {400.8106: -0.0185, 412.8934: -0.0243, 421.1606: -0.0269, 426.8841: -0.0153, 431.4416: -0.0169,
                    435.5752: -0.0280, 440.6627: -0.0386, 445.9622: -0.0396, 452.7456: -0.0232, 460.5888: 0.0218,
                    471.9297: 0.1175, 482.5287: 0.2503, 491.2198: 0.3911, 505.9524: 0.6376, 518.5652: 0.8281,
                    524.8185: 0.9128, 529.5881: 0.9609, 533.0857: 0.9868, 538.1732: 1.0022, 541.9889: 0.9953,
                    546.8644: 0.9678, 554.6016: 0.8784, 562.7629: 0.7403, 571.4540: 0.5720, 580.9931: 0.4122,
                    592.0160: 0.2694, 602.4030: 0.1868, 618.3015: 0.1181, 636.5317: 0.0810, 659.0015: 0.0641,
                    685.4989: 0.0546, 717.0838: 0.0477, 756.7240: 0.0302, 787.8850: 0.0165, 800.3917: 0.0106}
        blue_sd = {400.5986: 0.4958, 408.8658: 0.6228, 418.8289: 0.7805, 426.1421: 0.8805, 429.8518: 0.9255,
                   434.7273: 0.9646, 440.2388: 0.9942, 446.1742: 1.0080, 451.2617: 0.9942, 456.7732: 0.9646,
                   463.8745: 0.8937, 472.3536: 0.7699, 480.5149: 0.6397, 491.8558: 0.4599, 505.1045: 0.2927,
                   512.3118: 0.2313, 522.2748: 0.1773, 537.1133: 0.1334, 555.1316: 0.0937, 574.4217: 0.0503,
                   595.6197: 0.0196, 630.3843: 0.0032, 673.6281: -0.0042, 735.1021: 0.0001, 766.8990: 0.0027,
                   799.5438: 0.0048}
        midscale_sd = {399.7507: 1.1001, 409.6078: 1.2514, 421.4786: 1.4583, 427.5200: 1.5593, 431.9716: 1.6080,
                       436.8471: 1.6376, 441.0867: 1.6498, 446.1742: 1.6429, 452.0036: 1.6255, 459.3169: 1.5858,
                       471.1878: 1.4958, 483.6945: 1.4059, 487.0862: 1.3805, 491.5378: 1.3678, 496.4133: 1.3763,
                       501.0769: 1.3900, 505.6344: 1.4170, 509.8740: 1.4318, 514.0076: 1.4239, 518.4592: 1.4075,
                       526.5144: 1.3985, 531.8139: 1.4011, 537.1133: 1.4101, 540.9290: 1.4069, 546.7584: 1.3784,
                       556.4035: 1.2958, 572.3019: 1.1244, 578.0254: 1.0620, 583.7488: 0.9837, 590.4262: 0.8778,
                       595.8316: 0.8143, 600.4952: 0.7784, 604.0988: 0.7625, 608.7624: 0.7614, 613.6379: 0.7773,
                       617.3475: 0.7990, 621.9051: 0.8143, 629.5364: 0.8175, 637.3796: 0.8207, 645.0109: 0.8382,
                       655.3978: 0.8715, 663.6650: 0.8969, 675.1119: 0.9159, 687.8307: 0.9159, 699.4896: 0.8927,
                       710.9364: 0.8387, 727.5768: 0.7218, 742.5214: 0.5942, 764.5672: 0.4027, 779.4058: 0.2958,
                       790.4287: 0.2281, 799.3318: 0.1927}
        minimum_sd = {400.3867: 0.5964, 409.8197: 0.6667, 422.0085: 0.7710, 427.2020: 0.8075, 430.3817: 0.8286,
                      435.4692: 0.8530, 439.3909: 0.8662, 443.9484: 0.8678, 450.6258: 0.8588, 458.8930: 0.8334,
                      466.9482: 0.8133, 476.2753: 0.7826, 481.1508: 0.7636, 486.2383: 0.7360, 490.9018: 0.7196,
                      497.8972: 0.7170, 504.4685: 0.7276, 507.2243: 0.7297, 511.8878: 0.7181, 514.4316: 0.6905,
                      519.7310: 0.6366, 523.5467: 0.6006, 527.1503: 0.5763, 530.5420: 0.5561, 539.0212: 0.5403,
                      548.5602: 0.5265, 557.0394: 0.5239, 563.3988: 0.5276, 568.9103: 0.5360, 576.5415: 0.5382,
                      581.4170: 0.5138, 586.0806: 0.4641, 594.9837: 0.3519, 598.3754: 0.3149, 602.6150: 0.2821,
                      607.0665: 0.2599, 613.0020: 0.2472, 617.4535: 0.2466, 621.0572: 0.2429, 626.5686: 0.2228,
                      634.4119: 0.1916, 640.3473: 0.1694, 647.5546: 0.1593, 671.2963: 0.1466, 707.5448: 0.1334,
                      733.6182: 0.1170, 760.3276: 0.0995, 789.3688: 0.0773}
        self.spectral_density = [colour.SpectralDistribution(x) for x in (red_sd, green_sd, blue_sd)]
        self.d_ref_sd = colour.SpectralDistribution(midscale_sd)
        self.d_min_sd = colour.SpectralDistribution(minimum_sd)

        self.mtf = [{2.4914: 1.0614, 4.6339: 1.0642, 6.6020: 1.0614, 7.9494: 1.0341, 9.4886: 1.0422, 10.7941: 1.0167,
                     13.2843: 0.9316, 16.9305: 0.8547, 20.6099: 0.7740, 26.4975: 0.6397, 34.5920: 0.4979,
                     44.6685: 0.3659, 56.6809: 0.2724, 65.6886: 0.2197, 72.3966: 0.1876, 79.2683: 0.1627},
                    {2.4969: 1.0101, 3.6439: 1.0127, 5.6780: 1.0247, 10.3779: 1.0518, 14.1842: 1.0341, 16.9676: 1.0154,
                     21.4835: 0.9487, 26.3243: 0.8716, 31.6970: 0.7740, 39.6105: 0.6566, 48.4298: 0.5556,
                     56.9291: 0.4628, 67.3602: 0.3707, 79.9641: 0.2893},
                    {2.5576: 1.0260, 6.7626: 1.0587, 9.8262: 1.0895, 13.1975: 1.0952, 16.4205: 1.1009, 19.6426: 1.0698,
                     24.1212: 0.9764, 30.4745: 0.8480, 37.4229: 0.7365, 46.3590: 0.6216, 54.0206: 0.5527,
                     63.3626: 0.4701, 72.0809: 0.4126, 78.6644: 0.3766}]

        red_rms = {0.0023: 0.0055, 0.3019: 0.0054, 0.5621: 0.0055, 0.7211: 0.0056, 0.8696: 0.0061, 1.1192: 0.0078,
                   1.2927: 0.0092, 1.4320: 0.0103, 1.5213: 0.0105, 1.6317: 0.0099, 1.7762: 0.0088, 1.9339: 0.0078,
                   2.1258: 0.0071, 2.3544: 0.0066, 2.5542: 0.0062, 2.7197: 0.0060, 2.8800: 0.0062, 3.1271: 0.0064,
                   3.4503: 0.0060, 3.7447: 0.0060, 4.1809: 0.0055, 4.4543: 0.0053, 4.6303: 0.0051, 4.7302: 0.0051,
                   4.8642: 0.0052, 4.9983: 0.0055}
        green_rms = {0.0049: 0.0073, 0.2362: 0.0075, 0.4596: 0.0075, 0.6383: 0.0077, 0.8341: 0.0084, 0.9983: 0.0096,
                     1.1797: 0.0119, 1.3242: 0.0132, 1.4950: 0.0139, 1.6133: 0.0127, 1.7579: 0.0109, 1.9313: 0.0097,
                     2.0890: 0.0091, 2.2467: 0.0089, 2.4070: 0.0081, 2.6199: 0.0073, 2.7670: 0.0071, 3.1455: 0.0078,
                     3.4530: 0.0083, 3.6790: 0.0080, 3.9733: 0.0076, 4.2493: 0.0070, 4.5147: 0.0066, 4.7670: 0.0060,
                     4.9799: 0.0058}
        blue_rms = {0.0023: 0.0271, 0.4675: 0.0278, 0.6646: 0.0275, 0.8275: 0.0280, 1.1192: 0.0303, 1.4372: 0.0313,
                    1.6606: 0.0297, 1.9313: 0.0253, 2.1547: 0.0217, 2.4096: 0.0196, 2.7802: 0.0193, 3.2269: 0.0203,
                    3.5844: 0.0199, 3.7237: 0.0198, 3.9549: 0.0172, 4.3360: 0.0142, 4.6776: 0.0120, 4.9799: 0.0104}
        red_rms_density = {0.0091: 0.2089, 0.3993: 0.2130, 0.7260: 0.2130, 0.9301: 0.2239, 1.1320: 0.2499,
                           1.3203: 0.2990, 1.5426: 0.4001, 1.7264: 0.5134, 2.0349: 0.6636, 2.4546: 0.8930,
                           2.8448: 1.1061, 3.2033: 1.3027, 3.5730: 1.5048, 3.8816: 1.6495, 4.2287: 1.8038,
                           4.4555: 1.8830, 4.7368: 1.9568, 5.0023: 2.0086}
        green_rms_density = {0.0091: 0.5967, 0.4492: 0.5981, 0.8348: 0.6076, 1.0617: 0.6322, 1.2296: 0.6718,
                             1.4020: 0.7469, 1.6289: 0.8917, 1.9465: 1.0910, 2.3185: 1.3450, 2.6475: 1.5430,
                             3.0717: 1.7792, 3.3938: 1.9841, 3.6162: 2.1370, 4.0154: 2.3746, 4.2060: 2.4729,
                             4.4238: 2.5630, 4.6325: 2.6313, 4.8253: 2.6791, 5.0000: 2.7187}
        blue_rms_density = {0.0227: 0.8917, 0.2495: 0.9040, 0.5127: 0.8971, 0.8076: 0.9162, 1.0231: 0.9518,
                            1.2432: 1.0118, 1.4587: 1.1061, 1.7287: 1.2604, 2.0712: 1.4720, 2.5431: 1.7533,
                            2.9378: 1.9909, 3.3212: 2.2135, 3.6184: 2.3951, 3.9632: 2.5863, 4.2060: 2.7132,
                            4.4102: 2.7952, 4.6665: 2.8826, 4.8798: 2.9399, 4.9932: 2.9686}
        self.rms_curve = [red_rms, green_rms, blue_rms]
        self.rms_density = [red_rms_density, green_rms_density, blue_rms_density]
        # computed rms of 5.08

        self.calibrate()
