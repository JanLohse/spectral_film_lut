from spectral_film_lut.film_spectral import *


class KodakVericolorIII(FilmSpectral):
    def __init__(self):
        super().__init__()

        self.iso = 160
        self.density_measure = 'status_m'
        self.manufacturer = 'Kodak'
        self.stage = 'camera'
        self.type = 'negative'
        self.medium = 'photo'

        # spectral sensitivity
        red_log_sensitivity = {523.4304: -1.3138, 521.1706: -1.4153, 529.6446: -1.1710, 536.9888: -1.0858,
                               546.0277: -1.0954, 553.9367: -1.1174, 558.4562: -0.9888, 561.2809: -0.8670,
                               565.2354: -0.7435, 570.3198: -0.6284, 575.9691: -0.5233, 580.4886: -0.4224,
                               583.3133: -0.3315, 585.5730: -0.2321, 587.8327: -0.1199, 595.7418: 0.1703,
                               605.9106: 0.4060, 613.8197: 0.4749, 622.8586: 0.4797, 631.8975: 0.4917, 640.9364: 0.5294,
                               646.5858: 0.5567, 660.1442: 0.5735, 666.3584: 0.4605, 670.3130: 0.3418, 673.7026: 0.2456,
                               675.7740: 0.1227, 678.0337: -0.1830, 679.3519: -0.3251, 680.4817: -0.4630,
                               681.6116: -0.5848, 682.7415: -0.7003, 683.8713: -0.8061, 685.5661: -0.9183,
                               688.3908: -1.1363, 690.6505: -1.2710, 692.9103: -1.3960, 694.6051: -1.4698, }
        green_log_sensitivity = {462.9825: -1.3560, 464.8656: -1.2005, 466.3721: -1.1107, 468.2552: -0.8798,
                                 470.3267: -0.7291, 472.5864: -0.5624, 477.1059: -0.4480, 483.3201: -0.3617,
                                 487.8396: -0.2535, 491.7941: -0.1343, 509.3070: 0.3104, 514.9564: 0.4143,
                                 521.1706: 0.5160, 527.3849: 0.6272, 533.0342: 0.7285, 538.6836: 0.8260,
                                 543.2030: 0.9029, 555.6315: 1.0363, 566.9302: 0.9323, 573.7094: 0.8311,
                                 578.7938: 0.7346, 582.7483: 0.6357, 585.5730: 0.4989, 586.7029: 0.3867,
                                 587.8327: 0.2873, 588.9626: 0.1815, 592.3522: -0.1969, 593.4821: -0.2963,
                                 594.6119: -0.4053, 595.7418: -0.5079, 596.8717: -0.6009, 602.5210: -0.9151,
                                 606.4755: -1.1363, 609.8651: -1.2731, 612.6898: -1.3800, }
        blue_log_sensitivity = {400.8399: -1.4057, 404.2295: -0.7259, 405.3594: -0.4983, 406.4892: -0.2770,
                                407.6191: -0.0462, 408.7490: 0.1815, 409.8788: 0.4027, 411.0087: 0.6336,
                                412.1386: 0.8003, 413.8334: 0.9286, 417.0346: 1.0440, 424.5671: 1.1178,
                                433.6060: 1.1039, 443.7748: 1.0697, 454.6968: 1.0312, 462.2293: 1.0098,
                                472.3981: 0.9799, 480.6838: 0.9072, 484.4500: 0.7982, 487.2747: 0.6657,
                                489.5344: 0.5438, 491.7941: 0.4156, 494.0538: 0.2841, 496.3136: 0.1526,
                                501.9629: -0.1872, 504.2226: -0.3123, 506.4824: -0.4502, 508.7421: -0.5816,
                                511.0018: -0.7195, 513.2616: -0.8574, 515.5213: -0.9888, 517.7810: -1.1235,
                                520.0408: -1.2582, }
        self.log_sensitivity = [red_log_sensitivity, green_log_sensitivity, blue_log_sensitivity]

        # sensiometry - characteristic curve
        red_curve = {-2.5221: 0.2020, -2.3708: 0.2183, -2.2195: 0.2455, -2.0682: 0.2886, -1.9169: 0.3501,
                     -1.7656: 0.4242, -1.6143: 0.5055, -1.4630: 0.5906, -1.3117: 0.6772, -1.1604: 0.7644,
                     -1.0091: 0.8551, -0.8578: 0.9437, -0.7065: 1.0309, -0.5552: 1.1199, -0.4039: 1.2112,
                     -0.2526: 1.3055, -0.1013: 1.3994, 0.0500: 1.4916, 0.2013: 1.5835, 0.3526: 1.6728, 0.5039: 1.7567,
                     0.6552: 1.8374, 0.8065: 1.9112, 0.9295: 1.9666, }
        green_curve = {-2.5221: 0.5619, -2.3708: 0.5856, -2.2195: 0.6202, -2.0682: 0.6689, -1.9169: 0.7333,
                       -1.7656: 0.8146, -1.6143: 0.9059, -1.4630: 1.0049, -1.3117: 1.1021, -1.1604: 1.1979,
                       -1.0091: 1.2960, -0.8578: 1.3923, -0.7065: 1.4901, -0.5552: 1.5883, -0.4039: 1.6890,
                       -0.2526: 1.7898, -0.1013: 1.8926, 0.0500: 1.9949, 0.2013: 2.0903, 0.3526: 2.1775, 0.5039: 2.2597,
                       0.6552: 2.3391, 0.8065: 2.4127, 0.9106: 2.4597, }
        blue_curve = {-2.5221: 0.7771, -2.3708: 0.7992, -2.2195: 0.8362, -2.0682: 0.8944, -1.9169: 0.9730,
                      -1.7656: 1.0637, -1.6143: 1.1595, -1.4630: 1.2641, -1.3117: 1.3696, -1.1604: 1.4754,
                      -1.0091: 1.5835, -0.8578: 1.6858, -0.7065: 1.7886, -0.5552: 1.8926, -0.4039: 1.9981,
                      -0.2526: 2.1024, -0.1013: 2.2071, 0.0500: 2.3099, 0.2013: 2.4098, 0.3526: 2.5035, 0.5039: 2.5930,
                      0.6552: 2.6766, 0.8065: 2.7523, 0.9295: 2.8091, }
        red_log_exposure = xp.array(list(red_curve.keys()), dtype=default_dtype)
        red_density_curve = xp.array(list(red_curve.values()), dtype=default_dtype)
        green_log_exposure = xp.array(list(green_curve.keys()), dtype=default_dtype)
        green_density_curve = xp.array(list(green_curve.values()), dtype=default_dtype)
        blue_log_exposure = xp.array(list(blue_curve.keys()), dtype=default_dtype)
        blue_density_curve = xp.array(list(blue_curve.values()), dtype=default_dtype)
        self.log_exposure = [red_log_exposure, green_log_exposure, blue_log_exposure]
        self.density_curve = [red_density_curve, green_density_curve, blue_density_curve]

        # spectral dye density
        midscale_sd = {413.0445: 1.4818, 419.7945: 1.5445, 425.4787: 1.6085, 432.2287: 1.6790, 440.0445: 1.7196,
                       447.8603: 1.7245, 455.6760: 1.7038, 463.4918: 1.6607, 470.9523: 1.5991, 477.7023: 1.5337,
                       484.4523: 1.4701, 491.9128: 1.4038, 499.7286: 1.3631, 507.5444: 1.3717, 515.3602: 1.3785,
                       523.1759: 1.3728, 530.9917: 1.3946, 538.8075: 1.4325, 546.6233: 1.4745, 554.4390: 1.4990,
                       562.2548: 1.4769, 569.0048: 1.4205, 573.9785: 1.3542, 577.8864: 1.2887, 581.4390: 1.2277,
                       584.9916: 1.1643, 588.8995: 1.0996, 593.1627: 1.0350, 598.4916: 0.9671, 605.5968: 0.9124,
                       613.4126: 0.8818, 621.2284: 0.8815, 629.0442: 0.9001, 636.8599: 0.9272, 644.6757: 0.9638,
                       652.4915: 1.0069, 660.3073: 1.0499, 668.1230: 1.0838, 675.9388: 1.1172, 683.7546: 1.1433,
                       691.5704: 1.1500, 697.6098: 1.1440, }
        minimum_sd = {403.8077: 0.8914, 405.9393: 0.8175, 408.4261: 0.7442, 413.0445: 0.6678, 420.1498: 0.6423,
                      427.9656: 0.6627, 435.7813: 0.6813, 443.5971: 0.6915, 451.4129: 0.6956, 459.2287: 0.6851,
                      467.0444: 0.6681, 474.8602: 0.6447, 482.6760: 0.6186, 490.4918: 0.5944, 498.3076: 0.5828,
                      506.1233: 0.5807, 513.9391: 0.5729, 521.7549: 0.5215, 529.5707: 0.4921, 537.3864: 0.4841,
                      545.2022: 0.4946, 553.0180: 0.5005, 560.8338: 0.4983, 568.6495: 0.4752, 576.4653: 0.4260,
                      583.9258: 0.3631, 591.3863: 0.2965, 599.2021: 0.2433, 607.0179: 0.2137, 614.8337: 0.1919,
                      622.6494: 0.1744, 630.4652: 0.1668, 638.2810: 0.1596, 646.0968: 0.1507, 653.9125: 0.1485,
                      661.7283: 0.1467, 669.5441: 0.1394, 677.3599: 0.1367, 685.1757: 0.1389, 692.6362: 0.1397, }
        self.d_ref_sd = colour.SpectralDistribution(midscale_sd)
        self.d_min_sd = colour.SpectralDistribution(minimum_sd)

        self.mtf = [{2.7393: 1.1234, 3.1793: 1.1234, 3.7622: 1.1364, 4.2829: 1.1386, 4.9710: 1.1386, 5.9120: 1.1510,
                     6.6965: 1.1541, 7.7723: 1.1541, 8.9297: 1.1502, 10.4276: 1.1356, 12.0701: 1.1158, 14.2967: 1.0789,
                     16.4691: 1.0315, 19.1292: 0.9637, 22.2324: 0.9042, 26.4319: 0.8239, 31.0966: 0.7447,
                     35.6671: 0.6731, 40.8401: 0.6002, 49.0336: 0.5072, 54.2760: 0.4584, 66.9543: 0.3770,
                     77.0120: 0.3310, }]

        # copied from kodak 5207
        red_rms = {0.0161: 0.0049, 0.1713: 0.0050, 0.3747: 0.0051, 0.5514: 0.0050, 0.7388: 0.0054, 0.9261: 0.0055,
                   1.0546: 0.0062, 1.1563: 0.0074, 1.2580: 0.0085, 1.3651: 0.0096, 1.4775: 0.0100, 1.5685: 0.0099,
                   1.7238: 0.0088, 1.8308: 0.0084, 1.9165: 0.0082, 2.0664: 0.0077, 2.2698: 0.0070, 2.3769: 0.0066,
                   2.5589: 0.0061, 2.9443: 0.0056, 3.3191: 0.0053, 3.4850: 0.0054, 3.6724: 0.0050, 3.8330: 0.0048,
                   4.0739: 0.0046, 4.2666: 0.0045, 4.4968: 0.0046, 4.6306: 0.0043, 4.8233: 0.0042, 5.0000: 0.0043}
        green_rms = {0.0000: 0.0051, 0.1392: 0.0056, 0.2730: 0.0059, 0.4711: 0.0057, 0.7334: 0.0055, 0.9315: 0.0063,
                     1.1510: 0.0079, 1.2794: 0.0089, 1.4186: 0.0103, 1.5418: 0.0107, 1.6435: 0.0103, 1.8201: 0.0092,
                     1.9486: 0.0080, 2.1734: 0.0074, 2.3448: 0.0068, 2.5321: 0.0062, 2.7730: 0.0063, 3.0835: 0.0065,
                     3.3779: 0.0069, 3.5278: 0.0071, 3.7420: 0.0066, 4.0739: 0.0061, 4.3148: 0.0058, 4.5343: 0.0053,
                     4.7430: 0.0051, 5.0054: 0.0046}
        blue_rms = {0.0000: 0.0112, 0.0857: 0.0114, 0.1606: 0.0123, 0.2409: 0.0126, 0.3158: 0.0123, 0.3961: 0.0118,
                    0.5139: 0.0115, 0.6531: 0.0116, 0.8030: 0.0125, 0.9315: 0.0140, 1.0493: 0.0154, 1.1938: 0.0165,
                    1.3169: 0.0164, 1.4507: 0.0156, 1.5578: 0.0155, 1.6863: 0.0157, 1.7934: 0.0153, 1.9245: 0.0140,
                    2.0610: 0.0129, 2.2645: 0.0124, 2.4732: 0.0127, 2.6552: 0.0128, 2.8747: 0.0135, 3.0246: 0.0138,
                    3.2976: 0.0133, 3.6403: 0.0121, 4.1649: 0.0101, 4.4700: 0.0088, 4.8073: 0.0069, 5.0054: 0.0060}
        red_rms_density = {0.0000: 0.2286, 0.7369: 0.2286, 1.0380: 0.2429, 1.2520: 0.2714, 1.4659: 0.3429,
                           1.7829: 0.4976, 3.7837: 1.5857, 4.0967: 1.7381, 4.4176: 1.8762, 4.7385: 1.9714,
                           5.0000: 2.0238}
        green_rms_density = {0.0079: 0.5952, 0.5784: 0.5952, 0.9509: 0.6048, 1.1648: 0.6333, 1.3312: 0.6714,
                             1.5610: 0.7762, 1.9810: 1.0524, 2.9160: 1.6429, 3.8629: 2.2500, 4.1125: 2.4000,
                             4.3502: 2.5190, 4.5761: 2.6071, 4.7425: 2.6524, 4.8732: 2.6810, 4.9960: 2.7000}
        blue_rms_density = {0.0000: 1.0071, 0.6418: 1.0119, 0.9350: 1.0310, 1.1648: 1.0810, 1.4342: 1.1762,
                            1.7868: 1.3452, 2.2464: 1.6452, 2.9279: 2.0452, 3.8788: 2.6119, 4.2353: 2.7881,
                            4.5840: 2.9190, 4.8732: 2.9929}
        self.rms_curve = [red_rms, green_rms, blue_rms]
        self.rms_density = [red_rms_density, green_rms_density, blue_rms_density]
        # guessed value:
        self.rms = 3.9

        self.calibrate()
